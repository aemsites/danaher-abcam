/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.19.2.
 * Original file: /npm/@coveo/headless@3.10.0/dist/browser/headless.esm.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{StringValue as e,ArrayValue as t,RecordValue as r,EnumValue as n,BooleanValue as a,Value as i,NumberValue as s,Schema as o,isNullOrUndefined as c,isArray as u,isString as l,isBoolean as d,SchemaValidationError as f,isUndefined as p}from"/npm/@coveo/bueno@1.0.6/+esm";var g="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};"function"==typeof g.setTimeout&&setTimeout,"function"==typeof g.clearTimeout&&clearTimeout;function h(e,t){this.fun=e,this.array=t}h.prototype.run=function(){this.fun.apply(null,this.array)};var y=g.performance||{};y.now||y.mozNow||y.msNow||y.oNow||y.webkitNow;new Date;var m=Object.create,v=Object.defineProperty,S=Object.getOwnPropertyDescriptor,w=Object.getOwnPropertyNames,b=Object.getPrototypeOf,C=Object.prototype.hasOwnProperty,I=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),q=(e,t,r)=>(r=null!=e?m(b(e)):{},((e,t,r,n)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let a of w(t))!C.call(e,a)&&a!==r&&v(e,a,{get:()=>t[a],enumerable:!(n=S(t,a))||n.enumerable});return e})(!t&&e&&e.__esModule?r:v(r,"default",{value:e,enumerable:!0}),e)),k=(e,t,r)=>((e,t,r)=>t in e?v(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r),x=I((e=>{var t=e&&e.__assign||function(){return t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},t.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var r={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:function(){return!0},startingDelay:100,timeMultiple:2};e.getSanitizedOptions=function(e){var n=t(t({},r),e);return n.numOfAttempts<1&&(n.numOfAttempts=1),n}})),A=I((e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.fullJitter=function(e){var t=Math.random()*e;return Math.round(t)}})),R=I((e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.noJitter=function(e){return e}})),O=I((e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=A(),r=R();e.JitterFactory=function(e){return"full"===e.jitter?t.fullJitter:r.noJitter}})),F=I((e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=O(),r=function(){function e(e){this.options=e,this.attempt=0}return e.prototype.apply=function(){var e=this;return new Promise((function(t){return setTimeout(t,e.jitteredDelay)}))},e.prototype.setAttemptNumber=function(e){this.attempt=e},Object.defineProperty(e.prototype,"jitteredDelay",{get:function(){return t.JitterFactory(this.options)(this.delay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delay",{get:function(){var e=this.options.startingDelay,t=this.options.timeMultiple,r=this.numOfDelayedAttempts,n=e*Math.pow(t,r);return Math.min(n,this.options.maxDelay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt},enumerable:!0,configurable:!0}),e}();e.Delay=r})),E=I((e=>{var t,r=e&&e.__extends||(t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,r)},function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),n=e&&e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?a(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}c((n=n.apply(e,t||[])).next())}))},a=e&&e.__generator||function(e,t){var r,n,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){s.label=i[1];break}if(6===i[0]&&s.label<a[1]){s.label=a[1],a=i;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(i);break}a[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}};Object.defineProperty(e,"__esModule",{value:!0});var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.apply=function(){return n(this,void 0,void 0,(function(){return a(this,(function(t){return[2,!!this.isFirstAttempt||e.prototype.apply.call(this)]}))}))},Object.defineProperty(t.prototype,"isFirstAttempt",{get:function(){return 0===this.attempt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt-1},enumerable:!0,configurable:!0}),t}(F().Delay);e.SkipFirstDelay=i})),T=I((e=>{var t,r=e&&e.__extends||(t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,r)},function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(F().Delay);e.AlwaysDelay=n})),D=I((e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=E(),r=T();e.DelayFactory=function(e,n){var a=function(e){return e.delayFirstAttempt?new r.AlwaysDelay(e):new t.SkipFirstDelay(e)}(e);return a.setAttemptNumber(n),a}})),M=I((e=>{var t=e&&e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?a(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}c((n=n.apply(e,t||[])).next())}))},r=e&&e.__generator||function(e,t){var r,n,a,i,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function o(i){return function(o){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){s.label=i[1];break}if(6===i[0]&&s.label<a[1]){s.label=a[1],a=i;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(i);break}a[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,o])}}};Object.defineProperty(e,"__esModule",{value:!0});var n=x(),a=D();e.backOff=function(e,a){return void 0===a&&(a={}),t(this,void 0,void 0,(function(){var t;return r(this,(function(r){switch(r.label){case 0:return t=n.getSanitizedOptions(a),[4,new i(e,t).execute()];case 1:return[2,r.sent()]}}))}))};var i=function(){function e(e,t){this.request=e,this.options=t,this.attemptNumber=0}return e.prototype.execute=function(){return t(this,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:if(this.attemptLimitReached)return[3,7];t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.applyDelay()];case 2:return t.sent(),[4,this.request()];case 3:return[2,t.sent()];case 4:return e=t.sent(),this.attemptNumber++,[4,this.options.retry(e,this.attemptNumber)];case 5:if(!t.sent()||this.attemptLimitReached)throw e;return[3,6];case 6:return[3,0];case 7:throw new Error("Something went wrong.")}}))}))},Object.defineProperty(e.prototype,"attemptLimitReached",{get:function(){return this.attemptNumber>=this.options.numOfAttempts},enumerable:!0,configurable:!0}),e.prototype.applyDelay=function(){return t(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,a.DelayFactory(this.options,this.attemptNumber).apply()];case 1:return e.sent(),[2]}}))}))},e}()})),P=I(((e,t)=>{var r,n;r=e,n=function(){var e=6e4,t=36e5,r="millisecond",n="second",a="minute",i="hour",s="day",o="week",c="month",u="quarter",l="year",d="date",f="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,h={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],r=e%100;return"["+e+(t[(r-20)%10]||t[r]||t[0])+"]"}},y=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},m={s:y,z:function(e){var t=-e.utcOffset(),r=Math.abs(t),n=Math.floor(r/60),a=r%60;return(t<=0?"+":"-")+y(n,2,"0")+":"+y(a,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var n=12*(r.year()-t.year())+(r.month()-t.month()),a=t.clone().add(n,c),i=r-a<0,s=t.clone().add(n+(i?-1:1),c);return+(-(n+(r-a)/(i?a-s:s-a))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:l,w:o,d:s,D:d,h:i,m:a,s:n,ms:r,Q:u}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},v="en",S={};S[v]=h;var w="$isDayjsObject",b=function(e){return e instanceof k||!(!e||!e[w])},C=function e(t,r,n){var a;if(!t)return v;if("string"==typeof t){var i=t.toLowerCase();S[i]&&(a=i),r&&(S[i]=r,a=i);var s=t.split("-");if(!a&&s.length>1)return e(s[0])}else{var o=t.name;S[o]=t,a=o}return!n&&a&&(v=a),a||!n&&v},I=function(e,t){if(b(e))return e.clone();var r="object"==typeof t?t:{};return r.date=e,r.args=arguments,new k(r)},q=m;q.l=C,q.i=b,q.w=function(e,t){return I(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var k=function(){function h(e){this.$L=C(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[w]=!0}var y=h.prototype;return y.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(null===t)return new Date(NaN);if(q.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(p);if(n){var a=n[2]-1||0,i=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],a,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)):new Date(n[1],a,n[3]||1,n[4]||0,n[5]||0,n[6]||0,i)}}return new Date(t)}(e),this.init()},y.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},y.$utils=function(){return q},y.isValid=function(){return this.$d.toString()!==f},y.isSame=function(e,t){var r=I(e);return this.startOf(t)<=r&&r<=this.endOf(t)},y.isAfter=function(e,t){return I(e)<this.startOf(t)},y.isBefore=function(e,t){return this.endOf(t)<I(e)},y.$g=function(e,t,r){return q.u(e)?this[t]:this.set(r,e)},y.unix=function(){return Math.floor(this.valueOf()/1e3)},y.valueOf=function(){return this.$d.getTime()},y.startOf=function(e,t){var r=this,u=!!q.u(t)||t,f=q.p(e),p=function(e,t){var n=q.w(r.$u?Date.UTC(r.$y,t,e):new Date(r.$y,t,e),r);return u?n:n.endOf(s)},g=function(e,t){return q.w(r.toDate()[e].apply(r.toDate("s"),(u?[0,0,0,0]:[23,59,59,999]).slice(t)),r)},h=this.$W,y=this.$M,m=this.$D,v="set"+(this.$u?"UTC":"");switch(f){case l:return u?p(1,0):p(31,11);case c:return u?p(1,y):p(0,y+1);case o:var S=this.$locale().weekStart||0,w=(h<S?h+7:h)-S;return p(u?m-w:m+(6-w),y);case s:case d:return g(v+"Hours",0);case i:return g(v+"Minutes",1);case a:return g(v+"Seconds",2);case n:return g(v+"Milliseconds",3);default:return this.clone()}},y.endOf=function(e){return this.startOf(e,!1)},y.$set=function(e,t){var o,u=q.p(e),f="set"+(this.$u?"UTC":""),p=(o={},o[s]=f+"Date",o[d]=f+"Date",o[c]=f+"Month",o[l]=f+"FullYear",o[i]=f+"Hours",o[a]=f+"Minutes",o[n]=f+"Seconds",o[r]=f+"Milliseconds",o)[u],g=u===s?this.$D+(t-this.$W):t;if(u===c||u===l){var h=this.clone().set(d,1);h.$d[p](g),h.init(),this.$d=h.set(d,Math.min(this.$D,h.daysInMonth())).$d}else p&&this.$d[p](g);return this.init(),this},y.set=function(e,t){return this.clone().$set(e,t)},y.get=function(e){return this[q.p(e)]()},y.add=function(r,u){var d,f=this;r=Number(r);var p=q.p(u),g=function(e){var t=I(f);return q.w(t.date(t.date()+Math.round(e*r)),f)};if(p===c)return this.set(c,this.$M+r);if(p===l)return this.set(l,this.$y+r);if(p===s)return g(1);if(p===o)return g(7);var h=(d={},d[a]=e,d[i]=t,d[n]=1e3,d)[p]||1,y=this.$d.getTime()+r*h;return q.w(y,this)},y.subtract=function(e,t){return this.add(-1*e,t)},y.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return r.invalidDate||f;var n=e||"YYYY-MM-DDTHH:mm:ssZ",a=q.z(this),i=this.$H,s=this.$m,o=this.$M,c=r.weekdays,u=r.months,l=r.meridiem,d=function(e,r,a,i){return e&&(e[r]||e(t,n))||a[r].slice(0,i)},p=function(e){return q.s(i%12||12,e,"0")},h=l||function(e,t,r){var n=e<12?"AM":"PM";return r?n.toLowerCase():n};return n.replace(g,(function(e,n){return n||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return q.s(t.$y,4,"0");case"M":return o+1;case"MM":return q.s(o+1,2,"0");case"MMM":return d(r.monthsShort,o,u,3);case"MMMM":return d(u,o);case"D":return t.$D;case"DD":return q.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return d(r.weekdaysMin,t.$W,c,2);case"ddd":return d(r.weekdaysShort,t.$W,c,3);case"dddd":return c[t.$W];case"H":return String(i);case"HH":return q.s(i,2,"0");case"h":return p(1);case"hh":return p(2);case"a":return h(i,s,!0);case"A":return h(i,s,!1);case"m":return String(s);case"mm":return q.s(s,2,"0");case"s":return String(t.$s);case"ss":return q.s(t.$s,2,"0");case"SSS":return q.s(t.$ms,3,"0");case"Z":return a}return null}(e)||a.replace(":","")}))},y.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},y.diff=function(r,d,f){var p,g=this,h=q.p(d),y=I(r),m=(y.utcOffset()-this.utcOffset())*e,v=this-y,S=function(){return q.m(g,y)};switch(h){case l:p=S()/12;break;case c:p=S();break;case u:p=S()/3;break;case o:p=(v-m)/6048e5;break;case s:p=(v-m)/864e5;break;case i:p=v/t;break;case a:p=v/e;break;case n:p=v/1e3;break;default:p=v}return f?p:q.a(p)},y.daysInMonth=function(){return this.endOf(c).$D},y.$locale=function(){return S[this.$L]},y.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),n=C(e,t,!0);return n&&(r.$L=n),r},y.clone=function(){return q.w(this.$d,this)},y.toDate=function(){return new Date(this.valueOf())},y.toJSON=function(){return this.isValid()?this.toISOString():null},y.toISOString=function(){return this.$d.toISOString()},y.toString=function(){return this.$d.toUTCString()},h}(),x=k.prototype;return I.prototype=x,[["$ms",r],["$s",n],["$m",a],["$H",i],["$W",s],["$M",c],["$y",l],["$D",d]].forEach((function(e){x[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),I.extend=function(e,t){return e.$i||(e(t,k,I),e.$i=!0),I},I.locale=C,I.isDayjs=b,I.unix=function(e){return I(1e3*e)},I.en=S[v],I.Ls=S,I.p={},I},"object"==typeof e&&typeof t<"u"?t.exports=n():"function"==typeof define&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs=n()})),j=I(((e,t)=>{var r,n;r=e,n=function(){var e="month",t="quarter";return function(r,n){var a=n.prototype;a.quarter=function(e){return this.$utils().u(e)?Math.ceil((this.month()+1)/3):this.month(this.month()%3+3*(e-1))};var i=a.add;a.add=function(r,n){return r=Number(r),this.$utils().p(n)===t?this.add(3*r,e):i.bind(this)(r,n)};var s=a.startOf;a.startOf=function(r,n){var a=this.$utils(),i=!!a.u(n)||n;if(a.p(r)===t){var o=this.quarter()-1;return i?this.month(3*o).startOf(e).startOf("day"):this.month(3*o+2).endOf(e).endOf("day")}return s.bind(this)(r,n)}}},"object"==typeof e&&typeof t<"u"?t.exports=n():"function"==typeof define&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_quarterOfYear=n()})),V=I(((e,t)=>{var r,n;r=e,n=function(){var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,r=/\d\d/,n=/\d\d?/,a=/\d*[^-_:/,()\s\d]+/,i={},s=function(e){return(e=+e)+(e>68?1900:2e3)},o=function(e){return function(t){this[e]=+t}},c=[/[+-]\d\d:?(\d\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e||"Z"===e)return 0;var t=e.match(/([+-]|\d\d)/g),r=60*t[1]+(+t[2]||0);return 0===r?0:"+"===t[0]?-r:r}(e)}],u=function(e){var t=i[e];return t&&(t.indexOf?t:t.s.concat(t.f))},l=function(e,t){var r,n=i.meridiem;if(n){for(var a=1;a<=24;a+=1)if(e.indexOf(n(a,0,t))>-1){r=a>12;break}}else r=e===(t?"pm":"PM");return r},d={A:[a,function(e){this.afternoon=l(e,!1)}],a:[a,function(e){this.afternoon=l(e,!0)}],S:[/\d/,function(e){this.milliseconds=100*+e}],SS:[r,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[n,o("seconds")],ss:[n,o("seconds")],m:[n,o("minutes")],mm:[n,o("minutes")],H:[n,o("hours")],h:[n,o("hours")],HH:[n,o("hours")],hh:[n,o("hours")],D:[n,o("day")],DD:[r,o("day")],Do:[a,function(e){var t=i.ordinal,r=e.match(/\d+/);if(this.day=r[0],t)for(var n=1;n<=31;n+=1)t(n).replace(/\[|\]/g,"")===e&&(this.day=n)}],M:[n,o("month")],MM:[r,o("month")],MMM:[a,function(e){var t=u("months"),r=(u("monthsShort")||t.map((function(e){return e.slice(0,3)}))).indexOf(e)+1;if(r<1)throw new Error;this.month=r%12||r}],MMMM:[a,function(e){var t=u("months").indexOf(e)+1;if(t<1)throw new Error;this.month=t%12||t}],Y:[/[+-]?\d+/,o("year")],YY:[r,function(e){this.year=s(e)}],YYYY:[/\d{4}/,o("year")],Z:c,ZZ:c};return function(r,n,a){a.p.customParseFormat=!0,r&&r.parseTwoDigitYear&&(s=r.parseTwoDigitYear);var o=n.prototype,c=o.parse;o.parse=function(r){var n=r.date,s=r.utc,o=r.args;this.$u=s;var u=o[1];if("string"==typeof u){var l=!0===o[2],f=!0===o[3],p=l||f,g=o[2];f&&(g=o[2]),i=this.$locale(),!l&&g&&(i=a.Ls[g]),this.$d=function(r,n,a){try{if(["x","X"].indexOf(n)>-1)return new Date(("X"===n?1e3:1)*r);var s=function(r){var n,a;n=r,a=i&&i.formats;for(var s=(r=n.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,r,n){var i=n&&n.toUpperCase();return r||a[n]||e[n]||a[i].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,r){return t||r.slice(1)}))}))).match(t),o=s.length,c=0;c<o;c+=1){var u=s[c],l=d[u],f=l&&l[0],p=l&&l[1];s[c]=p?{regex:f,parser:p}:u.replace(/^\[|\]$/g,"")}return function(e){for(var t={},r=0,n=0;r<o;r+=1){var a=s[r];if("string"==typeof a)n+=a.length;else{var i=a.regex,c=a.parser,u=e.slice(n),l=i.exec(u)[0];c.call(t,l),e=e.replace(l,"")}}return function(e){var t=e.afternoon;if(void 0!==t){var r=e.hours;t?r<12&&(e.hours+=12):12===r&&(e.hours=0),delete e.afternoon}}(t),t}}(n)(r),o=s.year,c=s.month,u=s.day,l=s.hours,f=s.minutes,p=s.seconds,g=s.milliseconds,h=s.zone,y=new Date,m=u||(o||c?1:y.getDate()),v=o||y.getFullYear(),S=0;o&&!c||(S=c>0?c-1:y.getMonth());var w=l||0,b=f||0,C=p||0,I=g||0;return h?new Date(Date.UTC(v,S,m,w,b,C,I+60*h.offset*1e3)):a?new Date(Date.UTC(v,S,m,w,b,C,I)):new Date(v,S,m,w,b,C,I)}catch{return new Date("")}}(n,u,s),this.init(),g&&!0!==g&&(this.$L=this.locale(g).$L),p&&n!=this.format(u)&&(this.$d=new Date("")),i={}}else if(u instanceof Array)for(var h=u.length,y=1;y<=h;y+=1){o[1]=u[y-1];var m=a.apply(this,o);if(m.isValid()){this.$d=m.$d,this.$L=m.$L,this.init();break}y===h&&(this.$d=new Date(""))}else c.call(this,r)}}},"object"==typeof e&&typeof t<"u"?t.exports=n():"function"==typeof define&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_customParseFormat=n()})),_=I(((e,t)=>{var r=/(^|; )Coveo-Pendragon=([^;]*)/;t.exports=()=>r.exec(document.cookie)?.pop()||null})),U=I(((e,t)=>{var r,n;r=e,n=function(){var e={year:0,month:1,day:2,hour:3,minute:4,second:5},t={};return function(r,n,a){var i,s=function(e,r,n){void 0===n&&(n={});var a=new Date(e);return function(e,r){void 0===r&&(r={});var n=r.timeZoneName||"short",a=e+"|"+n,i=t[a];return i||(i=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:n}),t[a]=i),i}(r,n).formatToParts(a)},o=function(t,r){for(var n=s(t,r),i=[],o=0;o<n.length;o+=1){var c=n[o],u=c.type,l=c.value,d=e[u];d>=0&&(i[d]=parseInt(l,10))}var f=i[3],p=24===f?0:f,g=i[0]+"-"+i[1]+"-"+i[2]+" "+p+":"+i[4]+":"+i[5]+":000",h=+t;return(a.utc(g).valueOf()-(h-=h%1e3))/6e4},c=n.prototype;c.tz=function(e,t){void 0===e&&(e=i);var r,n=this.utcOffset(),s=this.toDate(),o=s.toLocaleString("en-US",{timeZone:e}),c=Math.round((s-new Date(o))/1e3/60),u=15*-Math.round(s.getTimezoneOffset()/15)-c;if(Number(u)){if(r=a(o,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(u,!0),t){var l=r.utcOffset();r=r.add(n-l,"minute")}}else r=this.utcOffset(0,t);return r.$x.$timezone=e,r},c.offsetName=function(e){var t=this.$x.$timezone||a.tz.guess(),r=s(this.valueOf(),t,{timeZoneName:e}).find((function(e){return"timezonename"===e.type.toLowerCase()}));return r&&r.value};var u=c.startOf;c.startOf=function(e,t){if(!this.$x||!this.$x.$timezone)return u.call(this,e,t);var r=a(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return u.call(r,e,t).tz(this.$x.$timezone,!0)},a.tz=function(e,t,r){var n=r&&t,s=r||t||i,c=o(+a(),s);if("string"!=typeof e)return a(e).tz(s);var u=function(e,t,r){var n=e-60*t*1e3,a=o(n,r);if(t===a)return[n,t];var i=o(n-=60*(a-t)*1e3,r);return a===i?[n,a]:[e-60*Math.min(a,i)*1e3,Math.max(a,i)]}(a.utc(e,n).valueOf(),c,s),l=u[0],d=u[1],f=a(l).utcOffset(d);return f.$x.$timezone=s,f},a.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},a.tz.setDefault=function(e){i=e}}},"object"==typeof e&&typeof t<"u"?t.exports=n():"function"==typeof define&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_timezone=n()})),Q=I(((e,t)=>{var r,n;r=e,n=function(){var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,r=/([+-]|\d\d)/g;return function(n,a,i){var s=a.prototype;i.utc=function(e){return new a({date:e,utc:!0,args:arguments})},s.utc=function(t){var r=i(this.toDate(),{locale:this.$L,utc:!0});return t?r.add(this.utcOffset(),e):r},s.local=function(){return i(this.toDate(),{locale:this.$L,utc:!1})};var o=s.parse;s.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),o.call(this,e)};var c=s.init;s.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else c.call(this)};var u=s.utcOffset;s.utcOffset=function(n,a){var i=this.$utils().u;if(i(n))return this.$u?0:i(this.$offset)?u.call(this):this.$offset;if("string"==typeof n&&null===(n=function(e){void 0===e&&(e="");var n=e.match(t);if(!n)return null;var a=(""+n[0]).match(r)||["-",0,0],i=a[0],s=60*+a[1]+ +a[2];return 0===s?0:"+"===i?s:-s}(n)))return this;var s=Math.abs(n)<=16?60*n:n,o=this;if(a)return o.$offset=s,o.$u=0===n,o;if(0!==n){var c=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(o=this.local().add(s+c,e)).$offset=s,o.$x.$localOffset=c}else o=this.utc();return o};var l=s.format;s.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,t)},s.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},s.isUTC=function(){return!!this.$u},s.toISOString=function(){return this.toDate().toISOString()},s.toString=function(){return this.toDate().toUTCString()};var d=s.toDate;s.toDate=function(e){return"s"===e&&this.$offset?i(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var f=s.diff;s.diff=function(e,t,r){if(e&&this.$u===e.$u)return f.call(this,e,t,r);var n=this.local(),a=i(e).local();return f.call(n,a,t,r)}}},"object"==typeof e&&typeof t<"u"?t.exports=n():"function"==typeof define&&define.amd?define(n):(r=typeof globalThis<"u"?globalThis:r||self).dayjs_plugin_utc=n()})),$=I(((e,t)=>{function r(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}t.exports=function(e,t,n){var a=n&&n.stringify||r;if("object"==typeof e&&null!==e){var i=t.length+1;if(1===i)return e;var s=new Array(i);s[0]=a(e);for(var o=1;o<i;o++)s[o]=a(t[o]);return s.join(" ")}if("string"!=typeof e)return e;var c=t.length;if(0===c)return e;for(var u="",l=0,d=-1,f=e&&e.length||0,p=0;p<f;){if(37===e.charCodeAt(p)&&p+1<f){switch(d=d>-1?d:0,e.charCodeAt(p+1)){case 100:case 102:if(l>=c||null==t[l])break;d<p&&(u+=e.slice(d,p)),u+=Number(t[l]),d=p+2,p++;break;case 105:if(l>=c||null==t[l])break;d<p&&(u+=e.slice(d,p)),u+=Math.floor(Number(t[l])),d=p+2,p++;break;case 79:case 111:case 106:if(l>=c||void 0===t[l])break;d<p&&(u+=e.slice(d,p));var g=typeof t[l];if("string"===g){u+="'"+t[l]+"'",d=p+2,p++;break}if("function"===g){u+=t[l].name||"<anonymous>",d=p+2,p++;break}u+=a(t[l]),d=p+2,p++;break;case 115:if(l>=c)break;d<p&&(u+=e.slice(d,p)),u+=String(t[l]),d=p+2,p++;break;case 37:d<p&&(u+=e.slice(d,p)),u+="%",d=p+2,p++,l--}++l}++p}return-1===d?e:(d<f&&(u+=e.slice(d)),u)}})),L=I(((e,t)=>{var r=$();t.exports=l;var n=function(){function e(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}().console||{},a={mapHttpRequest:y,mapHttpResponse:y,wrapRequestSerializer:m,wrapResponseSerializer:m,wrapErrorSerializer:m,req:y,res:y,err:g,errWithCause:g};function i(e,t){return"silent"===e?1/0:t.levels.values[e]}var s=Symbol("pino.logFuncs"),o=Symbol("pino.hierarchy"),c={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function u(e,t){let r={logger:t,parent:e[o]};t[o]=r}function l(e){(e=e||{}).browser=e.browser||{};let t=e.browser.transmit;if(t&&"function"!=typeof t.send)throw Error("pino: transmit option must have a send function");let r=e.browser.write||n;e.browser.write&&(e.browser.asObject=!0);let a=e.serializers||{},o=function(e,t){return Array.isArray(e)?e.filter((function(e){return"!stdSerializers.err"!==e})):!0===e&&Object.keys(t)}(e.browser.serialize,a),g=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(g=!1);let y=Object.keys(e.customLevels||{}),m=["error","fatal","warn","info","debug","trace"].concat(y);"function"==typeof r&&m.forEach((function(e){r[e]=r})),(!1===e.enabled||e.browser.disabled)&&(e.level="silent");let S=e.level||"info",w=Object.create(r);w.log||(w.log=v),function(e,t,r){let a={};t.forEach((e=>{a[e]=r[e]?r[e]:n[e]||n[c[e]||"log"]||v})),e[s]=a}(w,m,r),u({},w),Object.defineProperty(w,"levelVal",{get:function(){return i(this.level,this)}}),Object.defineProperty(w,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,d(this,b,w,"error"),d(this,b,w,"fatal"),d(this,b,w,"warn"),d(this,b,w,"info"),d(this,b,w,"debug"),d(this,b,w,"trace"),y.forEach((e=>{d(this,b,w,e)}))}});let b={transmit:t,serialize:o,asObject:e.browser.asObject,formatters:e.browser.formatters,levels:m,timestamp:h(e)};return w.levels=function(e){let t=e.customLevels||{},r=Object.assign({},l.levels.values,t),n=Object.assign({},l.levels.labels,function(e){let t={};return Object.keys(e).forEach((function(r){t[e[r]]=r})),t}(t));return{values:r,labels:n}}(e),w.level=S,w.setMaxListeners=w.getMaxListeners=w.emit=w.addListener=w.on=w.prependListener=w.once=w.prependOnceListener=w.removeListener=w.removeAllListeners=w.listeners=w.listenerCount=w.eventNames=w.write=w.flush=v,w.serializers=a,w._serialize=o,w._stdErrSerialize=g,w.child=function(r,n){if(!r)throw new Error("missing bindings for child Pino");n=n||{},o&&r.serializers&&(n.serializers=r.serializers);let i=n.serializers;if(o&&i){var s=Object.assign({},a,i),c=!0===e.browser.serialize?Object.keys(s):o;delete r.serializers,f([r],c,s,this._stdErrSerialize)}function l(e){this._childLevel=1+(0|e._childLevel),this.bindings=r,s&&(this.serializers=s,this._serialize=c),t&&(this._logEvent=p([].concat(e._logEvent.bindings,r)))}l.prototype=this;let d=new l(this);return u(this,d),d.level=this.level,d},t&&(w._logEvent=p()),w}function d(e,t,a,c){if(Object.defineProperty(e,c,{value:i(e.level,a)>i(c,a)?v:a[s][c],writable:!0,enumerable:!0,configurable:!0}),!t.transmit&&e[c]===v)return;e[c]=function(e,t,a,o){return function(s){return function(){let c=t.timestamp(),u=new Array(arguments.length),l=Object.getPrototypeOf&&Object.getPrototypeOf(this)===n?n:this;for(var d=0;d<u.length;d++)u[d]=arguments[d];if(t.serialize&&!t.asObject&&f(u,this._serialize,this.serializers,this._stdErrSerialize),t.asObject||t.formatters?s.call(l,function(e,t,n,a,i={}){let{level:s=(()=>e.levels.values[t]),log:o=(e=>e)}=i;e._serialize&&f(n,e._serialize,e.serializers,e._stdErrSerialize);let c=n.slice(),u=c[0],l={};a&&(l.time=a),l.level=s(t,e.levels.values[t]);let d=1+(0|e._childLevel);if(d<1&&(d=1),null!==u&&"object"==typeof u){for(;d--&&"object"==typeof c[0];)Object.assign(l,c.shift());u=c.length?r(c.shift(),c):void 0}else"string"==typeof u&&(u=r(c.shift(),c));return void 0!==u&&(l.msg=u),o(l)}(this,o,u,c,t.formatters)):s.apply(l,u),t.transmit){let r=t.transmit.level||e._level,n=a.levels.values[r],s=a.levels.values[o];if(s<n)return;!function(e,t,r){let n=t.send,a=t.ts,i=t.methodLevel,s=t.methodValue,o=t.val,c=e._logEvent.bindings;f(r,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=a,e._logEvent.messages=r.filter((function(e){return-1===c.indexOf(e)})),e._logEvent.level.label=i,e._logEvent.level.value=s,n(i,e._logEvent,o),e._logEvent=p(c)}(this,{ts:c,methodLevel:o,methodValue:s,transmitLevel:r,transmitValue:a.levels.values[t.transmit.level||e._level],send:t.transmit.send,val:i(e._level,a)},u)}}}(e[s][o])}(e,t,a,c);let u=function(e){let t=[];e.bindings&&t.push(e.bindings);let r=e[o];for(;r.parent;)r=r.parent,r.logger.bindings&&t.push(r.logger.bindings);return t.reverse()}(e);0!==u.length&&(e[c]=function(e,t){return function(){return t.apply(this,[...e,...arguments])}}(u,e[c]))}function f(e,t,r,n){for(let a in e)if(n&&e[a]instanceof Error)e[a]=l.stdSerializers.err(e[a]);else if("object"==typeof e[a]&&!Array.isArray(e[a]))for(let n in e[a])t&&t.indexOf(n)>-1&&n in r&&(e[a][n]=r[n](e[a][n]))}function p(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function g(e){let t={type:e.constructor.name,msg:e.message,stack:e.stack};for(let r in e)void 0===t[r]&&(t[r]=e[r]);return t}function h(e){return"function"==typeof e.timestamp?e.timestamp:!1===e.timestamp?S:w}function y(){return{}}function m(e){return e}function v(){}function S(){return!1}function w(){return Date.now()}l.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},l.stdSerializers=a,l.stdTimeFunctions=Object.assign({},{nullTime:S,epochTime:w,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}}),t.exports.default=l,t.exports.pino=l})),N={};
/**
 * @license
 *
 * Copyright 2024 Coveo Solutions Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *       http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */((e,t)=>{for(var r in t)v(e,r,{get:t[r],enumerable:!0})})(N,{escape:()=>ee,getHighlightedSuggestion:()=>Z,highlightString:()=>J});var B=(e,t=5)=>e+Math.random().toString(36).substring(2,2+t);function z(e){return Array.isArray(e)}function H(e){return""===e.trim()}function Y(e,t){let{[e]:r,...n}=t;return n}function W(e){return function(e){return btoa(encodeURI(e))}(JSON.stringify(e))}var G=new Set(["1",1,"yes",!0]);function K(e){if("object"!=typeof e||!e)return e;try{return JSON.parse(JSON.stringify(e))}catch{return e}}function J(e){if(H(e.openingDelimiter)||H(e.closingDelimiter))throw Error("delimiters should be a non-empty string");if(c(e.content)||H(e.content))return e.content;if(0===e.highlights.length)return ee(e.content);let t=e.content.length,r="",n=0;for(let a=0;a<e.highlights.length;a++){let i=e.highlights[a],s=i.offset,o=s+i.length;if(o>t)break;r+=ee(e.content.slice(n,s)),r+=e.openingDelimiter,r+=ee(e.content.slice(s,o)),r+=e.closingDelimiter,n=o}return n!==t&&(r+=ee(e.content.slice(n))),r}function Z(e,t){return(e=ee(e)).replace(/\[(.*?)\]|\{(.*?)\}|\((.*?)\)/g,((e,r,n,a)=>r?X(r,t.notMatchDelimiters):n?X(n,t.exactMatchDelimiters):a?X(a,t.correctionDelimiters):e))}function X(e,t){return t?t.open+e+t.close:e}function ee(e){let t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},r="(?:"+Object.keys(t).join("|")+")",n=RegExp(r),a=RegExp(r,"g");return n.test(e)?e.replace(a,(e=>t[e])):e}function te(e){let t,r,n,a=!1;return function(i){void 0===t?(t=i,r=0,n=-1):t=function(e,t){let r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}(t,i);let s=t.length,o=0;for(;r<s;){a&&(10===t[r]&&(o=++r),a=!1);let i=-1;for(;r<s&&-1===i;++r)switch(t[r]){case 58:-1===n&&(n=r-o);break;case 13:a=!0;case 10:i=r}if(-1===i)break;e(t.subarray(o,i),n),o=r,n=-1}o===s?t=void 0:0!==o&&(t=t.subarray(o),r-=o)}}var re="text/event-stream",ne="last-event-id";function ae(e,t){var{signal:r,headers:n,onopen:a,onmessage:i,onclose:s,onerror:o,openWhenHidden:c,fetch:u}=t,l=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}(t,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise(((t,c)=>{let d,f=Object.assign({},n);f.accept||(f.accept=re);let p=1e3,g=0;function h(){clearTimeout(g),d?.abort()}r?.addEventListener("abort",(()=>{h(),t()}));let y=u??y,m=a??ie;async function v(){var r;d=typeof AbortController>"u"?null:new AbortController;try{let r=await y(e,Object.assign(Object.assign({},l),{headers:f,signal:d?.signal}));await m(r),await async function(e,t){let r,n=e.getReader();for(;!(r=await n.read()).done;)t(r.value)}(r.body,te(function(e,t,r){let n={data:"",event:"",id:"",retry:void 0},a=new TextDecoder;return function(i,s){if(0===i.length)r?.(n),n={data:"",event:"",id:"",retry:void 0};else if(s>0){let r=a.decode(i.subarray(0,s)),o=s+(32===i[s+1]?2:1),c=a.decode(i.subarray(o));switch(r){case"data":n.data=n.data?n.data+"\n"+c:c;break;case"event":n.event=c;break;case"id":e(n.id=c);break;case"retry":let r=parseInt(c,10);isNaN(r)||t(n.retry=r)}}}}((e=>{e?f[ne]=e:delete f[ne]}),(e=>{p=e}),i))),s?.(),h(),t()}catch(e){if(!d?.signal.aborted)try{let t=null!==(r=o?.(e))&&void 0!==r?r:p;clearTimeout(g),g=setTimeout(v,t)}catch(e){h(),c(e)}}}v()}))}function ie(e){let t=e.headers.get("content-type");if(!t?.startsWith(re))throw new Error(`Expected content-type to be ${re}, Actual: ${t}`)}var se=class{constructor(e){k(this,"_basePath"),k(this,"_params",{}),this._basePath=e}addParam(e,t){this._params={...this.params,[e]:t}}get basePath(){return this._basePath}get params(){return this._params}get hasParams(){return Object.entries(this._params).length}get href(){return this.hasParams?`${this.basePath}?${Object.entries(this.params).map((([e,t])=>`${e}=${encodeURIComponent(t)}`)).join("&")}`:this.basePath}},oe=class extends Error{},ce=class extends Error{constructor(e){super(e.message),this.payload=e}},ue=class{constructor(e){k(this,"logger"),this.logger=e.logger}streamGeneratedAnswer(e,t){let{url:r,organizationId:n,streamId:a,accessToken:i}=e,{write:s,abort:o,close:c,resetAnswer:u}=t,l=new class{constructor(){k(this,"timeouts",new Set)}add(e){this.timeouts.add(e)}remove(e){clearTimeout(e),this.timeouts.delete(e)}isActive(e){return this.timeouts.has(e)}};if(!a)return void this.logger.error("No stream ID found");let d,f=0,p=()=>{d&&!l.isActive(d)&&(h?.abort(),u(),y())},g=()=>{l.remove(d),d=function(e,t,r){return clearTimeout(t),setTimeout(e,r)}(p,d,5e3),l.add(d)},h=new AbortController,y=()=>ae(((e,t,r)=>new se(`${e}/rest/organizations/${t}/machinelearning/streaming/${r}`).href)(r,n,a),{method:"GET",fetch:fetch,headers:{Authorization:`Bearer ${i}`,accept:"*/*"},openWhenHidden:!0,signal:h?.signal,async onopen(e){if(!e.ok||"text/event-stream"!==e.headers.get("content-type"))throw e.status>=400&&e.status<500&&429!==e.status?new ce({message:"Error opening stream",code:e.status}):new oe},onmessage:e=>{if(h?.signal.aborted)return;let t=JSON.parse(e.data);if("ERROR"===t.finishReason)return l.remove(d),h?.abort(),void o({message:t.errorMessage,code:t.statusCode});s(t),f=0,"COMPLETED"===t.finishReason?(l.remove(d),c()):g()},onerror:e=>{if(!h?.signal.aborted){if(l.remove(d),e instanceof ce)throw h?.abort(),o(e),e;if(++f>3){this.logger.info("Maximum retry exceeded.");let e={message:"Failed to complete stream.",code:1};throw h?.abort(),o(e),new ce(e)}this.logger.info(`Retrying...(${f}/3)`),u()}}});return y(),h}},le=q(M(),1),de=class extends Error{constructor(){super(),this.name="ExpiredToken",this.message="The token being used to perform the request is expired."}},fe=class extends Error{constructor(e,t){super(),k(this,"statusCode"),this.name="Disconnected",this.message=`Client could not connect to the following URL: ${e}`,this.statusCode=t??0}};function pe(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e}function ge(e){return 429===e}var he=class e{static async call(t){let r=function(e){let{url:t,method:r,requestParams:n,contentType:a,accessToken:i,signal:s}=e,o="POST"===e.method||"PUT"===e.method,c=function(e,t){return"application/x-www-form-urlencoded"===t?function(e){return!("object"!=typeof e||!e)&&Object.values(e).every(pe)}(e)?function(e){let t=[];for(let r in e){let n=encodeURIComponent(r),a=encodeURIComponent(e[r]);t.push(`${n}=${a}`)}return t.join("&")}(e):"":JSON.stringify(e)}(n,a);return{url:t,method:r,headers:{"Content-Type":a,Authorization:`Bearer ${i}`,...e.headers},...o&&{body:c},signal:s}}(t),{logger:n}=t,a=await e.preprocessRequest(r,t);n.info(a,"Platform request");let{url:i,...s}=a,o=async()=>{let e=await fetch(i,s);if(ge(e.status))throw e;return e};try{let e=await(0,le.backOff)(o,{retry:e=>{let t=e&&ge(e.status);return t&&n.info("Platform retrying request"),t}});switch(e.status){case 419:case 401:throw n.info("Platform renewing token"),new de;case 404:throw new fe(i,e.status);default:return n.info({response:e,requestInfo:a},"Platform response"),e}}catch(e){return"Failed to fetch"===e.message?new fe(i):e}}static async preprocessRequest(e,t){let{origin:r,preprocessRequest:n,logger:a,requestMetadata:i}=t,{signal:s,...o}=e,c=K(o);try{let t=await n(e,r,i);return{...e,...t}}catch(e){a.error(e,"Platform request preprocessing failed. Returning default request options.")}return c}};function ye(e,t="prod",r="platform"){return`https://${e}${"platform"===r?"":`.${r}`}.org${"prod"===t?"":t}.coveo.com`}function me(e,t="prod"){return`${ye(e,t)}/rest/search/v2`}function ve(e,t="prod"){return`${ye(e,t,"analytics")}/rest/organizations/${e}/events/v1`}var Se=e=>e,we=e=>e,be=e=>e,Ce=e=>e;function Ie(e){let{url:t,accessToken:r,organizationId:n,authentication:a,...i}=e;return i}var qe=e=>{let{response:t}=e;return t.body?ke(e):xe(t)},ke=e=>function(e){return void 0!==e.body.exception}(e)?Ae(e):function(e){return void 0!==e.body.statusCode}(e)?e.body:{message:"unknown",statusCode:0,type:"unknown"},xe=e=>{let t=JSON.parse(JSON.stringify(e,Object.getOwnPropertyNames(e)));return{...t,message:`Client side error: ${t.message||""}`,statusCode:400,type:"ClientError"}};var Ae=e=>({message:e.body.exception.code,statusCode:e.response.status,type:e.body.exception.code}),Re=class{constructor(){k(this,"currentAbortController",null)}async enqueue(e,t){let r=this.currentAbortController,n=this.currentAbortController=new AbortController;r&&(t.warnOnAbort&&t.logger.warn("Cancelling current pending search query"),r.abort());try{return await e(n?.signal??null)}finally{this.currentAbortController===n&&(this.currentAbortController=null)}}};var Oe=(e,t,r,n)=>{let a=new se(`${e.url}${n}`);return a.addParam("organizationId",e.organizationId),e.authentication&&a.addParam("authentication",e.authentication),{accessToken:e.accessToken,method:t,contentType:r,url:a.href,origin:"searchApiFetch"}};function Fe(e){return{statusCode:e.statusCode,type:e.name,message:e.message}}function Ee(e){return{statusCode:e.code,type:e.name,message:e.message,ignored:!0}}function Te(e,t){if(t&&"AbortError"===e.name)return{error:Ee(e)};if(e instanceof fe)return{error:Fe(e)};throw e}var De=class{constructor(e){this.options=e,k(this,"apiCallsQueues",{unknown:new Re,mainSearch:new Re,facetValues:new Re,foldingCollection:new Re,instantResults:new Re})}async plan(e){let t=await he.call({...Oe(e,"POST","application/json","/plan"),requestParams:Ie(e),requestMetadata:{method:"plan"},...this.options});if(t instanceof Error)return Te(t);let r=await t.json();return void 0!==r.preprocessingOutput?{success:r}:{error:qe({response:t,body:r})}}async querySuggest(e){let t=await he.call({...Oe(e,"POST","application/json","/querySuggest"),requestMetadata:{method:"querySuggest"},requestParams:Ie(e),...this.options});if(t instanceof Error)return Te(t);let r=await t.json(),n={response:t,body:r};return void 0!==r.completions?{success:(await this.options.postprocessQuerySuggestResponseMiddleware(n)).body}:{error:qe(n)}}async search(e,t){let r=t?.origin??"unknown",n=await this.apiCallsQueues[r].enqueue((r=>he.call({...Oe(e,"POST","application/json",""),requestParams:Ie(e),requestMetadata:{method:"search",origin:t?.origin},...this.options,signal:r??void 0})),{logger:this.options.logger,warnOnAbort:!t?.disableAbortWarning});if(n instanceof Error)return Te(n,t?.disableAbortWarning);let a=await n.json(),i={response:n,body:a};return je(a)?(i.body=Ve(a),{success:(await this.options.postprocessSearchResponseMiddleware(i)).body}):{error:qe(i)}}async facetSearch(e){let t=await he.call({...Oe(e,"POST","application/json","/facet"),requestParams:Ie(e),requestMetadata:{method:"facetSearch"},...this.options});if(t instanceof Error)throw t;let r=await t.json(),n={response:t,body:r};return(await this.options.postprocessFacetSearchResponseMiddleware(n)).body}async recommendations(e){let t=await he.call({...Oe(e,"POST","application/json",""),requestParams:Ie(e),requestMetadata:{method:"recommendations"},...this.options});if(t instanceof Error)throw t;let r=await t.json();if(je(r)){let e={response:t,body:r};return e.body=Ve(r),{success:(await this.options.postprocessSearchResponseMiddleware(e)).body}}return{error:qe({response:t,body:r})}}async html(e){return(async(e,t)=>{let r=await he.call({...Oe(e,"POST","application/x-www-form-urlencoded","/html"),requestParams:Ie(e),requestMetadata:{method:"html"},...t});if(r instanceof Error)throw r;let n=function(e){return((e.headers.get("content-type")||"").split(";").find((e=>-1!==e.indexOf("charset=")))||"").split("=")[1]||"UTF-8"}(r),a=await r.arrayBuffer(),i=new TextDecoder(n).decode(a);return function(e){return"string"==typeof e}(i)?{success:i}:{error:qe({response:r,body:i})}})(e,{...this.options})}async fieldDescriptions(e){let t=await he.call({...Oe(e,"GET","application/json","/fields"),requestParams:{},requestMetadata:{method:"fieldDescriptions"},...this.options});if(t instanceof Error)throw t;let r=await t.json();return void 0!==r.fields?{success:r}:{error:qe({response:t,body:r})}}},Me=e=>void 0!==e.success,Pe=e=>void 0!==e.error;function je(e){return void 0!==e.results}function Ve(e){let t={answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0};return c(e.questionAnswer)?(e.questionAnswer=t,e):(e.questionAnswer={...t,...e.questionAnswer},e)}var _e=new e({required:!0,emptyAllowed:!1}),Ue=new e({required:!1,emptyAllowed:!1}),Qe=new e({required:!0,emptyAllowed:!0}),$e=new e({required:!1,emptyAllowed:!0}),Le=new t({each:_e,required:!0}),Ne=new e({required:!1,emptyAllowed:!1,regex:/^\d+\.\d+\.\d+$/}),Be=({message:e,name:t,stack:r})=>({message:e,name:t,stack:r}),ze=(e,t)=>{if("required"in t)return{payload:new o({value:t}).validate({value:e}).value};let n=new r({options:{required:!0},values:t}).validate(e);if(n)throw new f(n);return{payload:e}},He=(e,t)=>{try{return ze(e,t)}catch(t){return{payload:e,error:Be(t)}}},Ye=(e,t,r,n)=>Ge(e,t,r,`Check the initialState of ${n}`,"Controller initialization error"),We=(e,t,r,n)=>Ge(e,t,r,`Check the options of ${n}`,"Controller initialization error"),Ge=(e,t,r,n,a)=>{try{return t.validate(r,n)}catch(t){throw e.logger.error(t,a),t}};function Ke(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Je="function"==typeof Symbol&&Symbol.observable||"@@observable",Ze=()=>Math.random().toString(36).substring(7).split("").join("."),Xe={INIT:`@@redux/INIT${Ze()}`,REPLACE:`@@redux/REPLACE${Ze()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Ze()}`};function et(e){if("object"!=typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}function tt(e,t,r){if("function"!=typeof e)throw new Error(Ke(2));if("function"==typeof t&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error(Ke(0));if("function"==typeof t&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if("function"!=typeof r)throw new Error(Ke(1));return r(tt)(e,t)}let n=e,a=t,i=new Map,s=i,o=0,c=!1;function u(){s===i&&(s=new Map,i.forEach(((e,t)=>{s.set(t,e)})))}function l(){if(c)throw new Error(Ke(3));return a}function d(e){if("function"!=typeof e)throw new Error(Ke(4));if(c)throw new Error(Ke(5));let t=!0;u();let r=o++;return s.set(r,e),function(){if(t){if(c)throw new Error(Ke(6));t=!1,u(),s.delete(r),i=null}}}function f(e){if(!et(e))throw new Error(Ke(7));if(typeof e.type>"u")throw new Error(Ke(8));if("string"!=typeof e.type)throw new Error(Ke(17));if(c)throw new Error(Ke(9));try{c=!0,a=n(a,e)}finally{c=!1}return(i=s).forEach((e=>{e()})),e}return f({type:Xe.INIT}),{dispatch:f,subscribe:d,getState:l,replaceReducer:function(e){if("function"!=typeof e)throw new Error(Ke(10));n=e,f({type:Xe.REPLACE})},[Je]:function(){let e=d;return{subscribe(t){if("object"!=typeof t||null===t)throw new Error(Ke(11));function r(){let e=t;e.next&&e.next(l())}return r(),{unsubscribe:e(r)}},[Je](){return this}}}}}function rt(e){let t=Object.keys(e),r={};for(let n=0;n<t.length;n++){let a=t[n];"function"==typeof e[a]&&(r[a]=e[a])}let n,a=Object.keys(r);try{!function(e){Object.keys(e).forEach((t=>{let r=e[t];if(typeof r(void 0,{type:Xe.INIT})>"u")throw new Error(Ke(12));if(typeof r(void 0,{type:Xe.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Ke(13))}))}(r)}catch(e){n=e}return function(e={},t){if(n)throw n;let i=!1,s={};for(let n=0;n<a.length;n++){let o=a[n],c=r[o],u=e[o],l=c(u,t);if(typeof l>"u")throw t&&t.type,new Error(Ke(14));s[o]=l,i=i||l!==u}return i=i||a.length!==Object.keys(e).length,i?s:e}}function nt(...e){return 0===e.length?e=>e:1===e.length?e[0]:e.reduce(((e,t)=>(...r)=>e(t(...r))))}function at(e){return et(e)&&"type"in e&&"string"==typeof e.type}var it=Symbol.for("immer-nothing"),st=Symbol.for("immer-draftable"),ot=Symbol.for("immer-state");function ct(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var ut=Object.getPrototypeOf;function lt(e){return!!e&&!!e[ot]}function dt(e){return!!e&&(pt(e)||Array.isArray(e)||!!e[st]||!!e.constructor?.[st]||St(e)||wt(e))}var ft=Object.prototype.constructor.toString();function pt(e){if(!e||"object"!=typeof e)return!1;let t=ut(e);if(null===t)return!0;let r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===ft}function gt(e,t){0===ht(e)?Reflect.ownKeys(e).forEach((r=>{t(r,e[r],e)})):e.forEach(((r,n)=>t(n,r,e)))}function ht(e){let t=e[ot];return t?t.type_:Array.isArray(e)?1:St(e)?2:wt(e)?3:0}function yt(e,t){return 2===ht(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function mt(e,t){return 2===ht(e)?e.get(t):e[t]}function vt(e,t,r){let n=ht(e);2===n?e.set(t,r):3===n?e.add(r):e[t]=r}function St(e){return e instanceof Map}function wt(e){return e instanceof Set}function bt(e){return e.copy_||e.base_}function Ct(e,t){if(St(e))return new Map(e);if(wt(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);let r=pt(e);if(!0===t||"class_only"===t&&!r){let t=Object.getOwnPropertyDescriptors(e);delete t[ot];let r=Reflect.ownKeys(t);for(let n=0;n<r.length;n++){let a=r[n],i=t[a];!1===i.writable&&(i.writable=!0,i.configurable=!0),(i.get||i.set)&&(t[a]={configurable:!0,writable:!0,enumerable:i.enumerable,value:e[a]})}return Object.create(ut(e),t)}{let t=ut(e);if(null!==t&&r)return{...e};let n=Object.create(t);return Object.assign(n,e)}}function It(e,t=!1){return kt(e)||lt(e)||!dt(e)||(ht(e)>1&&(e.set=e.add=e.clear=e.delete=qt),Object.freeze(e),t&&Object.entries(e).forEach((([e,t])=>It(t,!0)))),e}function qt(){ct(2)}function kt(e){return Object.isFrozen(e)}var xt,At={};function Rt(e){let t=At[e];return t||ct(0),t}function Ot(){return xt}function Ft(e,t){t&&(Rt("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Et(e){Tt(e),e.drafts_.forEach(Mt),e.drafts_=null}function Tt(e){e===xt&&(xt=e.parent_)}function Dt(e){return xt=function(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}(xt,e)}function Mt(e){let t=e[ot];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function Pt(e,t){t.unfinalizedDrafts_=t.drafts_.length;let r=t.drafts_[0];return void 0!==e&&e!==r?(r[ot].modified_&&(Et(t),ct(4)),dt(e)&&(e=jt(t,e),t.parent_||_t(t,e)),t.patches_&&Rt("Patches").generateReplacementPatches_(r[ot].base_,e,t.patches_,t.inversePatches_)):e=jt(t,r,[]),Et(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==it?e:void 0}function jt(e,t,r){if(kt(t))return t;let n=t[ot];if(!n)return gt(t,((a,i)=>Vt(e,n,t,a,i,r))),t;if(n.scope_!==e)return t;if(!n.modified_)return _t(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;let t=n.copy_,a=t,i=!1;3===n.type_&&(a=new Set(t),t.clear(),i=!0),gt(a,((a,s)=>Vt(e,n,t,a,s,r,i))),_t(e,t,!1),r&&e.patches_&&Rt("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function Vt(e,t,r,n,a,i,s){if(lt(a)){let s=jt(e,a,i&&t&&3!==t.type_&&!yt(t.assigned_,n)?i.concat(n):void 0);if(vt(r,n,s),!lt(s))return;e.canAutoFreeze_=!1}else s&&r.add(a);if(dt(a)&&!kt(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;jt(e,a),(!t||!t.scope_.parent_)&&"symbol"!=typeof n&&Object.prototype.propertyIsEnumerable.call(r,n)&&_t(e,a)}}function _t(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&It(t,r)}var Ut={get(e,t){if(t===ot)return e;let r=bt(e);if(!yt(r,t))return function(e,t,r){let n=Lt(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}(e,r,t);let n=r[t];return e.finalized_||!dt(n)?n:n===$t(e.base_,t)?(Bt(e),e.copy_[t]=zt(n,e)):n},has:(e,t)=>t in bt(e),ownKeys:e=>Reflect.ownKeys(bt(e)),set(e,t,r){let n=Lt(bt(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){let n=$t(bt(e),t),a=n?.[ot];if(a&&a.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(r,n)&&(void 0!==r||yt(e.base_,t)))return!0;Bt(e),Nt(e)}return e.copy_[t]===r&&(void 0!==r||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==$t(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,Bt(e),Nt(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){let r=bt(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:n.enumerable,value:r[t]}},defineProperty(){ct(11)},getPrototypeOf:e=>ut(e.base_),setPrototypeOf(){ct(12)}},Qt={};function $t(e,t){let r=e[ot];return(r?bt(r):e)[t]}function Lt(e,t){if(!(t in e))return;let r=ut(e);for(;r;){let e=Object.getOwnPropertyDescriptor(r,t);if(e)return e;r=ut(r)}}function Nt(e){e.modified_||(e.modified_=!0,e.parent_&&Nt(e.parent_))}function Bt(e){e.copy_||(e.copy_=Ct(e.base_,e.scope_.immer_.useStrictShallowCopy_))}gt(Ut,((e,t)=>{Qt[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),Qt.deleteProperty=function(e,t){return Qt.set.call(this,e,t,void 0)},Qt.set=function(e,t,r){return Ut.set.call(this,e[0],t,r,e[0])};function zt(e,t){let r=St(e)?Rt("MapSet").proxyMap_(e,t):wt(e)?Rt("MapSet").proxySet_(e,t):function(e,t){let r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:Ot(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},a=n,i=Ut;r&&(a=[n],i=Qt);let{revoke:s,proxy:o}=Proxy.revocable(a,i);return n.draft_=o,n.revoke_=s,o}(e,t);return(t?t.scope_:Ot()).drafts_.push(r),r}function Ht(e){if(!dt(e)||kt(e))return e;let t,r=e[ot];if(r){if(!r.modified_)return r.base_;r.finalized_=!0,t=Ct(e,r.scope_.immer_.useStrictShallowCopy_)}else t=Ct(e,!0);return gt(t,((e,r)=>{vt(t,e,Ht(r))})),r&&(r.finalized_=!1),t}function Yt(){let e="replace",t="add",r="remove";function n(e){if(!dt(e))return e;if(Array.isArray(e))return e.map(n);if(St(e))return new Map(Array.from(e.entries()).map((([e,t])=>[e,n(t)])));if(wt(e))return new Set(Array.from(e).map(n));let t=Object.create(ut(e));for(let r in e)t[r]=n(e[r]);return yt(e,st)&&(t[st]=e[st]),t}function a(e){return lt(e)?n(e):e}!function(e,t){At[e]||(At[e]=t)}("Patches",{applyPatches_:function(a,i){return i.forEach((i=>{let{path:s,op:o}=i,c=a;for(let e=0;e<s.length-1;e++){let t=ht(c),r=s[e];"string"!=typeof r&&"number"!=typeof r&&(r=""+r),(0===t||1===t)&&("__proto__"===r||"constructor"===r)&&ct(19),"function"==typeof c&&"prototype"===r&&ct(19),c=mt(c,r),"object"!=typeof c&&ct(18,s.join("/"))}let u=ht(c),l=n(i.value),d=s[s.length-1];switch(o){case e:switch(u){case 2:return c.set(d,l);case 3:ct(16);default:return c[d]=l}case t:switch(u){case 1:return"-"===d?c.push(l):c.splice(d,0,l);case 2:return c.set(d,l);case 3:return c.add(l);default:return c[d]=l}case r:switch(u){case 1:return c.splice(d,1);case 2:return c.delete(d);case 3:return c.delete(i.value);default:return delete c[d]}default:ct(17)}})),a},generatePatches_:function(n,i,s,o){switch(n.type_){case 0:case 2:return function(n,i,s,o){let{base_:c,copy_:u}=n;gt(n.assigned_,((n,l)=>{let d=mt(c,n),f=mt(u,n),p=l?yt(c,n)?e:t:r;if(d===f&&p===e)return;let g=i.concat(n);s.push(p===r?{op:p,path:g}:{op:p,path:g,value:f}),o.push(p===t?{op:r,path:g}:p===r?{op:t,path:g,value:a(d)}:{op:e,path:g,value:a(d)})}))}(n,i,s,o);case 1:return function(n,i,s,o){let{base_:c,assigned_:u}=n,l=n.copy_;l.length<c.length&&([c,l]=[l,c],[s,o]=[o,s]);for(let t=0;t<c.length;t++)if(u[t]&&l[t]!==c[t]){let r=i.concat([t]);s.push({op:e,path:r,value:a(l[t])}),o.push({op:e,path:r,value:a(c[t])})}for(let e=c.length;e<l.length;e++){let r=i.concat([e]);s.push({op:t,path:r,value:a(l[e])})}for(let e=l.length-1;c.length<=e;--e){let t=i.concat([e]);o.push({op:r,path:t})}}(n,i,s,o);case 3:return function(e,n,a,i){let{base_:s,copy_:o}=e,c=0;s.forEach((e=>{if(!o.has(e)){let s=n.concat([c]);a.push({op:r,path:s,value:e}),i.unshift({op:t,path:s,value:e})}c++})),c=0,o.forEach((e=>{if(!s.has(e)){let s=n.concat([c]);a.push({op:t,path:s,value:e}),i.unshift({op:r,path:s,value:e})}c++}))}(n,i,s,o)}},generateReplacementPatches_:function(t,r,n,a){n.push({op:e,path:[],value:r===it?void 0:r}),a.push({op:e,path:[],value:t})}})}var Wt=new class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,r)=>{if("function"==typeof e&&"function"!=typeof t){let r=t;t=e;let n=this;return function(e=r,...a){return n.produce(e,(e=>t.call(this,e,...a)))}}let n;if("function"!=typeof t&&ct(6),void 0!==r&&"function"!=typeof r&&ct(7),dt(e)){let a=Dt(this),i=zt(e,void 0),s=!0;try{n=t(i),s=!1}finally{s?Et(a):Tt(a)}return Ft(a,r),Pt(n,a)}if(!e||"object"!=typeof e){if(n=t(e),void 0===n&&(n=e),n===it&&(n=void 0),this.autoFreeze_&&It(n,!0),r){let t=[],a=[];Rt("Patches").generateReplacementPatches_(e,n,t,a),r(t,a)}return n}ct(1)},this.produceWithPatches=(e,t)=>{if("function"==typeof e)return(t,...r)=>this.produceWithPatches(t,(t=>e(t,...r)));let r,n;return[this.produce(e,t,((e,t)=>{r=e,n=t})),r,n]},"boolean"==typeof e?.autoFreeze&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof e?.useStrictShallowCopy&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){dt(e)||ct(8),lt(e)&&(e=function(e){return lt(e)||ct(10),Ht(e)}(e));let t=Dt(this),r=zt(e,void 0);return r[ot].isManual_=!0,Tt(t),r}finishDraft(e,t){let r=e&&e[ot];(!r||!r.isManual_)&&ct(9);let{scope_:n}=r;return Ft(n,t),Pt(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){let n=t[r];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}r>-1&&(t=t.slice(r+1));let n=Rt("Patches").applyPatches_;return lt(e)?n(e,t):this.produce(e,(e=>n(e,t)))}},Gt=Wt.produce,Kt=Wt.produceWithPatches.bind(Wt);Wt.setAutoFreeze.bind(Wt),Wt.setUseStrictShallowCopy.bind(Wt);var Jt=Wt.applyPatches.bind(Wt);Wt.createDraft.bind(Wt),Wt.finishDraft.bind(Wt);var Zt=e=>Array.isArray(e)?e:[e];function Xt(e){let t=Array.isArray(e[0])?e[0]:e;return function(e,t="expected all items to be functions, instead received the following types: "){if(!e.every((e=>"function"==typeof e))){let r=e.map((e=>"function"==typeof e?`function ${e.name||"unnamed"}()`:typeof e)).join(", ");throw new TypeError(`${t}[${r}]`)}}(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}var er=typeof WeakRef<"u"?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}},tr=0,rr=1;function nr(){return{s:tr,v:void 0,o:null,p:null}}function ar(e,t={}){let r,n=nr(),{resultEqualityCheck:a}=t,i=0;function s(){let t=n,{length:s}=arguments;for(let e=0,r=s;e<r;e++){let r=arguments[e];if("function"==typeof r||"object"==typeof r&&null!==r){let e=t.o;null===e&&(t.o=e=new WeakMap);let n=e.get(r);void 0===n?(t=nr(),e.set(r,t)):t=n}else{let e=t.p;null===e&&(t.p=e=new Map);let n=e.get(r);void 0===n?(t=nr(),e.set(r,t)):t=n}}let o,c=t;if(t.s===rr)o=t.v;else if(o=e.apply(null,arguments),i++,a){let e=r?.deref?.()??r;null!=e&&a(e,o)&&(o=e,0!==i&&i--),r="object"==typeof o&&null!==o||"function"==typeof o?new er(o):o}return c.s=rr,c.v=o,o}return s.clearCache=()=>{n=nr(),s.resetResultsCount()},s.resultsCount=()=>i,s.resetResultsCount=()=>{i=0},s}var ir=function(e,...t){let r="function"==typeof e?{memoize:e,memoizeOptions:t}:e,n=(...e)=>{let t,n=0,a=0,i={},s=e.pop();"object"==typeof s&&(i=s,s=e.pop()),function(e,t="expected a function, instead received "+typeof e){if("function"!=typeof e)throw new TypeError(t)}(s,`createSelector expects an output function after the inputs, but received: [${typeof s}]`);let o={...r,...i},{memoize:c,memoizeOptions:u=[],argsMemoize:l=ar,argsMemoizeOptions:d=[],devModeChecks:f={}}=o,p=Zt(u),g=Zt(d),h=Xt(e),y=c((function(){return n++,s.apply(null,arguments)}),...p),m=l((function(){a++;let e=function(e,t){let r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}(h,arguments);return t=y.apply(null,e),t}),...g);return Object.assign(m,{resultFunc:s,memoizedResultFunc:y,dependencies:h,dependencyRecomputations:()=>a,resetDependencyRecomputations:()=>{a=0},lastResult:()=>t,recomputations:()=>n,resetRecomputations:()=>{n=0},memoize:c,argsMemoize:l})};return Object.assign(n,{withTypes:()=>n}),n}(ar),sr=Object.assign(((e,t=ir)=>{!function(e,t="expected an object, instead received "+typeof e){if("object"!=typeof e)throw new TypeError(t)}(e,"createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);let r=Object.keys(e);return t(r.map((t=>e[t])),((...e)=>e.reduce(((e,t,n)=>(e[r[n]]=t,e)),{})))}),{withTypes:()=>sr});function or(e){return({dispatch:t,getState:r})=>n=>a=>"function"==typeof a?a(t,r,e):n(a)}var cr=or(),ur=or,lr=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?nt:nt.apply(null,arguments)};function dr(e,t){function r(...r){if(t){let n=t(...r);if(!n)throw new Error(Kr(0));return{type:e,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:e,payload:r[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=t=>at(t)&&t.type===e,r}var fr=class e extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(...e){return super.concat.apply(this,e)}prepend(...t){return 1===t.length&&Array.isArray(t[0])?new e(...t[0].concat(this)):new e(...t.concat(this))}};function pr(e){return dt(e)?Gt(e,(()=>{})):e}function gr(e,t,r){if(e.has(t)){let n=e.get(t);return r.update&&(n=r.update(n,t,e),e.set(t,n)),n}if(!r.insert)throw new Error(Kr(10));let n=r.insert(t,e);return e.set(t,n),n}var hr=()=>function(e){let{thunk:t=!0,immutableCheck:r=!0,serializableCheck:n=!0,actionCreatorCheck:a=!0}=e??{},i=new fr;return t&&("boolean"==typeof t?i.push(cr):i.push(ur(t.extraArgument))),i},yr="RTK_autoBatch",mr=()=>e=>({payload:e,meta:{[yr]:!0}}),vr=e=>t=>{setTimeout(t,e)},Sr=typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:vr(10),wr=e=>function(t){let{autoBatch:r=!0}=t??{},n=new fr(e);return r&&n.push(((e={type:"raf"})=>t=>(...r)=>{let n=t(...r),a=!0,i=!1,s=!1,o=new Set,c="tick"===e.type?queueMicrotask:"raf"===e.type?Sr:"callback"===e.type?e.queueNotification:vr(e.timeout),u=()=>{s=!1,i&&(i=!1,o.forEach((e=>e())))};return Object.assign({},n,{subscribe(e){let t=n.subscribe((()=>a&&e()));return o.add(e),()=>{t(),o.delete(e)}},dispatch(e){try{return a=!e?.meta?.[yr],i=!a,i&&(s||(s=!0,c(u))),n.dispatch(e)}finally{a=!0}}})})("object"==typeof r?r:void 0)),n};function br(e){let t,r,n=hr(),{reducer:a,middleware:i,devTools:s=!0,preloadedState:o,enhancers:c}=e||{};if("function"==typeof a)t=a;else{if(!et(a))throw new Error(Kr(1));t=rt(a)}r="function"==typeof i?i(n):n();let u=nt;s&&(u=lr({trace:!1,..."object"==typeof s&&s}));let l=function(...e){return t=>(r,n)=>{let a=t(r,n),i=()=>{throw new Error(Ke(15))},s={getState:a.getState,dispatch:(e,...t)=>i(e,...t)},o=e.map((e=>e(s)));return i=nt(...o)(a.dispatch),{...a,dispatch:i}}}(...r),d=wr(l);return tt(t,o,u(..."function"==typeof c?c(d):d()))}function Cr(e){let t,r={},n=[],a={addCase(e,t){let n="string"==typeof e?e:e.type;if(!n)throw new Error(Kr(28));if(n in r)throw new Error(Kr(29));return r[n]=t,a},addMatcher:(e,t)=>(n.push({matcher:e,reducer:t}),a),addDefaultCase:e=>(t=e,a)};return e(a),[r,n,t]}function Ir(e,t){let r,[n,a,i]=Cr(t);if(function(e){return"function"==typeof e}(e))r=()=>pr(e());else{let t=pr(e);r=()=>t}function s(e=r(),t){let s=[n[t.type],...a.filter((({matcher:e})=>e(t))).map((({reducer:e})=>e))];return 0===s.filter((e=>!!e)).length&&(s=[i]),s.reduce(((e,r)=>{if(r){if(lt(e)){let n=r(e,t);return void 0===n?e:n}if(dt(e))return Gt(e,(e=>r(e,t)));{let n=r(e,t);if(void 0===n){if(null===e)return e;throw new Error(Kr(9))}return n}}return e}),e)}return s.getInitialState=r,s}var qr=(e,t)=>(e=>e&&"function"==typeof e.match)(e)?e.match(t):e(t);function kr(...e){return t=>e.some((e=>qr(e,t)))}function xr(...e){return t=>e.every((e=>qr(e,t)))}function Ar(e,t){if(!e||!e.meta)return!1;let r="string"==typeof e.meta.requestId,n=t.indexOf(e.meta.requestStatus)>-1;return r&&n}function Rr(e){return"function"==typeof e[0]&&"pending"in e[0]&&"fulfilled"in e[0]&&"rejected"in e[0]}function Or(...e){return 0===e.length?e=>Ar(e,["pending"]):Rr(e)?kr(...e.map((e=>e.pending))):Or()(e[0])}function Fr(...e){return 0===e.length?e=>Ar(e,["rejected"]):Rr(e)?kr(...e.map((e=>e.rejected))):Fr()(e[0])}function Er(...e){let t=e=>e&&e.meta&&e.meta.rejectedWithValue;return 0===e.length||Rr(e)?xr(Fr(...e),t):Er()(e[0])}function Tr(...e){return 0===e.length?e=>Ar(e,["fulfilled"]):Rr(e)?kr(...e.map((e=>e.fulfilled))):Tr()(e[0])}function Dr(...e){return 0===e.length?e=>Ar(e,["pending","fulfilled","rejected"]):Rr(e)?kr(...e.flatMap((e=>[e.pending,e.rejected,e.fulfilled]))):Dr()(e[0])}var Mr=(e=21)=>{let t="",r=e;for(;r--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t},Pr=["name","message","stack","code"],jr=class{constructor(e,t){k(this,"_type"),this.payload=e,this.meta=t}},Vr=class{constructor(e,t){k(this,"_type"),this.payload=e,this.meta=t}},_r=e=>{if("object"==typeof e&&null!==e){let t={};for(let r of Pr)"string"==typeof e[r]&&(t[r]=e[r]);return t}return{message:String(e)}},Ur=(()=>{function e(e,t,r){let n=dr(e+"/fulfilled",((e,t,r,n)=>({payload:e,meta:{...n||{},arg:r,requestId:t,requestStatus:"fulfilled"}}))),a=dr(e+"/pending",((e,t,r)=>({payload:void 0,meta:{...r||{},arg:t,requestId:e,requestStatus:"pending"}}))),i=dr(e+"/rejected",((e,t,n,a,i)=>({payload:a,error:(r&&r.serializeError||_r)(e||"Rejected"),meta:{...i||{},arg:n,requestId:t,rejectedWithValue:!!a,requestStatus:"rejected",aborted:"AbortError"===e?.name,condition:"ConditionError"===e?.name}})));return Object.assign((function(e){return(s,o,c)=>{let u,l,d=r?.idGenerator?r.idGenerator(e):Mr(),f=new AbortController;function p(e){l=e,f.abort()}let g=async function(){let g;try{let i=r?.condition?.(e,{getState:o,extra:c});if(function(e){return null!==e&&"object"==typeof e&&"function"==typeof e.then}(i)&&(i=await i),!1===i||f.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};let h=new Promise(((e,t)=>{u=()=>{t({name:"AbortError",message:l||"Aborted"})},f.signal.addEventListener("abort",u)}));s(a(d,e,r?.getPendingMeta?.({requestId:d,arg:e},{getState:o,extra:c}))),g=await Promise.race([h,Promise.resolve(t(e,{dispatch:s,getState:o,extra:c,requestId:d,signal:f.signal,abort:p,rejectWithValue:(e,t)=>new jr(e,t),fulfillWithValue:(e,t)=>new Vr(e,t)})).then((t=>{if(t instanceof jr)throw t;return t instanceof Vr?n(t.payload,d,e,t.meta):n(t,d,e)}))])}catch(t){g=t instanceof jr?i(null,d,e,t.payload,t.meta):i(t,d,e)}finally{u&&f.signal.removeEventListener("abort",u)}return r&&!r.dispatchConditionRejection&&i.match(g)&&g.meta.condition||s(g),g}();return Object.assign(g,{abort:p,requestId:d,arg:e,unwrap:()=>g.then(Qr)})}}),{pending:a,rejected:i,fulfilled:n,settled:kr(i,n),typePrefix:e})}return e.withTypes=()=>e,e})();function Qr(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}var $r=Symbol.for("rtk-slice-createasyncthunk");function Lr(e,t){return`${e}/${t}`}function Nr(e,t,r,n){function a(a,...i){let s=t(a);return typeof s>"u"&&n&&(s=r()),e(s,...i)}return a.unwrapped=e,a}var Br=function({creators:e}={}){let t=e?.asyncThunk?.[$r];return function(e){let{name:r,reducerPath:n=r}=e;if(!r)throw new Error(Kr(11));let a=("function"==typeof e.reducers?e.reducers(function(){function e(e,t){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...t}}return e.withTypes=()=>e,{reducer:e=>Object.assign({[e.name]:(...t)=>e(...t)}[e.name],{_reducerDefinitionType:"reducer"}),preparedReducer:(e,t)=>({_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}),asyncThunk:e}}()):e.reducers)||{},i=Object.keys(a),s={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},o={addCase(e,t){let r="string"==typeof e?e:e.type;if(!r)throw new Error(Kr(12));if(r in s.sliceCaseReducersByType)throw new Error(Kr(13));return s.sliceCaseReducersByType[r]=t,o},addMatcher:(e,t)=>(s.sliceMatchers.push({matcher:e,reducer:t}),o),exposeAction:(e,t)=>(s.actionCreators[e]=t,o),exposeCaseReducer:(e,t)=>(s.sliceCaseReducersByName[e]=t,o)};function c(){let[t={},r=[],n]="function"==typeof e.extraReducers?Cr(e.extraReducers):[e.extraReducers],a={...t,...s.sliceCaseReducersByType};return Ir(e.initialState,(e=>{for(let t in a)e.addCase(t,a[t]);for(let t of s.sliceMatchers)e.addMatcher(t.matcher,t.reducer);for(let t of r)e.addMatcher(t.matcher,t.reducer);n&&e.addDefaultCase(n)}))}i.forEach((n=>{let i=a[n],s={reducerName:n,type:Lr(r,n),createNotation:"function"==typeof e.reducers};!function(e){return"asyncThunk"===e._reducerDefinitionType}(i)?function({type:e,reducerName:t,createNotation:r},n,a){let i,s;if("reducer"in n){if(r&&!function(e){return"reducerWithPrepare"===e._reducerDefinitionType}(n))throw new Error(Kr(17));i=n.reducer,s=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,s?dr(e,s):dr(e))}(s,i,o):function({type:e,reducerName:t},r,n,a){if(!a)throw new Error(Kr(18));let{payloadCreator:i,fulfilled:s,pending:o,rejected:c,settled:u,options:l}=r,d=a(e,i,l);n.exposeAction(t,d),s&&n.addCase(d.fulfilled,s),o&&n.addCase(d.pending,o),c&&n.addCase(d.rejected,c),u&&n.addMatcher(d.settled,u),n.exposeCaseReducer(t,{fulfilled:s||zr,pending:o||zr,rejected:c||zr,settled:u||zr})}(s,i,o,t)}));let u,l=e=>e,d=new Map;function f(e,t){return u||(u=c()),u(e,t)}function p(){return u||(u=c()),u.getInitialState()}function g(t,r=!1){function n(e){let n=e[t];return typeof n>"u"&&r&&(n=p()),n}function a(t=l){let n=gr(d,r,{insert:()=>new WeakMap});return gr(n,t,{insert:()=>{let n={};for(let[a,i]of Object.entries(e.selectors??{}))n[a]=Nr(i,t,p,r);return n}})}return{reducerPath:t,getSelectors:a,get selectors(){return a(n)},selectSlice:n}}let h={name:r,reducer:f,actions:s.actionCreators,caseReducers:s.sliceCaseReducersByName,getInitialState:p,...g(n),injectInto(e,{reducerPath:t,...r}={}){let a=t??n;return e.inject({reducerPath:a,reducer:f},r),{...h,...g(a,!0)}}};return h}}();function zr(){}var{assign:Hr}=Object,Yr="listenerMiddleware",Wr=Hr(dr(`${Yr}/add`),{withTypes:()=>Wr});dr(`${Yr}/removeAll`);var Gr=Hr(dr(`${Yr}/remove`),{withTypes:()=>Gr});function Kr(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Jr=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Zr(e){return{getClientId:()=>{let t="visitorId",r=e.get(),n=r.storage,a=n.getItem(t),i=a&&function(e){return"string"==typeof e&&Jr.test(e)}(a)?a:r.generateUUID();return n.setItem(t,i),i}}}var Xr="0.7.10";function en(e){return(e.source||[]).concat([`relay@${Xr}`])}function tn(e,t,r,n){let{getReferrer:a,getLocation:i,getUserAgent:s}=r,o=function(e){let{trackingId:t}=e;return{trackingId:t}}(t),c=n.getClientId();return Object.freeze({type:e,config:o,ts:Date.now(),source:en(t),clientId:c,userAgent:s(),referrer:a(),location:i()})}var rn="*";function nn(){let e=[];function t({type:t,callback:r}){return e.findIndex((e=>e.type===t&&e.callback===r))}function r(r,n){n?function(r){let n=t(r);n>=0&&e.splice(n,1)}({type:r,callback:n}):function(t){if(t===rn)e.length=0;else for(let r=e.length-1;r>=0;r--)e[r].type===t&&e.splice(r,1)}(r)}return{add:function(n){return t(n)<0&&e.push(n),()=>r(n.type,n.callback)},call:function(t){e.forEach((e=>{if(function(e,t){return"*"===e.type||t===e.type}(e,t.meta.type))try{e.callback(t)}catch(e){console.error(e)}}))},remove:r}}function an({url:e,token:t,trackingId:r,...n}){return Object.freeze({url:e,token:t,trackingId:r,...!!n.mode&&{mode:n.mode},...!!n.source&&{source:n.source}})}var sn=function(){let e="coveo_";return{getItem(t){let r=`${e}${t}=`,n=document.cookie.split(";");for(let e of n){let t=e.replace(/^\s+/,"");if(0===t.lastIndexOf(r,0))return t.substring(r.length,t.length)}return null},setItem(t,r,n){let a=(e=>{let t=e.split(".").slice(-2);return 2==t.length?t.join("."):""})(window.location.hostname),i=`;expires=${new Date((new Date).getTime()+n).toUTCString()}`,s=a?`;domain=${a}`:"";document.cookie=`${e}${t}=${r}${i}${s};path=/;SameSite=Lax`},removeItem(e){this.setItem(e,"",-1)}}}();function on(){return{runtime:"browser",send:(e,t,r)=>{let n=navigator.sendBeacon(`${e}?access_token=${t}`,new Blob([JSON.stringify([r])],{type:"application/json"}));if(function(){let e=typeof window<"u";return{sendMessage(t){e&&window.postMessage(t,"*")}}}().sendMessage({kind:"EVENT_PROTOCOL",event:r,url:e,token:t}),!n)throw new Error("Failed to send the event(s) because the payload size exceeded the maximum allowed size (32 KB). Please contact support if the problem persists.")},getReferrer:()=>function(){let e=document.referrer;return""===e?null:e}(),getLocation:()=>window.location.href,getUserAgent:()=>navigator.userAgent,generateUUID:()=>crypto.randomUUID(),storage:{getItem:e=>sn.getItem(e)||localStorage.getItem(e),removeItem(e){sn.removeItem(e),localStorage.removeItem(e)},setItem(e,t){localStorage.setItem(e,t),sn.setItem(e,t,31556952e3)}}}}function cn(e){return"disabled"!==e.get().mode&&function(){try{return"object"==typeof window}catch{return!1}}()&&function(){try{let e="__storage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return e instanceof DOMException&&"QuotaExceededError"===e.name&&localStorage&&0!==localStorage.length}}()?on():{runtime:"null",send:()=>{},getReferrer:()=>null,getLocation:()=>null,getUserAgent:()=>null,generateUUID:()=>"",storage:{getItem:()=>null,removeItem(){},setItem(){}}}}function un(e){let t=function(e){let t=an(e);return{get:()=>t,update:e=>{t=an({...t,...e})}}}(e),r=nn(),n=function(e){return{get:()=>Object.freeze(cn(e))}}(t),a=Zr(n);return{emit:(e,i)=>{let s=t.get(),o=n.get(),c=function(e,t,r,n,a){return{...t,meta:tn(e,r,n,a)}}(e,i,s,o,a);return function({config:e,environment:t,event:r,listenerManager:n}){let{url:a,token:i,mode:s}=e;"disabled"!==s&&(n.call(r),t.send(a,i,r))}({config:s,environment:o,event:c,listenerManager:r})},getMeta:e=>tn(e,t.get(),n.get(),a),on:(e,t)=>r.add({type:e,callback:t}),off:(e,t)=>r.remove(e,t),updateConfig:e=>t.update(e),version:Xr}}var ln,dn,fn="3.10.0",pn=ir((e=>e.source),(e=>Object.entries(e).map((([e,t])=>`${e}@${t}`)).concat(`@coveo/headless@${fn}`))),gn=ir((e=>e.configuration.organizationId),(e=>e.configuration.environment),(e=>e.configuration.accessToken),(e=>e.configuration.analytics),(e=>pn(e.configuration.analytics)),((e,t,r,{trackingId:n,apiBaseUrl:a,enabled:i},s)=>un({mode:i?"emit":"disabled",url:a??ve(e,t),token:r,trackingId:n,source:s})));function hn(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}function yn(e,t,r,n){return new(r||(r=Promise))((function(a,i){function s(e){try{c(n.next(e))}catch(e){i(e)}}function o(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){e.done?a(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(s,o)}c((n=n.apply(e,t||[])).next())}))}function mn(){return typeof window<"u"}function vn(){return typeof navigator<"u"}function Sn(){return typeof document<"u"}function wn(){try{return typeof localStorage<"u"}catch{return!1}}function bn(){return vn()&&navigator.cookieEnabled}(dn=ln||(ln={})).search="search",dn.click="click",dn.custom="custom",dn.view="view",dn.collect="collect";var Cn=[ln.click,ln.custom,ln.search,ln.view],In=(e,t)=>-1!==Cn.indexOf(e)?Object.assign({language:Sn()?document.documentElement.lang:"unknown",userAgent:vn()?navigator.userAgent:"unknown"},t):t,qn=class e{static set(e,t,r){var n,a,i;r&&(n=new Date).setTime(n.getTime()+r),-1===(i=window.location.hostname).indexOf(".")?kn(e,t,n):kn(e,t,n,(a=i.split("."))[a.length-2]+"."+a[a.length-1])}static get(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){var a=r[n];if(0===(a=a.replace(/^\s+/,"")).lastIndexOf(t,0))return a.substring(t.length,a.length)}return null}static erase(t){e.set(t,"",-1)}};function kn(e,t,r,n){document.cookie=`${e}=${t}`+(r?`;expires=${r.toUTCString()}`:"")+(n?`;domain=${n}`:"")+";path=/;SameSite=Lax"}function xn(){return wn()?localStorage:bn()?new An:function(){try{return typeof sessionStorage<"u"}catch{return!1}}()?sessionStorage:new On}var An=class e{getItem(t){return qn.get(`${e.prefix}${t}`)}removeItem(t){qn.erase(`${e.prefix}${t}`)}setItem(t,r,n){qn.set(`${e.prefix}${t}`,r,n)}};An.prefix="coveo_";var Rn,On=class{getItem(e){return null}removeItem(e){}setItem(e,t){}},Fn="__coveo.analytics.history",En=class{constructor(e){this.store=e||xn()}addElement(e){e.internalTime=(new Date).getTime(),e=this.cropQueryElement(this.stripEmptyQuery(e));let t=this.getHistoryWithInternalTime();null!=t?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])}addElementAsync(e){return yn(this,void 0,void 0,(function*(){e.internalTime=(new Date).getTime(),e=this.cropQueryElement(this.stripEmptyQuery(e));let t=yield this.getHistoryWithInternalTimeAsync();null!=t?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])}))}getHistory(){let e=this.getHistoryWithInternalTime();return this.stripEmptyQueries(this.stripInternalTime(e))}getHistoryAsync(){return yn(this,void 0,void 0,(function*(){let e=yield this.getHistoryWithInternalTimeAsync();return this.stripEmptyQueries(this.stripInternalTime(e))}))}getHistoryWithInternalTime(){try{let e=this.store.getItem(Fn);return e&&"string"==typeof e?JSON.parse(e):[]}catch{return[]}}getHistoryWithInternalTimeAsync(){return yn(this,void 0,void 0,(function*(){try{let e=yield this.store.getItem(Fn);return e?JSON.parse(e):[]}catch{return[]}}))}setHistory(e){try{this.store.setItem(Fn,JSON.stringify(e.slice(0,20)))}catch{}}clear(){try{this.store.removeItem(Fn)}catch{}}getMostRecentElement(){let e=this.getHistoryWithInternalTime();return Array.isArray(e)?e.sort(((e,t)=>(t.internalTime||0)-(e.internalTime||0)))[0]:null}cropQueryElement(e){return e.name&&e.value&&"query"===e.name.toLowerCase()&&(e.value=e.value.slice(0,75)),e}isValidEntry(e){let t=this.getMostRecentElement();return!t||t.value!=e.value||(e.internalTime||0)-(t.internalTime||0)>6e4}stripInternalTime(e){return Array.isArray(e)?e.map((e=>{let{name:t,time:r,value:n}=e;return{name:t,time:r,value:n}})):[]}stripEmptyQuery(e){let{name:t,time:r,value:n}=e;return t&&"string"==typeof n&&"query"===t.toLowerCase()&&""===n.trim()?{name:t,time:r}:e}stripEmptyQueries(e){return e.map((e=>this.stripEmptyQuery(e)))}},Tn=Object.freeze({__proto__:null,HistoryStore:En,MAX_NUMBER_OF_HISTORY_ELEMENTS:20,MAX_VALUE_SIZE:75,MIN_THRESHOLD_FOR_DUPLICATE_VALUE:6e4,STORE_KEY:Fn,default:En}),Dn=(e,t)=>yn(void 0,void 0,void 0,(function*(){return e===ln.view?(yield Mn(t.contentIdValue),Object.assign({location:window.location.toString(),referrer:document.referrer,title:document.title},t)):t})),Mn=e=>yn(void 0,void 0,void 0,(function*(){let t=new En,r={name:"PageView",value:e,time:(new Date).toISOString()};yield t.addElementAsync(r)})),Pn=new Uint8Array(16);function jn(){if(!Rn&&!(Rn=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Rn(Pn)}var Vn=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function _n(e){return"string"==typeof e&&Vn.test(e)}var Un=[];for(let e=0;e<256;++e)Un.push((e+256).toString(16).slice(1));function Qn(e,t=0){return(Un[e[t+0]]+Un[e[t+1]]+Un[e[t+2]]+Un[e[t+3]]+"-"+Un[e[t+4]]+Un[e[t+5]]+"-"+Un[e[t+6]]+Un[e[t+7]]+"-"+Un[e[t+8]]+Un[e[t+9]]+"-"+Un[e[t+10]]+Un[e[t+11]]+Un[e[t+12]]+Un[e[t+13]]+Un[e[t+14]]+Un[e[t+15]]).toLowerCase()}var $n={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function Ln(e,t,r){if($n.randomUUID&&!t&&!e)return $n.randomUUID();let n=(e=e||{}).random||(e.rng||jn)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return Qn(n)}function Nn(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:case 3:return t^r^n;case 2:return t&r^t&n^r&n}}function Bn(e,t){return e<<t|e>>>32-t}var zn=function(e,t,r){function n(e,n,a,i){var s;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof n&&(n=function(e){if(!_n(e))throw TypeError("Invalid UUID");let t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r}(n)),16!==(null===(s=n)||void 0===s?void 0:s.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let o=new Uint8Array(16+e.length);if(o.set(n),o.set(e,n.length),o=r(o),o[6]=15&o[6]|t,o[8]=63&o[8]|128,a){i=i||0;for(let e=0;e<16;++e)a[i+e]=o[e];return a}return Qn(o)}try{n.name=e}catch{}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n}("v5",80,(function(e){let t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){let t=unescape(encodeURIComponent(e));e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);let n=e.length/4+2,a=Math.ceil(n/16),i=new Array(a);for(let t=0;t<a;++t){let r=new Uint32Array(16);for(let n=0;n<16;++n)r[n]=e[64*t+4*n]<<24|e[64*t+4*n+1]<<16|e[64*t+4*n+2]<<8|e[64*t+4*n+3];i[t]=r}i[a-1][14]=8*(e.length-1)/Math.pow(2,32),i[a-1][14]=Math.floor(i[a-1][14]),i[a-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<a;++e){let n=new Uint32Array(80);for(let t=0;t<16;++t)n[t]=i[e][t];for(let e=16;e<80;++e)n[e]=Bn(n[e-3]^n[e-8]^n[e-14]^n[e-16],1);let a=r[0],s=r[1],o=r[2],c=r[3],u=r[4];for(let e=0;e<80;++e){let r=Math.floor(e/20),i=Bn(a,5)+Nn(r,s,o,c)+u+t[r]+n[e]>>>0;u=c,c=o,o=Bn(s,30)>>>0,s=a,a=i}r[0]=r[0]+a>>>0,r[1]=r[1]+s>>>0,r[2]=r[2]+o>>>0,r[3]=r[3]+c>>>0,r[4]=r[4]+u>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]})),Hn=zn,Yn="2.30.42",Wn=class e{constructor(e,t){if(!_n(e))throw Error("Not a valid uuid");this.clientId=e,this.creationDate=Math.floor(t/1e3)}toString(){return this.clientId.replace(/-/g,"")+"."+this.creationDate.toString()}get expired(){let t=Math.floor(Date.now()/1e3)-this.creationDate;return t<0||t>e.expirationTime}validate(e,t){return!this.expired&&this.matchReferrer(e,t)}matchReferrer(e,t){try{let r=new URL(e);return t.some((e=>new RegExp(e.replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")+"$").test(r.host)))}catch{return!1}}static fromString(t){let r=t.split(".");if(2!==r.length)return null;let[n,a]=r;if(32!==n.length||isNaN(parseInt(a)))return null;let i=n.substring(0,8)+"-"+n.substring(8,12)+"-"+n.substring(12,16)+"-"+n.substring(16,20)+"-"+n.substring(20,32);return _n(i)?new e(i,1e3*Number.parseInt(a)):null}};Wn.cvo_cid="cvo_cid",Wn.expirationTime=120;var Gn=Object.keys;function Kn(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}var Jn=192,Zn=224,Xn=240;function ea(e){return(248&e)===Xn?4:(e&Xn)===Zn?3:(e&Zn)===Jn?2:1}var ta={id:"svc_ticket_id",subject:"svc_ticket_subject",description:"svc_ticket_description",category:"svc_ticket_category",productId:"svc_ticket_product_id",custom:"svc_ticket_custom"},ra=Gn(ta).map((e=>ta[e])),na=[...ra].join("|"),aa=new RegExp(`^(${na}$)`),ia=[e=>aa.test(e)],sa={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",price:"pr",quantity:"qt",coupon:"cc",position:"ps",group:"group"},oa={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",position:"ps",price:"pr",group:"group"},ca={action:"pa",list:"pal",listSource:"pls"},ua={id:"ti",revenue:"tr",tax:"tt",shipping:"ts",coupon:"tcc",affiliation:"ta",step:"cos",option:"col"},la={id:"quoteId",affiliation:"quoteAffiliation"},da={id:"reviewId",rating:"reviewRating",comment:"reviewComment"},fa={add:ca,bookmark_add:ca,bookmark_remove:ca,click:ca,checkout:ca,checkout_option:ca,detail:ca,impression:ca,remove:ca,refund:Object.assign(Object.assign({},ca),ua),purchase:Object.assign(Object.assign({},ca),ua),quickview:ca,quote:Object.assign(Object.assign({},ca),la),review:Object.assign(Object.assign({},ca),da)},pa=Gn(sa).map((e=>sa[e])),ga=Gn(oa).map((e=>oa[e])),ha=Gn(ca).map((e=>ca[e])),ya=Gn(ua).map((e=>ua[e])),ma=Gn(da).map((e=>da[e])),va=Gn(la).map((e=>la[e])),Sa=[...pa,"custom"].join("|"),wa=[...ga,"custom"].join("|"),ba="(pr[0-9]+)",Ca="(il[0-9]+pi[0-9]+)",Ia=new RegExp(`^${ba}(${Sa})$`),qa=new RegExp(`^(${Ca}(${wa}))|(il[0-9]+nm)$`),ka=new RegExp(`^(${ha.join("|")})$`),xa=new RegExp(`^(${ya.join("|")})$`),Aa=new RegExp(`^${ba}custom$`),Ra=new RegExp(`^${Ca}custom$`),Oa=new RegExp(`^(${["loyaltyCardId","loyaltyTier","thirdPartyPersona","companyName","favoriteStore","storeName","userIndustry","userRole","userDepartment","businessUnit",...ma,...va].join("|")})$`),Fa=[e=>qa.test(e),e=>Ia.test(e),e=>ka.test(e),e=>xa.test(e),e=>Oa.test(e)],Ea=[Aa,Ra],Ta=Object.assign(Object.assign(Object.assign(Object.assign({},{anonymizeIp:"aip"}),{eventCategory:"ec",eventAction:"ea",eventLabel:"el",eventValue:"ev",page:"dp",visitorId:"cid",clientId:"cid",userId:"uid",currencyCode:"cu"}),{hitType:"t",pageViewId:"pid",encoding:"de",location:"dl",referrer:"dr",screenColor:"sd",screenResolution:"sr",title:"dt",userAgent:"ua",language:"ul",eventId:"z",time:"tm"}),["contentId","contentIdKey","contentType","searchHub","tab","searchUid","permanentId","contentLocale","trackingId"].reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:t})),{})),Da=Object.assign(Object.assign({},Ta),{svcAction:"svc_action",svcActionData:"svc_action_data"}),Ma=Gn(Da).map((e=>Da[e])),Pa=e=>-1!==Ma.indexOf(e),ja=e=>"custom"===e,Va=e=>{let t;return[...Ea].every((r=>{var n;return t=null===(n=r.exec(e))||void 0===n?void 0:n[1],!t})),t},_a=(e,t)=>Gn(t).reduce(((r,n)=>Object.assign(Object.assign({},r),{[`${e}${n}`]:t[n]})),{}),Ua=globalThis.fetch,Qa=class{constructor(e){this.opts=e}sendEvent(e,t){return yn(this,void 0,void 0,(function*(){let r,{baseUrl:n,visitorIdProvider:a,preprocessRequest:i}=this.opts,s=this.shouldAppendVisitorId(e)?yield this.getVisitorIdParam():"",o={url:`${n}/analytics/${e}${s}`,credentials:"include",mode:"cors",headers:this.getHeaders(),method:"POST",body:JSON.stringify(t)},c=Object.assign(Object.assign({},o),i?yield i(o,"analyticsFetch"):{}),{url:u}=c,l=hn(c,["url"]);try{r=yield Ua(u,l)}catch(e){return void console.error("An error has occured when sending the event.",e)}if(r.ok){let e=yield r.json();return e.visitorId&&a.setCurrentVisitorId(e.visitorId),e}try{r.json()}catch{}throw console.error(`An error has occured when sending the "${e}" event.`,r,t),new Error(`An error has occurred when sending the "${e}" event. Check the console logs for more details.`)}))}deleteHttpCookieVisitorId(){return yn(this,void 0,void 0,(function*(){let{baseUrl:e}=this.opts,t=`${e}/analytics/visit`;yield Ua(t,{headers:this.getHeaders(),method:"DELETE"})}))}shouldAppendVisitorId(e){return-1!==[ln.click,ln.custom,ln.search,ln.view].indexOf(e)}getVisitorIdParam(){return yn(this,void 0,void 0,(function*(){let{visitorIdProvider:e}=this.opts,t=yield e.getCurrentVisitorId();return t?`?visitor=${t}`:""}))}getHeaders(){let{token:e}=this.opts;return Object.assign(Object.assign({},e?{Authorization:`Bearer ${e}`}:{}),{"Content-Type":"application/json"})}},$a=class{constructor(){this.storage=new On,this.client=new class{sendEvent(e,t){return yn(this,void 0,void 0,(function*(){return Promise.resolve()}))}deleteHttpCookieVisitorId(){return yn(this,void 0,void 0,(function*(){return Promise.resolve()}))}}}getClientDependingOnEventType(e){return this.client}};var La=["1",1,"yes",!0];function Na(){let e=[];return mn()&&e.push(window.doNotTrack),vn()&&e.push(navigator.doNotTrack,navigator.msDoNotTrack,navigator.globalPrivacyControl),e.some((e=>-1!==La.indexOf(e)))}var Ba="https://analytics.cloud.coveo.com/rest/ua";var za,Ha,Ya=class{get defaultOptions(){return{endpoint:Ba,isCustomEndpoint:!1,token:"",version:"v15",beforeSendHooks:[],afterSendHooks:[]}}get version(){return Yn}constructor(e){if(this.acceptedLinkReferrers=[],!e)throw new Error("You have to pass options to this constructor");this.options=Object.assign(Object.assign({},this.defaultOptions),e),this.visitorId="",this.bufferedRequests=[],this.beforeSendHooks=[Dn,In].concat(this.options.beforeSendHooks),this.afterSendHooks=this.options.afterSendHooks,this.eventTypeMapping={};let t={baseUrl:this.baseUrl,token:this.options.token,visitorIdProvider:this,preprocessRequest:this.options.preprocessRequest};Na()?this.runtime=new $a:this.runtime=this.options.runtimeEnvironment||this.initRuntime(t),this.addEventTypeMapping(ln.view,{newEventType:ln.view,addClientIdParameter:!0}),this.addEventTypeMapping(ln.click,{newEventType:ln.click,addClientIdParameter:!0}),this.addEventTypeMapping(ln.custom,{newEventType:ln.custom,addClientIdParameter:!0}),this.addEventTypeMapping(ln.search,{newEventType:ln.search,addClientIdParameter:!0})}initRuntime(e){return mn()&&Sn()?new class{constructor(e,t){wn()&&bn()?this.storage=new class{constructor(){this.cookieStorage=new An}getItem(e){return localStorage.getItem(e)||this.cookieStorage.getItem(e)}removeItem(e){this.cookieStorage.removeItem(e),localStorage.removeItem(e)}setItem(e,t){localStorage.setItem(e,t),this.cookieStorage.setItem(e,t,31556926e3)}}:wn()?this.storage=localStorage:(console.warn("BrowserRuntime detected no valid storage available.",this),this.storage=new On),this.client=new Qa(e),this.beaconClient=new class{constructor(e){this.opts=e}sendEvent(e,t){return yn(this,void 0,void 0,(function*(){if(!this.isAvailable())throw new Error('navigator.sendBeacon is not supported in this browser. Consider adding a polyfill like "sendbeacon-polyfill".');let{baseUrl:r,preprocessRequest:n}=this.opts,a=yield this.getQueryParamsForEventType(e),{url:i,payload:s}=yield this.preProcessRequestAsPotentialJSONString(`${r}/analytics/${e}?${a}`,t,n),o=this.encodeForEventType(e,s),c=new Blob([o],{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(i,c)}))}isAvailable(){return"sendBeacon"in navigator}deleteHttpCookieVisitorId(){return Promise.resolve()}preProcessRequestAsPotentialJSONString(e,t,r){return yn(this,void 0,void 0,(function*(){let n=e,a=t;if(r){let i=yield r({url:e,body:JSON.stringify(t)},"analyticsBeacon"),{url:s,body:o}=i;n=s||e;try{a=JSON.parse(o)}catch(e){console.error("Unable to process the request body as a JSON string",e)}}return{payload:a,url:n}}))}encodeForEventType(e,t){return this.isEventTypeLegacy(e)?this.encodeEventToJson(e,t):this.encodeEventToJson(e,t,this.opts.token)}getQueryParamsForEventType(e){return yn(this,void 0,void 0,(function*(){let{token:t,visitorIdProvider:r}=this.opts,n=yield r.getCurrentVisitorId();return[t&&this.isEventTypeLegacy(e)?`access_token=${t}`:"",n?`visitorId=${n}`:"","discardVisitInfo=true"].filter((e=>!!e)).join("&")}))}isEventTypeLegacy(e){return-1!==[ln.click,ln.custom,ln.search,ln.view].indexOf(e)}encodeEventToJson(e,t,r){let n=`${e}Event=${encodeURIComponent(JSON.stringify(t))}`;return r&&(n=`access_token=${encodeURIComponent(r)}&${n}`),n}}(e),window.addEventListener("beforeunload",(()=>{let e=t();for(let{eventType:t,payload:r}of e)this.beaconClient.sendEvent(t,r)}))}getClientDependingOnEventType(e){return"click"===e&&this.beaconClient.isAvailable()?this.beaconClient:this.client}}(e,(()=>{let e=[...this.bufferedRequests];return this.bufferedRequests=[],e})):(typeof navigator<"u"&&"ReactNative"==navigator.product&&console.warn("\n        We've detected you're using React Native but have not provided the corresponding runtime, \n        for an optimal experience please use the \"coveo.analytics/react-native\" subpackage.\n        Follow the Readme on how to set it up: https://github.com/coveo/coveo.analytics.js#using-react-native\n    "),new class{constructor(e,t){this.storage=t||new On,this.client=new Qa(e)}getClientDependingOnEventType(e){return this.client}}(e))}get storage(){return this.runtime.storage}determineVisitorId(){return yn(this,void 0,void 0,(function*(){try{return mn()&&this.extractClientIdFromLink(window.location.href)||(yield this.storage.getItem("visitorId"))||Ln()}catch(e){return console.log("Could not get visitor ID from the current runtime environment storage. Using a random ID instead.",e),Ln()}}))}getCurrentVisitorId(){return yn(this,void 0,void 0,(function*(){if(!this.visitorId){let e=yield this.determineVisitorId();yield this.setCurrentVisitorId(e)}return this.visitorId}))}setCurrentVisitorId(e){return yn(this,void 0,void 0,(function*(){this.visitorId=e,yield this.storage.setItem("visitorId",e)}))}setClientId(e,t){return yn(this,void 0,void 0,(function*(){if(_n(e))this.setCurrentVisitorId(e.toLowerCase());else{if(!t)throw Error("Cannot generate uuid client id without a specific namespace string.");this.setCurrentVisitorId(Hn(e,Hn(t,"38824e1f-37f5-42d3-8372-a4b8fa9df946")))}}))}getParameters(e,...t){return yn(this,void 0,void 0,(function*(){return yield this.resolveParameters(e,...t)}))}getPayload(e,...t){return yn(this,void 0,void 0,(function*(){let r=yield this.resolveParameters(e,...t);return yield this.resolvePayloadForParameters(e,r)}))}get currentVisitorId(){return"string"!=typeof(this.visitorId||this.storage.getItem("visitorId"))&&this.setCurrentVisitorId(Ln()),this.visitorId}set currentVisitorId(e){this.visitorId=e,this.storage.setItem("visitorId",e)}extractClientIdFromLink(e){if(Na())return null;try{let t=new URL(e).searchParams.get(Wn.cvo_cid);if(null==t)return null;let r=Wn.fromString(t);return r&&Sn()&&r.validate(document.referrer,this.acceptedLinkReferrers)?r.clientId:null}catch{}return null}resolveParameters(e,...t){return yn(this,void 0,void 0,(function*(){let{variableLengthArgumentsNames:r=[],addVisitorIdParameter:n=!1,usesMeasurementProtocol:a=!1,addClientIdParameter:i=!1}=this.eventTypeMapping[e]||{};return yield[e=>r.length>0?this.parseVariableArgumentsPayload(r,e):e[0],e=>yn(this,void 0,void 0,(function*(){return Object.assign(Object.assign({},e),{visitorId:n?yield this.getCurrentVisitorId():""})})),e=>yn(this,void 0,void 0,(function*(){return i?Object.assign(Object.assign({},e),{clientId:yield this.getCurrentVisitorId()}):e})),e=>a?this.ensureAnonymousUserWhenUsingApiKey(e):e,t=>this.beforeSendHooks.reduce(((t,r)=>yn(this,void 0,void 0,(function*(){let n=yield t;return yield r(e,n)}))),t)].reduce(((e,t)=>yn(this,void 0,void 0,(function*(){let r=yield e;return yield t(r)}))),Promise.resolve(t))}))}resolvePayloadForParameters(e,t){return yn(this,void 0,void 0,(function*(){let{usesMeasurementProtocol:r=!1}=this.eventTypeMapping[e]||{};return yield[e=>this.setTrackingIdIfTrackingIdNotPresent(e),t=>this.removeEmptyPayloadValues(t,e),t=>this.validateParams(t,e),e=>r?(e=>{let t=!!e.action&&fa[e.action]||{};return Gn(e).reduce(((r,n)=>{let a=t[n]||Da[n]||n;return Object.assign(Object.assign({},r),{[a]:e[n]})}),{})})(e):e,e=>r?this.removeUnknownParameters(e):e,e=>r?this.processCustomParameters(e):this.mapCustomParametersToCustomData(e)].reduce(((e,t)=>yn(this,void 0,void 0,(function*(){let r=yield e;return yield t(r)}))),Promise.resolve(t))}))}makeEvent(e,...t){return yn(this,void 0,void 0,(function*(){let{newEventType:r=e}=this.eventTypeMapping[e]||{},n=yield this.resolveParameters(e,...t),a=yield this.resolvePayloadForParameters(e,n);return{eventType:r,payload:a,log:t=>yn(this,void 0,void 0,(function*(){return this.bufferedRequests.push({eventType:r,payload:Object.assign(Object.assign({},a),t)}),yield Promise.all(this.afterSendHooks.map((r=>r(e,Object.assign(Object.assign({},n),t))))),yield this.deferExecution(),yield this.sendFromBuffer()}))}}))}sendEvent(e,...t){return yn(this,void 0,void 0,(function*(){return(yield this.makeEvent(e,...t)).log({})}))}deferExecution(){return new Promise((e=>setTimeout(e,0)))}sendFromBuffer(){return yn(this,void 0,void 0,(function*(){let e=this.bufferedRequests.shift();if(e){let{eventType:t,payload:r}=e;return this.runtime.getClientDependingOnEventType(t).sendEvent(t,r)}}))}clear(){this.storage.removeItem("visitorId"),(new En).clear()}deleteHttpOnlyVisitorId(){this.runtime.client.deleteHttpCookieVisitorId()}makeSearchEvent(e){return yn(this,void 0,void 0,(function*(){return this.makeEvent(ln.search,e)}))}sendSearchEvent(e){var{searchQueryUid:t}=e,r=hn(e,["searchQueryUid"]);return yn(this,void 0,void 0,(function*(){return(yield this.makeSearchEvent(r)).log({searchQueryUid:t})}))}makeClickEvent(e){return yn(this,void 0,void 0,(function*(){return this.makeEvent(ln.click,e)}))}sendClickEvent(e){var{searchQueryUid:t}=e,r=hn(e,["searchQueryUid"]);return yn(this,void 0,void 0,(function*(){return(yield this.makeClickEvent(r)).log({searchQueryUid:t})}))}makeCustomEvent(e){return yn(this,void 0,void 0,(function*(){return this.makeEvent(ln.custom,e)}))}sendCustomEvent(e){var{lastSearchQueryUid:t}=e,r=hn(e,["lastSearchQueryUid"]);return yn(this,void 0,void 0,(function*(){return(yield this.makeCustomEvent(r)).log({lastSearchQueryUid:t})}))}makeViewEvent(e){return yn(this,void 0,void 0,(function*(){return this.makeEvent(ln.view,e)}))}sendViewEvent(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeViewEvent(e)).log({})}))}getVisit(){return yn(this,void 0,void 0,(function*(){let e=yield(yield fetch(`${this.baseUrl}/analytics/visit`)).json();return this.visitorId=e.visitorId,e}))}getHealth(){return yn(this,void 0,void 0,(function*(){return yield(yield fetch(`${this.baseUrl}/analytics/monitoring/health`)).json()}))}registerBeforeSendEventHook(e){this.beforeSendHooks.push(e)}registerAfterSendEventHook(e){this.afterSendHooks.push(e)}addEventTypeMapping(e,t){this.eventTypeMapping[e]=t}setAcceptedLinkReferrers(e){if(!Array.isArray(e)||!e.every((e=>"string"==typeof e)))throw Error("Parameter should be an array of domain strings");this.acceptedLinkReferrers=e}parseVariableArgumentsPayload(e,t){let r={};for(let n=0,a=t.length;n<a;n++){let a=t[n];if("string"==typeof a)r[e[n]]=a;else if("object"==typeof a)return Object.assign(Object.assign({},r),a)}return r}isKeyAllowedEmpty(e,t){return-1!==({[ln.search]:["queryText"]}[e]||[]).indexOf(t)}removeEmptyPayloadValues(e,t){return Object.keys(e).filter((r=>this.isKeyAllowedEmpty(t,r)||(e=>typeof e<"u"&&null!==e&&""!==e)(e[r]))).reduce(((t,r)=>Object.assign(Object.assign({},t),{[r]:e[r]})),{})}removeUnknownParameters(e){return Object.keys(e).filter((e=>{if((e=>[...Fa,...ia,Pa,ja].some((t=>t(e))))(e))return!0;console.log(e,"is not processed by coveoua")})).reduce(((t,r)=>Object.assign(Object.assign({},t),{[r]:e[r]})),{})}processCustomParameters(e){let{custom:t}=e,r=hn(e,["custom"]),n={};t&&Kn(t)&&(n=this.lowercaseKeys(t));let a=(e=>Gn(e).reduce(((t,r)=>{let n=Va(r);return n?Object.assign(Object.assign({},t),_a(n,e[r])):Object.assign(Object.assign({},t),{[r]:e[r]})}),{}))(r);return Object.assign(Object.assign({},n),a)}mapCustomParametersToCustomData(e){let{custom:t}=e,r=hn(e,["custom"]);if(t&&Kn(t)){let n=this.lowercaseKeys(t);return Object.assign(Object.assign({},r),{customData:Object.assign(Object.assign({},n),e.customData)})}return e}lowercaseKeys(e){let t=Object.keys(e),r={};return t.forEach((t=>{r[t.toLowerCase()]=e[t]})),r}validateParams(e,t){let{anonymizeIp:r}=e,n=hn(e,["anonymizeIp"]);return void 0!==r&&-1==["0","false","undefined","null","{}","[]",""].indexOf(`${r}`.toLowerCase())&&(n.anonymizeIp=1),(t==ln.view||t==ln.click||t==ln.search||t==ln.custom)&&(n.originLevel3=this.limit(n.originLevel3,1024)),t==ln.view&&(n.location=this.limit(n.location,1024)),("pageview"==t||"event"==t)&&(n.referrer=this.limit(n.referrer,2048),n.location=this.limit(n.location,2048),n.page=this.limit(n.page,2048)),n}ensureAnonymousUserWhenUsingApiKey(e){let{userId:t}=e,r=hn(e,["userId"]);return(e=>e?.startsWith("xx")||!1)(this.options.token)&&!t?(r.userId="anonymous",r):e}setTrackingIdIfTrackingIdNotPresent(e){let{trackingId:t}=e,r=hn(e,["trackingId"]);return t?e:(r.hasOwnProperty("custom")&&Kn(r.custom)&&(r.custom.hasOwnProperty("context_website")||r.custom.hasOwnProperty("siteName"))&&(r.trackingId=r.custom.context_website||r.custom.siteName),r.hasOwnProperty("customData")&&Kn(r.customData)&&(r.customData.hasOwnProperty("context_website")||r.customData.hasOwnProperty("siteName"))&&(r.trackingId=r.customData.context_website||r.customData.siteName),r)}limit(e,t){return"string"==typeof e?function(e,t){if(t<0||e.length<=t)return e;let r=e.indexOf("%",t-2);for(r<0||r>t?r=t:t=r;r>2&&"%"==e.charAt(r-3);){let n=Number.parseInt(e.substring(r-2,r),16);if(128!=(128&n))break;if(r-=3,128!=(n&Jn)){t-r>=3*ea(n)&&(r=t);break}}return e.substring(0,r)}(e,t):e}get baseUrl(){return function(e=Ba,t="v15",r=!1){if(e=e.replace(/\/$/,""),r)return`${e}/${t}`;let n=e.endsWith("/rest")||e.endsWith("/rest/ua");return`${e}${n?"":"/rest"}/${t}`}(this.options.endpoint,this.options.version,this.options.isCustomEndpoint)}};!function(e){e.contextChanged="contextChanged",e.expandToFullUI="expandToFullUI",e.openUserActions="openUserActions",e.showPrecedingSessions="showPrecedingSessions",e.showFollowingSessions="showFollowingSessions",e.clickViewedDocument="clickViewedDocument",e.clickPageView="clickPageView",e.createArticle="createArticle"}(za||(za={})),function(e){e.interfaceLoad="interfaceLoad",e.interfaceChange="interfaceChange",e.didyoumeanAutomatic="didyoumeanAutomatic",e.didyoumeanClick="didyoumeanClick",e.resultsSort="resultsSort",e.searchboxSubmit="searchboxSubmit",e.searchboxClear="searchboxClear",e.searchboxAsYouType="searchboxAsYouType",e.breadcrumbFacet="breadcrumbFacet",e.breadcrumbResetAll="breadcrumbResetAll",e.documentQuickview="documentQuickview",e.documentOpen="documentOpen",e.omniboxAnalytics="omniboxAnalytics",e.omniboxFromLink="omniboxFromLink",e.searchFromLink="searchFromLink",e.triggerNotify="notify",e.triggerExecute="execute",e.triggerQuery="query",e.undoTriggerQuery="undoQuery",e.triggerRedirect="redirect",e.pagerResize="pagerResize",e.pagerNumber="pagerNumber",e.pagerNext="pagerNext",e.pagerPrevious="pagerPrevious",e.pagerScrolling="pagerScrolling",e.staticFilterClearAll="staticFilterClearAll",e.staticFilterSelect="staticFilterSelect",e.staticFilterDeselect="staticFilterDeselect",e.facetClearAll="facetClearAll",e.facetSearch="facetSearch",e.facetSelect="facetSelect",e.facetSelectAll="facetSelectAll",e.facetDeselect="facetDeselect",e.facetExclude="facetExclude",e.facetUnexclude="facetUnexclude",e.facetUpdateSort="facetUpdateSort",e.facetShowMore="showMoreFacetResults",e.facetShowLess="showLessFacetResults",e.queryError="query",e.queryErrorBack="errorBack",e.queryErrorClear="errorClearQuery",e.queryErrorRetry="errorRetry",e.recommendation="recommendation",e.recommendationInterfaceLoad="recommendationInterfaceLoad",e.recommendationOpen="recommendationOpen",e.likeSmartSnippet="likeSmartSnippet",e.dislikeSmartSnippet="dislikeSmartSnippet",e.expandSmartSnippet="expandSmartSnippet",e.collapseSmartSnippet="collapseSmartSnippet",e.openSmartSnippetFeedbackModal="openSmartSnippetFeedbackModal",e.closeSmartSnippetFeedbackModal="closeSmartSnippetFeedbackModal",e.sendSmartSnippetReason="sendSmartSnippetReason",e.expandSmartSnippetSuggestion="expandSmartSnippetSuggestion",e.collapseSmartSnippetSuggestion="collapseSmartSnippetSuggestion",e.showMoreSmartSnippetSuggestion="showMoreSmartSnippetSuggestion",e.showLessSmartSnippetSuggestion="showLessSmartSnippetSuggestion",e.openSmartSnippetSource="openSmartSnippetSource",e.openSmartSnippetSuggestionSource="openSmartSnippetSuggestionSource",e.openSmartSnippetInlineLink="openSmartSnippetInlineLink",e.openSmartSnippetSuggestionInlineLink="openSmartSnippetSuggestionInlineLink",e.recentQueryClick="recentQueriesClick",e.clearRecentQueries="clearRecentQueries",e.recentResultClick="recentResultClick",e.clearRecentResults="clearRecentResults",e.noResultsBack="noResultsBack",e.showMoreFoldedResults="showMoreFoldedResults",e.showLessFoldedResults="showLessFoldedResults",e.copyToClipboard="copyToClipboard",e.caseSendEmail="Case.SendEmail",e.feedItemTextPost="FeedItem.TextPost",e.caseAttach="caseAttach",e.caseDetach="caseDetach",e.retryGeneratedAnswer="retryGeneratedAnswer",e.likeGeneratedAnswer="likeGeneratedAnswer",e.dislikeGeneratedAnswer="dislikeGeneratedAnswer",e.openGeneratedAnswerSource="openGeneratedAnswerSource",e.generatedAnswerStreamEnd="generatedAnswerStreamEnd",e.generatedAnswerSourceHover="generatedAnswerSourceHover",e.generatedAnswerCopyToClipboard="generatedAnswerCopyToClipboard",e.generatedAnswerHideAnswers="generatedAnswerHideAnswers",e.generatedAnswerShowAnswers="generatedAnswerShowAnswers",e.generatedAnswerExpand="generatedAnswerExpand",e.generatedAnswerCollapse="generatedAnswerCollapse",e.generatedAnswerFeedbackSubmit="generatedAnswerFeedbackSubmit",e.rephraseGeneratedAnswer="rephraseGeneratedAnswer",e.generatedAnswerFeedbackSubmitV2="generatedAnswerFeedbackSubmitV2",e.generatedAnswerCitationClick="generatedAnswerCitationClick"}(Ha||(Ha={}));var Wa={[Ha.triggerNotify]:"queryPipelineTriggers",[Ha.triggerExecute]:"queryPipelineTriggers",[Ha.triggerQuery]:"queryPipelineTriggers",[Ha.triggerRedirect]:"queryPipelineTriggers",[Ha.queryError]:"errors",[Ha.queryErrorBack]:"errors",[Ha.queryErrorClear]:"errors",[Ha.queryErrorRetry]:"errors",[Ha.pagerNext]:"getMoreResults",[Ha.pagerPrevious]:"getMoreResults",[Ha.pagerNumber]:"getMoreResults",[Ha.pagerResize]:"getMoreResults",[Ha.pagerScrolling]:"getMoreResults",[Ha.facetSearch]:"facet",[Ha.facetShowLess]:"facet",[Ha.facetShowMore]:"facet",[Ha.recommendation]:"recommendation",[Ha.likeSmartSnippet]:"smartSnippet",[Ha.dislikeSmartSnippet]:"smartSnippet",[Ha.expandSmartSnippet]:"smartSnippet",[Ha.collapseSmartSnippet]:"smartSnippet",[Ha.openSmartSnippetFeedbackModal]:"smartSnippet",[Ha.closeSmartSnippetFeedbackModal]:"smartSnippet",[Ha.sendSmartSnippetReason]:"smartSnippet",[Ha.expandSmartSnippetSuggestion]:"smartSnippetSuggestions",[Ha.collapseSmartSnippetSuggestion]:"smartSnippetSuggestions",[Ha.showMoreSmartSnippetSuggestion]:"smartSnippetSuggestions",[Ha.showLessSmartSnippetSuggestion]:"smartSnippetSuggestions",[Ha.clearRecentQueries]:"recentQueries",[Ha.recentResultClick]:"recentlyClickedDocuments",[Ha.clearRecentResults]:"recentlyClickedDocuments",[Ha.showLessFoldedResults]:"folding",[Ha.caseDetach]:"case",[Ha.likeGeneratedAnswer]:"generatedAnswer",[Ha.dislikeGeneratedAnswer]:"generatedAnswer",[Ha.openGeneratedAnswerSource]:"generatedAnswer",[Ha.generatedAnswerStreamEnd]:"generatedAnswer",[Ha.generatedAnswerSourceHover]:"generatedAnswer",[Ha.generatedAnswerCopyToClipboard]:"generatedAnswer",[Ha.generatedAnswerHideAnswers]:"generatedAnswer",[Ha.generatedAnswerShowAnswers]:"generatedAnswer",[Ha.generatedAnswerExpand]:"generatedAnswer",[Ha.generatedAnswerCollapse]:"generatedAnswer",[Ha.generatedAnswerFeedbackSubmit]:"generatedAnswer",[Ha.generatedAnswerFeedbackSubmitV2]:"generatedAnswer",[za.expandToFullUI]:"interface",[za.openUserActions]:"User Actions",[za.showPrecedingSessions]:"User Actions",[za.showFollowingSessions]:"User Actions",[za.clickViewedDocument]:"User Actions",[za.clickPageView]:"User Actions",[za.createArticle]:"createArticle"},Ga=class{constructor(){this.runtime=new $a,this.currentVisitorId=""}getPayload(){return Promise.resolve()}getParameters(){return Promise.resolve()}makeEvent(e){return Promise.resolve({eventType:e,payload:null,log:()=>Promise.resolve()})}sendEvent(){return Promise.resolve()}makeSearchEvent(){return this.makeEvent(ln.search)}sendSearchEvent(){return Promise.resolve()}makeClickEvent(){return this.makeEvent(ln.click)}sendClickEvent(){return Promise.resolve()}makeCustomEvent(){return this.makeEvent(ln.custom)}sendCustomEvent(){return Promise.resolve()}makeViewEvent(){return this.makeEvent(ln.view)}sendViewEvent(){return Promise.resolve()}getVisit(){return Promise.resolve({id:"",visitorId:""})}getHealth(){return Promise.resolve({status:""})}registerBeforeSendEventHook(){}registerAfterSendEventHook(){}addEventTypeMapping(){}get version(){return Yn}};function Ka(e){let t=e.join(";");return t.length<=256?t:Ka(e.slice(1))}var Ja=e=>{let t=function(e){return e.map((e=>e.replace(/;/g,"")))}(e),r=function(e){let t="";return e.filter((e=>{let r=e!==t;return t=e,r}))}(t);return Ka(r)};function Za(e){let t="string"==typeof e.partialQueries?e.partialQueries:Ja(e.partialQueries),r="string"==typeof e.suggestions?e.suggestions:Ja(e.suggestions);return Object.assign(Object.assign({},e),{partialQueries:t,suggestions:r})}var Xa,ei,ti,ri=Object.assign({},{pageview:"pageview",event:"event"});Object.keys(ri).map((e=>ri[e])),function(e){e.click="click",e.flowStart="flowStart"}(Xa||(Xa={})),function(e){e.enterInterface="ticket_create_start",e.fieldUpdate="ticket_field_update",e.fieldSuggestionClick="ticket_classification_click",e.suggestionClick="suggestion_click",e.suggestionRate="suggestion_rate",e.nextCaseStep="ticket_next_stage",e.caseCancelled="ticket_cancel",e.caseSolved="ticket_cancel",e.caseCreated="ticket_create"}(ei||(ei={})),function(e){e.quit="Quit",e.solved="Solved"}(ti||(ti={}));var ni=()=>"default",ai=e=>new Ya(e).getCurrentVisitorId(),ii=new Tn.HistoryStore,si=(e,t)=>"function"==typeof t?(...r)=>{let n=K(r[0]);try{return t.apply(t,r)}catch(t){return e.error(t,"Error in analytics preprocessRequest. Returning original request."),n}}:void 0,oi=(e,t)=>(...r)=>{let n=K(r[1]);try{return t.apply(t,r)}catch(t){return e.error(t,"Error in analytics hook. Returning original request."),n}};var ci=(e,t)=>e.search?.response.facets.find((e=>e.facetId===t)),ui=(e,t)=>e.facetSet[t]?.request,li=(e,t)=>{let r=ci(e,t);return function(e,t){return!!t&&t.facetId in e.facetSet}(e,r)?r:void 0},di=(e,t)=>li(e,t)?.values.filter((e=>"selected"===e.state))||[],fi=(e,t)=>li(e,t)?.values.filter((e=>"idle"!==e.state))||[],pi=e=>e.search.isLoading;function gi(e){let{activeValue:t,ancestryMap:r}=function(e){let t=[...e],r=new Map;for(;t.length>0;){let e=t.shift();if("selected"===e.state)return{activeValue:e,ancestryMap:r};if(r)for(let t of e.children)r.set(t,e);t.unshift(...e.children)}return{}}(e);return t?function(e,t){let r=[];if(!e)return[];let n=e;do{r.unshift(n),n=t.get(n)}while(n);return r}(t,r):[]}var hi=(e,t)=>{let r=ci(e,t);if(function(e,t){return!!t&&t.facetId in e.categoryFacetSet}(e,r))return r},yi=(e,t)=>e.categoryFacetSet[t]?.request,mi=(e,t)=>{let r=yi(e,t);return gi(r?.currentValues??[])};var vi=(e,t)=>{let r=Pi(t,e),n=r?r.field:"";return{facetId:e,facetField:n,facetTitle:Mi(n,e)}};function Si(e,t){let{facetId:r,facetValue:n}=e;return{...vi(r,t),facetValue:"hierarchical"===ji(t,r)?Fi(t,r):n}}function wi(e){return{facetSet:e.facetSet??{},categoryFacetSet:e.categoryFacetSet??{},dateFacetSet:e.dateFacetSet??{},numericFacetSet:e.numericFacetSet??{},automaticFacetSet:e.automaticFacetSet??{desiredCount:5,numberOfValues:8,set:{}}}}var bi,Ci,Ii=e=>"specific"===e.type,qi=e=>"hierarchical"===e.type,ki=e=>[...Object.values(e.facetSet),...Object.values(e.categoryFacetSet),...Object.values(e.dateFacetSet),...Object.values(e.numericFacetSet)].map((e=>e.request)),xi=e=>[...Object.values(e.automaticFacetSet.set)].map((e=>e.response)),Ai=(e,t,r)=>({state:e.state,valuePosition:t,facetType:r}),Ri=e=>({displayValue:`${e.start}..${e.end}`,value:`${e.start}..${e.end}`,start:e.start,end:e.end,endInclusive:e.endInclusive}),Oi=e=>({displayValue:e.value,value:e.value}),Fi=(e,t)=>mi(e,t).map((e=>e.value)).join(";"),Ei=(e,t)=>{let r=Fi(e,t);return{value:r,valuePosition:1,displayValue:r}},Ti=(e,t)=>({title:Mi(e.field,e.field),field:e.field,id:e.field,facetPosition:t}),Di=(e,t)=>({title:Mi(e.field,e.facetId),field:e.field,id:e.facetId,facetPosition:t}),Mi=(e,t)=>`${e}_${t}`,Pi=(e,t)=>e.facetSet[t]?.request||e.categoryFacetSet[t]?.request||e.dateFacetSet[t]?.request||e.numericFacetSet[t]?.request||e.automaticFacetSet.set[t]?.response,ji=(e,t)=>{let r=Pi(e,t);return r?r.type:"specific"},Vi=()=>({q:"",enableQuerySyntax:!1}),_i=class{constructor(e){this.getState=e,k(this,"state"),this.state=e()}getLanguage(){return(e=>{let t=e.configuration.search.locale.split("-")[0];return t&&2===t.length?t:"en"})(this.state)}getBaseMetadata(){let{context:e,configuration:t}=this.state,r=e?.contextValues||{},n={};for(let[e,t]of Object.entries(r)){n[`context_${e}`]=t}return"legacy"===t.analytics.analyticsMode&&(n.coveoHeadlessVersion=fn),n}getOriginContext(){return this.state.configuration.analytics.originContext}getOriginLevel1(){return this.state.searchHub||ni()}getOriginLevel2(){return this.state.configuration.analytics.originLevel2}getOriginLevel3(){return this.state.configuration.analytics.originLevel3}getIsAnonymous(){return this.state.configuration.analytics.anonymous}},Ui=((Ci=Ui||{}).Ascending="ascending",Ci.Descending="descending",Ci),Qi=((bi=Qi||{}).Relevancy="relevancy",bi.QRE="qre",bi.Date="date",bi.Field="field",bi.NoSort="nosort",bi),$i=e=>{if(u(e))return e.map((e=>$i(e))).join(",");switch(e.by){case"relevancy":case"qre":case"nosort":return e.by;case"date":return`date ${e.order}`;case"field":return`@${e.field} ${e.order}`;default:return""}},Li=()=>({by:"relevancy"}),Ni=e=>({by:"date",order:e}),Bi=(e,t)=>({by:"field",order:t,field:e}),zi=()=>({by:"qre"}),Hi=()=>({by:"nosort"}),Yi=new r({values:{by:new n({enum:Qi,required:!0}),order:new n({enum:Ui}),field:new e}});function Wi(){return $i(Li())}var Gi=class e extends _i{constructor(){super(...arguments),k(this,"getFacetRequest",(e=>this.state.facetSet?.[e]?.request||this.state.categoryFacetSet?.[e]?.request||this.state.dateFacetSet?.[e]?.request||this.state.numericFacetSet?.[e]?.request||this.state.automaticFacetSet?.set[e]?.response))}getFacetState(){return(e=>{let t=[];return ki(e).forEach(((r,n)=>{let a=ji(e,r.facetId),i=Di(r,n+1);if(qi(r)){if(!mi(e,r.facetId).length)return;t.push({...i,...Ei(e,r.facetId),facetType:a,state:"selected"})}else r.currentValues.forEach(((e,n)=>{if("idle"===e.state)return;let s=Ai(e,n+1,a),o=Ii(r)?Oi(e):Ri(e);t.push({...i,...s,...o})}))})),xi(e).forEach(((e,r)=>{let n=Ti(e,r+1);e.values.forEach(((e,r)=>{if("idle"===e.state)return;let a=Ai(e,r+1,"specific"),i=Oi(e);t.push({...n,...a,...i})}))})),t})(wi(this.getState()))}getPipeline(){return this.state.pipeline||this.state.search?.response.pipeline||e.fallbackPipelineName}getSearchEventRequestPayload(){return{queryText:this.queryText,responseTime:this.responseTime,results:this.resultURIs,numberOfResults:this.numberOfResults}}getSearchUID(){let e=this.getState();return e.search?.searchResponseId||e.search?.response.searchUid||""}getSplitTestRunName(){return this.state.search?.response.splitTestRun}getSplitTestRunVersion(){let t=!!this.getSplitTestRunName(),r=this.state.search?.response.pipeline||this.state.pipeline||e.fallbackPipelineName;return t?r:void 0}getBaseMetadata(){let e=this.getState(),t=super.getBaseMetadata(),r=e.search?.response?.extendedResults?.generativeQuestionAnsweringId;return r&&(t.generativeQuestionAnsweringId=r),t}getFacetMetadata(e,t){let r=this.getFacetRequest(e)?.field??"";return{...this.getBaseMetadata(),facetId:e,facetField:r,facetValue:t,facetTitle:`${r}_${e}`}}getFacetClearAllMetadata(e){let t=this.getFacetRequest(e)?.field??"";return{...this.getBaseMetadata(),facetId:e,facetField:t,facetTitle:`${t}_${e}`}}getFacetUpdateSortMetadata(e,t){let r=this.getFacetRequest(e)?.field??"";return{...this.getBaseMetadata(),facetId:e,facetField:r,criteria:t,facetTitle:`${r}_${e}`}}getRangeBreadcrumbFacetMetadata(e,t){let r=this.getFacetRequest(e)?.field??"";return{...this.getBaseMetadata(),facetId:e,facetField:r,facetRangeEnd:t.end,facetRangeEndInclusive:t.endInclusive,facetRangeStart:t.start,facetTitle:`${r}_${e}`}}getResultSortMetadata(){return{...this.getBaseMetadata(),resultsSortBy:this.state.sortCriteria??Wi()}}getStaticFilterToggleMetadata(e,t){return{...this.getBaseMetadata(),staticFilterId:e,staticFilterValue:t}}getStaticFilterClearAllMetadata(e){return{...this.getBaseMetadata(),staticFilterId:e}}getUndoTriggerQueryMetadata(e){return{...this.getBaseMetadata(),undoneQuery:e}}getCategoryBreadcrumbFacetMetadata(e,t){let r=this.getFacetRequest(e)?.field??"";return{...this.getBaseMetadata(),categoryFacetId:e,categoryFacetField:r,categoryFacetPath:t,categoryFacetTitle:`${r}_${e}`}}getOmniboxAnalyticsMetadata(e,t){let r=this.state.querySuggest&&this.state.querySuggest[e],n=r.completions.map((e=>e.expression)),a=r.partialQueries.length-1,i=r.partialQueries[a]||"",s=r.responseId;return{...this.getBaseMetadata(),suggestionRanking:n.indexOf(t),partialQuery:i,partialQueries:r.partialQueries.length>0?r.partialQueries:"",suggestions:n.length>0?n:"",querySuggestResponseId:s}}getInterfaceChangeMetadata(){return{...this.getBaseMetadata(),interfaceChangeTo:this.state.configuration.analytics.originLevel2}}getOmniboxFromLinkMetadata(e){return{...this.getBaseMetadata(),...e}}getGeneratedAnswerMetadata(){let e=this.getState(),t={};return void 0!==e.generatedAnswer?.isVisible&&(t.showGeneratedAnswer=e.generatedAnswer.isVisible),t}get resultURIs(){return this.results?.map((e=>({documentUri:e.uri,documentUriHash:e.raw.urihash})))}get results(){return this.state.search?.response.results}get queryText(){return this.state.query?.q||Vi().q}get responseTime(){return this.state.search?.duration||0}get numberOfResults(){return this.state.search?.response.totalCountFiltered||0}};k(Gi,"fallbackPipelineName","default");var Ki=Gi,Ji=()=>{let e=ii.getHistory().reverse().find((e=>"PageView"===e.name&&e.value));return e?e.value:""};function Zi(e){let t=Xi(e),r=[e,...t].filter((e=>e.parentResult)).map((e=>e.parentResult));return function(e,t){return[...e.reduce(((e,r)=>{let n=t(r);return e.has(n)||e.set(n,r),e}),new Map).values()]}([e,...t,...r],(e=>e.uniqueId))}function Xi(e){return e.childResults?e.childResults.flatMap((e=>[e,...Xi(e)])):[]}var es=()=>"";function ts(e,t){let r=t=>function(e){return Object.assign(e,{instantlyCallable:!0})}(Ur(e,t)),n=r((async(e,{getState:r,extra:n})=>{let{analyticsClientMiddleware:a,preprocessRequest:i,logger:s}=n;return await(await t({getState:r,analyticsClientMiddleware:a,preprocessRequest:i,logger:s})).log({state:r(),extra:n})}));return Object.assign(n,{prepare:async({getState:e,analyticsClientMiddleware:n,preprocessRequest:a,logger:i})=>{let{description:s,log:o}=await t({getState:e,analyticsClientMiddleware:n,preprocessRequest:a,logger:i});return{description:s,action:r((async(e,{getState:t,extra:r})=>await o({state:t(),extra:r})))}}}),n}var rs=({prefix:e,__legacy__getBuilder:t,__legacy__provider:r,analyticsPayloadBuilder:n,analyticsType:a,analyticsConfigurator:i,providerClass:s})=>(r??(r=e=>new s(e)),ts(e,(async({getState:e,analyticsClientMiddleware:s,preprocessRequest:o,logger:c})=>{let u=[],l={log:async({state:e})=>{for(let t of u)await t(e)}},d=e(),f=i({getState:e,logger:c,analyticsClientMiddleware:s,preprocessRequest:o,provider:r(e)}),p=await t(f,e());l.description=p?.description,u.push((async e=>{(e=>"legacy"===e.configuration.analytics.analyticsMode)(e)&&await async function(e,t,r,n,a){t((()=>r));let i=await(e?.log({searchUID:t((()=>r)).getSearchUID()}));n.info({client:a,response:i},"Analytics response")}(p,r,e,c,f.coveoAnalyticsClient)}));let{emit:g}=gn(d);return u.push((async e=>{if((e=>"next"===e.configuration.analytics.analyticsMode)(e)&&a&&n){let t=n(e);await async function(e,t,r){await e(t,r)}(g,a,t)}})),l})));var ns=((e,t,r)=>function(...n){let a=1===n.length?{...n[0],__legacy__getBuilder:t(n[0].__legacy__getBuilder),analyticsConfigurator:e,providerClass:r}:{prefix:n[0],__legacy__getBuilder:t(n[1]),__legacy__provider:n[2],analyticsConfigurator:e,providerClass:r};return rs(a)})((({logger:e,getState:t,analyticsClientMiddleware:r=((e,t)=>t),preprocessRequest:n,provider:a=new Ki(t)})=>{let i=t(),s=i.configuration.accessToken,o=i.configuration.analytics.apiBaseUrl??ye(i.configuration.organizationId,i.configuration.environment,"analytics"),c=i.configuration.analytics.runtimeEnvironment,u=i.configuration.analytics.enabled,l=new class{constructor(e,t){this.opts=e,this.provider=t;let r=!1===e.enableAnalytics||Na();this.coveoAnalyticsClient=r?new Ga:new Ya(e)}disable(){this.coveoAnalyticsClient=new Ga}enable(){this.coveoAnalyticsClient=new Ya(this.opts)}makeInterfaceLoad(){return this.makeSearchEvent(Ha.interfaceLoad)}logInterfaceLoad(){return yn(this,void 0,void 0,(function*(){return(yield this.makeInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})}))}makeRecommendationInterfaceLoad(){return this.makeSearchEvent(Ha.recommendationInterfaceLoad)}logRecommendationInterfaceLoad(){return yn(this,void 0,void 0,(function*(){return(yield this.makeRecommendationInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})}))}makeRecommendation(){return this.makeCustomEvent(Ha.recommendation)}logRecommendation(){return yn(this,void 0,void 0,(function*(){return(yield this.makeRecommendation()).log({searchUID:this.provider.getSearchUID()})}))}makeRecommendationOpen(e,t){return this.makeClickEvent(Ha.recommendationOpen,e,t)}logRecommendationOpen(e,t){return yn(this,void 0,void 0,(function*(){return(yield this.makeRecommendationOpen(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeStaticFilterClearAll(e){return this.makeSearchEvent(Ha.staticFilterClearAll,e)}logStaticFilterClearAll(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeStaticFilterClearAll(e)).log({searchUID:this.provider.getSearchUID()})}))}makeStaticFilterSelect(e){return this.makeSearchEvent(Ha.staticFilterSelect,e)}logStaticFilterSelect(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeStaticFilterSelect(e)).log({searchUID:this.provider.getSearchUID()})}))}makeStaticFilterDeselect(e){return this.makeSearchEvent(Ha.staticFilterDeselect,e)}logStaticFilterDeselect(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeStaticFilterDeselect(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFetchMoreResults(){return this.makeCustomEvent(Ha.pagerScrolling,{type:"getMoreResults"})}logFetchMoreResults(){return yn(this,void 0,void 0,(function*(){return(yield this.makeFetchMoreResults()).log({searchUID:this.provider.getSearchUID()})}))}makeInterfaceChange(e){return this.makeSearchEvent(Ha.interfaceChange,e)}logInterfaceChange(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeInterfaceChange(e)).log({searchUID:this.provider.getSearchUID()})}))}makeDidYouMeanAutomatic(){return this.makeSearchEvent(Ha.didyoumeanAutomatic)}logDidYouMeanAutomatic(){return yn(this,void 0,void 0,(function*(){return(yield this.makeDidYouMeanAutomatic()).log({searchUID:this.provider.getSearchUID()})}))}makeDidYouMeanClick(){return this.makeSearchEvent(Ha.didyoumeanClick)}logDidYouMeanClick(){return yn(this,void 0,void 0,(function*(){return(yield this.makeDidYouMeanClick()).log({searchUID:this.provider.getSearchUID()})}))}makeResultsSort(e){return this.makeSearchEvent(Ha.resultsSort,e)}logResultsSort(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeResultsSort(e)).log({searchUID:this.provider.getSearchUID()})}))}makeSearchboxSubmit(){return this.makeSearchEvent(Ha.searchboxSubmit)}logSearchboxSubmit(){return yn(this,void 0,void 0,(function*(){return(yield this.makeSearchboxSubmit()).log({searchUID:this.provider.getSearchUID()})}))}makeSearchboxClear(){return this.makeSearchEvent(Ha.searchboxClear)}logSearchboxClear(){return yn(this,void 0,void 0,(function*(){return(yield this.makeSearchboxClear()).log({searchUID:this.provider.getSearchUID()})}))}makeSearchboxAsYouType(){return this.makeSearchEvent(Ha.searchboxAsYouType)}logSearchboxAsYouType(){return yn(this,void 0,void 0,(function*(){return(yield this.makeSearchboxAsYouType()).log({searchUID:this.provider.getSearchUID()})}))}makeBreadcrumbFacet(e){return this.makeSearchEvent(Ha.breadcrumbFacet,e)}logBreadcrumbFacet(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeBreadcrumbFacet(e)).log({searchUID:this.provider.getSearchUID()})}))}makeBreadcrumbResetAll(){return this.makeSearchEvent(Ha.breadcrumbResetAll)}logBreadcrumbResetAll(){return yn(this,void 0,void 0,(function*(){return(yield this.makeBreadcrumbResetAll()).log({searchUID:this.provider.getSearchUID()})}))}makeDocumentQuickview(e,t){return this.makeClickEvent(Ha.documentQuickview,e,t)}logDocumentQuickview(e,t){return yn(this,void 0,void 0,(function*(){return(yield this.makeDocumentQuickview(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeDocumentOpen(e,t){return this.makeClickEvent(Ha.documentOpen,e,t)}logDocumentOpen(e,t){return yn(this,void 0,void 0,(function*(){return(yield this.makeDocumentOpen(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeOmniboxAnalytics(e){return this.makeSearchEvent(Ha.omniboxAnalytics,Za(e))}logOmniboxAnalytics(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeOmniboxAnalytics(e)).log({searchUID:this.provider.getSearchUID()})}))}makeOmniboxFromLink(e){return this.makeSearchEvent(Ha.omniboxFromLink,Za(e))}logOmniboxFromLink(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeOmniboxFromLink(e)).log({searchUID:this.provider.getSearchUID()})}))}makeSearchFromLink(){return this.makeSearchEvent(Ha.searchFromLink)}logSearchFromLink(){return yn(this,void 0,void 0,(function*(){return(yield this.makeSearchFromLink()).log({searchUID:this.provider.getSearchUID()})}))}makeTriggerNotify(e){return this.makeCustomEvent(Ha.triggerNotify,e)}logTriggerNotify(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeTriggerNotify(e)).log({searchUID:this.provider.getSearchUID()})}))}makeTriggerExecute(e){return this.makeCustomEvent(Ha.triggerExecute,e)}logTriggerExecute(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeTriggerExecute(e)).log({searchUID:this.provider.getSearchUID()})}))}makeTriggerQuery(){return this.makeCustomEvent(Ha.triggerQuery,{query:this.provider.getSearchEventRequestPayload().queryText},"queryPipelineTriggers")}logTriggerQuery(){return yn(this,void 0,void 0,(function*(){return(yield this.makeTriggerQuery()).log({searchUID:this.provider.getSearchUID()})}))}makeUndoTriggerQuery(e){return this.makeSearchEvent(Ha.undoTriggerQuery,e)}logUndoTriggerQuery(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeUndoTriggerQuery(e)).log({searchUID:this.provider.getSearchUID()})}))}makeTriggerRedirect(e){return this.makeCustomEvent(Ha.triggerRedirect,Object.assign(Object.assign({},e),{query:this.provider.getSearchEventRequestPayload().queryText}))}logTriggerRedirect(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeTriggerRedirect(e)).log({searchUID:this.provider.getSearchUID()})}))}makePagerResize(e){return this.makeCustomEvent(Ha.pagerResize,e)}logPagerResize(e){return yn(this,void 0,void 0,(function*(){return(yield this.makePagerResize(e)).log({searchUID:this.provider.getSearchUID()})}))}makePagerNumber(e){return this.makeCustomEvent(Ha.pagerNumber,e)}logPagerNumber(e){return yn(this,void 0,void 0,(function*(){return(yield this.makePagerNumber(e)).log({searchUID:this.provider.getSearchUID()})}))}makePagerNext(e){return this.makeCustomEvent(Ha.pagerNext,e)}logPagerNext(e){return yn(this,void 0,void 0,(function*(){return(yield this.makePagerNext(e)).log({searchUID:this.provider.getSearchUID()})}))}makePagerPrevious(e){return this.makeCustomEvent(Ha.pagerPrevious,e)}logPagerPrevious(e){return yn(this,void 0,void 0,(function*(){return(yield this.makePagerPrevious(e)).log({searchUID:this.provider.getSearchUID()})}))}makePagerScrolling(){return this.makeCustomEvent(Ha.pagerScrolling)}logPagerScrolling(){return yn(this,void 0,void 0,(function*(){return(yield this.makePagerScrolling()).log({searchUID:this.provider.getSearchUID()})}))}makeFacetClearAll(e){return this.makeSearchEvent(Ha.facetClearAll,e)}logFacetClearAll(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeFacetClearAll(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetSearch(e){return this.makeSearchEvent(Ha.facetSearch,e)}logFacetSearch(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeFacetSearch(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetSelect(e){return this.makeSearchEvent(Ha.facetSelect,e)}logFacetSelect(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeFacetSelect(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetDeselect(e){return this.makeSearchEvent(Ha.facetDeselect,e)}logFacetDeselect(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeFacetDeselect(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetExclude(e){return this.makeSearchEvent(Ha.facetExclude,e)}logFacetExclude(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeFacetExclude(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetUnexclude(e){return this.makeSearchEvent(Ha.facetUnexclude,e)}logFacetUnexclude(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeFacetUnexclude(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetSelectAll(e){return this.makeSearchEvent(Ha.facetSelectAll,e)}logFacetSelectAll(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeFacetSelectAll(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetUpdateSort(e){return this.makeSearchEvent(Ha.facetUpdateSort,e)}logFacetUpdateSort(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeFacetUpdateSort(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetShowMore(e){return this.makeCustomEvent(Ha.facetShowMore,e)}logFacetShowMore(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeFacetShowMore(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetShowLess(e){return this.makeCustomEvent(Ha.facetShowLess,e)}logFacetShowLess(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeFacetShowLess(e)).log({searchUID:this.provider.getSearchUID()})}))}makeQueryError(e){return this.makeCustomEvent(Ha.queryError,e)}logQueryError(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeQueryError(e)).log({searchUID:this.provider.getSearchUID()})}))}makeQueryErrorBack(){return yn(this,void 0,void 0,(function*(){let e=yield this.makeCustomEvent(Ha.queryErrorBack);return{description:e.description,log:()=>yn(this,void 0,void 0,(function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(Ha.queryErrorBack)}))}}))}logQueryErrorBack(){return yn(this,void 0,void 0,(function*(){return(yield this.makeQueryErrorBack()).log({searchUID:this.provider.getSearchUID()})}))}makeQueryErrorRetry(){return yn(this,void 0,void 0,(function*(){let e=yield this.makeCustomEvent(Ha.queryErrorRetry);return{description:e.description,log:()=>yn(this,void 0,void 0,(function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(Ha.queryErrorRetry)}))}}))}logQueryErrorRetry(){return yn(this,void 0,void 0,(function*(){return(yield this.makeQueryErrorRetry()).log({searchUID:this.provider.getSearchUID()})}))}makeQueryErrorClear(){return yn(this,void 0,void 0,(function*(){let e=yield this.makeCustomEvent(Ha.queryErrorClear);return{description:e.description,log:()=>yn(this,void 0,void 0,(function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(Ha.queryErrorClear)}))}}))}logQueryErrorClear(){return yn(this,void 0,void 0,(function*(){return(yield this.makeQueryErrorClear()).log({searchUID:this.provider.getSearchUID()})}))}makeLikeSmartSnippet(){return this.makeCustomEvent(Ha.likeSmartSnippet)}logLikeSmartSnippet(){return yn(this,void 0,void 0,(function*(){return(yield this.makeLikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})}))}makeDislikeSmartSnippet(){return this.makeCustomEvent(Ha.dislikeSmartSnippet)}logDislikeSmartSnippet(){return yn(this,void 0,void 0,(function*(){return(yield this.makeDislikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})}))}makeExpandSmartSnippet(){return this.makeCustomEvent(Ha.expandSmartSnippet)}logExpandSmartSnippet(){return yn(this,void 0,void 0,(function*(){return(yield this.makeExpandSmartSnippet()).log({searchUID:this.provider.getSearchUID()})}))}makeCollapseSmartSnippet(){return this.makeCustomEvent(Ha.collapseSmartSnippet)}logCollapseSmartSnippet(){return yn(this,void 0,void 0,(function*(){return(yield this.makeCollapseSmartSnippet()).log({searchUID:this.provider.getSearchUID()})}))}makeOpenSmartSnippetFeedbackModal(){return this.makeCustomEvent(Ha.openSmartSnippetFeedbackModal)}logOpenSmartSnippetFeedbackModal(){return yn(this,void 0,void 0,(function*(){return(yield this.makeOpenSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})}))}makeCloseSmartSnippetFeedbackModal(){return this.makeCustomEvent(Ha.closeSmartSnippetFeedbackModal)}logCloseSmartSnippetFeedbackModal(){return yn(this,void 0,void 0,(function*(){return(yield this.makeCloseSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})}))}makeSmartSnippetFeedbackReason(e,t){return this.makeCustomEvent(Ha.sendSmartSnippetReason,{reason:e,details:t})}logSmartSnippetFeedbackReason(e,t){return yn(this,void 0,void 0,(function*(){return(yield this.makeSmartSnippetFeedbackReason(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeExpandSmartSnippetSuggestion(e){return this.makeCustomEvent(Ha.expandSmartSnippetSuggestion,"documentId"in e?e:{documentId:e})}logExpandSmartSnippetSuggestion(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeExpandSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})}))}makeCollapseSmartSnippetSuggestion(e){return this.makeCustomEvent(Ha.collapseSmartSnippetSuggestion,"documentId"in e?e:{documentId:e})}logCollapseSmartSnippetSuggestion(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeCollapseSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})}))}makeShowMoreSmartSnippetSuggestion(e){return this.makeCustomEvent(Ha.showMoreSmartSnippetSuggestion,e)}logShowMoreSmartSnippetSuggestion(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeShowMoreSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})}))}makeShowLessSmartSnippetSuggestion(e){return this.makeCustomEvent(Ha.showLessSmartSnippetSuggestion,e)}logShowLessSmartSnippetSuggestion(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeShowLessSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})}))}makeOpenSmartSnippetSource(e,t){return this.makeClickEvent(Ha.openSmartSnippetSource,e,t)}logOpenSmartSnippetSource(e,t){return yn(this,void 0,void 0,(function*(){return(yield this.makeOpenSmartSnippetSource(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeOpenSmartSnippetSuggestionSource(e,t){return this.makeClickEvent(Ha.openSmartSnippetSuggestionSource,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},t)}makeCopyToClipboard(e,t){return this.makeClickEvent(Ha.copyToClipboard,e,t)}logCopyToClipboard(e,t){return yn(this,void 0,void 0,(function*(){return(yield this.makeCopyToClipboard(e,t)).log({searchUID:this.provider.getSearchUID()})}))}logOpenSmartSnippetSuggestionSource(e,t){return yn(this,void 0,void 0,(function*(){return(yield this.makeOpenSmartSnippetSuggestionSource(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeOpenSmartSnippetInlineLink(e,t){return this.makeClickEvent(Ha.openSmartSnippetInlineLink,e,{contentIDKey:t.contentIDKey,contentIDValue:t.contentIDValue},t)}logOpenSmartSnippetInlineLink(e,t){return yn(this,void 0,void 0,(function*(){return(yield this.makeOpenSmartSnippetInlineLink(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeOpenSmartSnippetSuggestionInlineLink(e,t){return this.makeClickEvent(Ha.openSmartSnippetSuggestionInlineLink,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},t)}logOpenSmartSnippetSuggestionInlineLink(e,t){return yn(this,void 0,void 0,(function*(){return(yield this.makeOpenSmartSnippetSuggestionInlineLink(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeRecentQueryClick(){return this.makeSearchEvent(Ha.recentQueryClick)}logRecentQueryClick(){return yn(this,void 0,void 0,(function*(){return(yield this.makeRecentQueryClick()).log({searchUID:this.provider.getSearchUID()})}))}makeClearRecentQueries(){return this.makeCustomEvent(Ha.clearRecentQueries)}logClearRecentQueries(){return yn(this,void 0,void 0,(function*(){return(yield this.makeClearRecentQueries()).log({searchUID:this.provider.getSearchUID()})}))}makeRecentResultClick(e,t){return this.makeCustomEvent(Ha.recentResultClick,{info:e,identifier:t})}logRecentResultClick(e,t){return yn(this,void 0,void 0,(function*(){return(yield this.makeRecentResultClick(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeClearRecentResults(){return this.makeCustomEvent(Ha.clearRecentResults)}logClearRecentResults(){return yn(this,void 0,void 0,(function*(){return(yield this.makeClearRecentResults()).log({searchUID:this.provider.getSearchUID()})}))}makeNoResultsBack(){return this.makeSearchEvent(Ha.noResultsBack)}logNoResultsBack(){return yn(this,void 0,void 0,(function*(){return(yield this.makeNoResultsBack()).log({searchUID:this.provider.getSearchUID()})}))}makeShowMoreFoldedResults(e,t){return this.makeClickEvent(Ha.showMoreFoldedResults,e,t)}logShowMoreFoldedResults(e,t){return yn(this,void 0,void 0,(function*(){return(yield this.makeShowMoreFoldedResults(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeShowLessFoldedResults(){return this.makeCustomEvent(Ha.showLessFoldedResults)}logShowLessFoldedResults(){return yn(this,void 0,void 0,(function*(){return(yield this.makeShowLessFoldedResults()).log({searchUID:this.provider.getSearchUID()})}))}makeEventDescription(e,t){var r;return{actionCause:t,customData:null===(r=e.payload)||void 0===r?void 0:r.customData}}makeCustomEvent(e,t,r=Wa[e]){return yn(this,void 0,void 0,(function*(){this.coveoAnalyticsClient.getParameters;let n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),t),a=Object.assign(Object.assign({},yield this.getBaseEventRequest(n)),{eventType:r,eventValue:e}),i=yield this.coveoAnalyticsClient.makeCustomEvent(a);return{description:this.makeEventDescription(i,e),log:({searchUID:e})=>i.log({lastSearchQueryUid:e})}}))}logCustomEvent(e,t,r=Wa[e]){return yn(this,void 0,void 0,(function*(){return(yield this.makeCustomEvent(e,t,r)).log({searchUID:this.provider.getSearchUID()})}))}makeCustomEventWithType(e,t,r){return yn(this,void 0,void 0,(function*(){let n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),r),a=Object.assign(Object.assign({},yield this.getBaseEventRequest(n)),{eventType:t,eventValue:e}),i=yield this.coveoAnalyticsClient.makeCustomEvent(a);return{description:this.makeEventDescription(i,e),log:({searchUID:e})=>i.log({lastSearchQueryUid:e})}}))}logCustomEventWithType(e,t,r){return yn(this,void 0,void 0,(function*(){return(yield this.makeCustomEventWithType(e,t,r)).log({searchUID:this.provider.getSearchUID()})}))}logSearchEvent(e,t){return yn(this,void 0,void 0,(function*(){return(yield this.makeSearchEvent(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeSearchEvent(e,t){return yn(this,void 0,void 0,(function*(){let r=yield this.getBaseSearchEventRequest(e,t),n=yield this.coveoAnalyticsClient.makeSearchEvent(r);return{description:this.makeEventDescription(n,e),log:({searchUID:e})=>n.log({searchQueryUid:e})}}))}makeClickEvent(e,t,r,n){return yn(this,void 0,void 0,(function*(){let a=Object.assign(Object.assign(Object.assign({},t),yield this.getBaseEventRequest(Object.assign(Object.assign({},r),n))),{queryPipeline:this.provider.getPipeline(),actionCause:e}),i=yield this.coveoAnalyticsClient.makeClickEvent(a);return{description:this.makeEventDescription(i,e),log:({searchUID:e})=>i.log({searchQueryUid:e})}}))}logClickEvent(e,t,r,n){return yn(this,void 0,void 0,(function*(){return(yield this.makeClickEvent(e,t,r,n)).log({searchUID:this.provider.getSearchUID()})}))}getBaseSearchEventRequest(e,t){var r,n;return yn(this,void 0,void 0,(function*(){return Object.assign(Object.assign(Object.assign({},yield this.getBaseEventRequest(Object.assign(Object.assign({},t),null===(n=(r=this.provider).getGeneratedAnswerMetadata)||void 0===n?void 0:n.call(r)))),this.provider.getSearchEventRequestPayload()),{queryPipeline:this.provider.getPipeline(),actionCause:e})}))}getBaseEventRequest(e){return yn(this,void 0,void 0,(function*(){let t=Object.assign(Object.assign({},this.provider.getBaseMetadata()),e);return Object.assign(Object.assign(Object.assign({},this.getOrigins()),this.getSplitTestRun()),{customData:t,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[],anonymous:this.provider.getIsAnonymous(),clientId:yield this.getClientId()})}))}getOrigins(){var e,t;return{originContext:null===(t=(e=this.provider).getOriginContext)||void 0===t?void 0:t.call(e),originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}getClientId(){return this.coveoAnalyticsClient instanceof Ya?this.coveoAnalyticsClient.getCurrentVisitorId():void 0}getSplitTestRun(){let e=this.provider.getSplitTestRunName?this.provider.getSplitTestRunName():"",t=this.provider.getSplitTestRunVersion?this.provider.getSplitTestRunVersion():"";return Object.assign(Object.assign({},e&&{splitTestRunName:e}),t&&{splitTestRunVersion:t})}makeLikeGeneratedAnswer(e){return this.makeCustomEvent(Ha.likeGeneratedAnswer,e)}logLikeGeneratedAnswer(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeLikeGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})}))}makeDislikeGeneratedAnswer(e){return this.makeCustomEvent(Ha.dislikeGeneratedAnswer,e)}logDislikeGeneratedAnswer(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeDislikeGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})}))}makeOpenGeneratedAnswerSource(e){return this.makeCustomEvent(Ha.openGeneratedAnswerSource,e)}logOpenGeneratedAnswerSource(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeOpenGeneratedAnswerSource(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerCitationClick(e,t){return this.makeClickEvent(Ha.generatedAnswerCitationClick,Object.assign(Object.assign({},e),{documentPosition:1}),{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},t)}logGeneratedAnswerCitationClick(e,t){return yn(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerCitationClick(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerSourceHover(e){return this.makeCustomEvent(Ha.generatedAnswerSourceHover,e)}logGeneratedAnswerSourceHover(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerSourceHover(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerCopyToClipboard(e){return this.makeCustomEvent(Ha.generatedAnswerCopyToClipboard,e)}logGeneratedAnswerCopyToClipboard(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerCopyToClipboard(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerHideAnswers(e){return this.makeCustomEvent(Ha.generatedAnswerHideAnswers,e)}logGeneratedAnswerHideAnswers(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerHideAnswers(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerShowAnswers(e){return this.makeCustomEvent(Ha.generatedAnswerShowAnswers,e)}logGeneratedAnswerShowAnswers(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerShowAnswers(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerExpand(e){return this.makeCustomEvent(Ha.generatedAnswerExpand,e)}logGeneratedAnswerExpand(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerExpand(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerCollapse(e){return this.makeCustomEvent(Ha.generatedAnswerCollapse,e)}logGeneratedAnswerCollapse(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerCollapse(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerFeedbackSubmit(e){return this.makeCustomEvent(Ha.generatedAnswerFeedbackSubmit,e)}logGeneratedAnswerFeedbackSubmit(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerFeedbackSubmit(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerFeedbackSubmitV2(e){return this.makeCustomEvent(Ha.generatedAnswerFeedbackSubmitV2,e)}logGeneratedAnswerFeedbackSubmitV2(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerFeedbackSubmitV2(e)).log({searchUID:this.provider.getSearchUID()})}))}makeRephraseGeneratedAnswer(e){return this.makeSearchEvent(Ha.rephraseGeneratedAnswer,e)}logRephraseGeneratedAnswer(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeRephraseGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})}))}makeRetryGeneratedAnswer(){return this.makeSearchEvent(Ha.retryGeneratedAnswer)}logRetryGeneratedAnswer(){return yn(this,void 0,void 0,(function*(){return(yield this.makeRetryGeneratedAnswer()).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerStreamEnd(e){return this.makeCustomEvent(Ha.generatedAnswerStreamEnd,e)}logGeneratedAnswerStreamEnd(e){return yn(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerStreamEnd(e)).log({searchUID:this.provider.getSearchUID()})}))}}({token:s,endpoint:o,runtimeEnvironment:c,preprocessRequest:si(e,n),beforeSendHooks:[oi(e,r),(t,r)=>(e.info({...r,type:t,endpoint:o,token:s},"Analytics request"),r)]},a);return u||l.disable(),l}),(e=>e),Ki),as=(e,t)=>{let r=-1,n=t.search?.results;return r=gs(e,n),r<0&&(r=function(e,t){for(let[r,n]of t.entries()){if(-1!==gs(e,Zi(n)))return r}return-1}(e,n)),r<0&&(r=0),function(e,t,r){let n=e.raw.collection;return{collectionName:"string"==typeof n?n:"default",documentAuthor:ds(e),documentPosition:t+1,documentTitle:e.title,documentUri:e.uri,documentUriHash:e.raw.urihash,documentUrl:e.clickUri,rankingModifier:e.rankingModifier||"",sourceName:fs(e),queryPipeline:r.pipeline||es()}}(e,(e=>e+(t.pagination?.firstResult??0))(r),t)};function is(e){let t=e.source;return c(t)?"unknown":t}var ss=e=>({contentIdKey:"permanentid",contentIdValue:e.permanentid||""});var os=e=>(e.raw.permanentid||console.warn("Missing field permanentid on result. This might cause many issues with your Coveo deployment. See https://docs.coveo.com/en/1913 and https://docs.coveo.com/en/1640 for more information.",e),{contentIDKey:"permanentid",contentIDValue:e.raw.permanentid||""}),cs={urihash:new e,sourcetype:new e,permanentid:new e},us={uniqueId:_e,raw:new r({values:cs}),title:_e,uri:_e,clickUri:_e,rankingModifier:new e({required:!1,emptyAllowed:!0})};function ls(e){return Object.assign({},...Object.keys(cs).map((t=>({[t]:e[t]}))))}function ds(e){let t=e.raw.author;return c(t)?"unknown":Array.isArray(t)?t.join(";"):`${t}`}function fs(e){let t=e.raw.source;return c(t)?"unknown":t}var ps=e=>new o(us).validate(function(e){return Object.assign({},...Object.keys(us).map((t=>({[t]:e[t]}))),{raw:ls(e.raw)})}(e));function gs(e,t=[]){return t.findIndex((({uniqueId:t})=>t===e.uniqueId))}var hs=e=>He(e,{evt:_e,type:Ue}),ys=e=>ns("analytics/generic/search",(t=>{hs(e);let{evt:r,meta:n}=e;return t.makeSearchEvent(r,n)})),ms=e=>ns("analytics/generic/click",((t,r)=>(ps(e.result),hs(e),t.makeClickEvent(e.evt,as(e.result,r),os(e.result),e.meta)))),vs=e=>ns("analytics/generic/custom",(t=>(hs(e),t.makeCustomEventWithType(e.evt,e.type,e.meta)))),Ss=()=>ns("analytics/interface/load",(e=>e.makeInterfaceLoad())),ws=()=>ns("analytics/interface/change",((e,t)=>e.makeInterfaceChange({interfaceChangeTo:t.configuration.analytics.originLevel2}))),bs=()=>ns("analytics/interface/searchFromLink",(e=>e.makeSearchFromLink())),Cs=e=>ns("analytics/interface/omniboxFromLink",(t=>t.makeOmniboxFromLink(e))),Is=()=>({actionCause:"interfaceChange"}),qs=()=>Ue,ks=()=>_e,xs=dr("configuration/updateBasicConfiguration",(t=>He(t,{accessToken:Ue,environment:new e({required:!1,constrainTo:["prod","hipaa","stg","dev"]}),organizationId:Ue}))),As=dr("configuration/updateSearchConfiguration",(r=>He(r,{proxyBaseUrl:new e({required:!1,url:!0}),pipeline:new e({required:!1,emptyAllowed:!0}),searchHub:Ue,timezone:Ue,locale:Ue,authenticationProviders:new t({required:!1,each:_e})}))),Rs={enabled:new a({default:!0}),originContext:qs(),originLevel2:qs(),originLevel3:qs(),proxyBaseUrl:new e({required:!1,url:!0}),runtimeEnvironment:new i,anonymous:new a({default:!1}),deviceId:Ue,userDisplayName:Ue,documentLocation:Ue,trackingId:Ue,analyticsMode:new e({constrainTo:["legacy","next"],required:!1,default:"next"}),source:new r({options:{required:!1},values:["@coveo/atomic","@coveo/quantic"].reduce(((e,t)=>(e[t]=Ne,e)),{})})},Os=dr("configuration/updateAnalyticsConfiguration",(e=>He(e,Rs))),Fs=dr("configuration/analytics/disable"),Es=dr("configuration/analytics/enable"),Ts=dr("configuration/analytics/originlevel2",(e=>He(e,{originLevel2:ks()}))),Ds=dr("configuration/analytics/originlevel3",(e=>He(e,{originLevel3:ks()}))),Ms={q:new e,enableQuerySyntax:new a,aq:new e,cq:new e,firstResult:new s({min:0}),numberOfResults:new s({min:0}),sortCriteria:new e,f:new r,fExcluded:new r,cf:new r,nf:new r,mnf:new r,df:new r,debug:new a,sf:new r,tab:new e,af:new r},Ps=dr("searchParameters/restore",(e=>He(e,Ms))),js=dr("debug/enable"),Vs=dr("debug/disable"),_s=()=>!1,Us=Ir(_s(),(e=>{e.addCase(js,(()=>!0)).addCase(Vs,(()=>!1)).addCase(Ps,((e,t)=>t.payload.debug??e))})),Qs=dr("history/undo"),$s=dr("history/redo"),Ls=dr("history/snapshot"),Ns=Ur("history/back",(async(e,{dispatch:t})=>{t(Qs()),await t(zs())})),Bs=Ur("history/forward",(async(e,{dispatch:t})=>{t($s()),await t(zs())})),zs=Ur("history/change",(async(e,{getState:t})=>t().history.present)),Hs=dr("pipeline/set",(t=>He(t,new e({required:!0,emptyAllowed:!0})))),Ys=Ir(es(),(e=>{e.addCase(Hs,((e,t)=>t.payload)).addCase(zs.fulfilled,((e,t)=>t.payload?.pipeline??e)).addCase(As,((e,t)=>t.payload.pipeline||e))})),Ws=dr("searchHub/set",(t=>He(t,new e({required:!0,emptyAllowed:!0})))),Gs=Ir(ni(),(e=>{e.addCase(Ws,((e,t)=>t.payload)).addCase(zs.fulfilled,((e,t)=>t.payload?.searchHub??e)).addCase(As,((e,t)=>t.payload.searchHub||e))})),Ks=dr("breadcrumb/deselectAll"),Js=dr("breadcrumb/deselectAllNonBreadcrumbs"),Zs=dr("facet/updateFacetAutoSelection",(e=>He(e,{allow:new a({required:!0})}))),Xs=class extends Ki{constructor(e){super(e),this.getState=e}get activeInstantResultQuery(){let e=this.getState().instantResults;for(let t in e)for(let r in e[t].cache)if(e[t].cache[r].isActive)return e[t].q;return null}get activeInstantResultCache(){let e=this.getState().instantResults;for(let t in e)for(let r in e[t].cache)if(e[t].cache[r].isActive)return e[t].cache[r];return null}get results(){return this.activeInstantResultCache?.results}get queryText(){return this.activeInstantResultQuery??Vi().q}get responseTime(){return this.activeInstantResultCache?.duration??0}get numberOfResults(){return this.activeInstantResultCache?.totalCountFiltered??0}getSearchUID(){return this.activeInstantResultCache?.searchUid||super.getSearchUID()}},eo={id:_e},to={...eo,q:Qe},ro=dr("instantResults/register",(e=>He(e,eo))),no=dr("instantResults/updateQuery",(e=>He(e,to))),ao=dr("instantResults/clearExpired",(e=>He(e,eo))),io=new s({required:!0,min:0}),so=dr("pagination/registerNumberOfResults",(e=>He(e,io))),oo=dr("pagination/updateNumberOfResults",(e=>He(e,io))),co=dr("pagination/registerPage",(e=>He(e,io))),uo=dr("pagination/updatePage",(e=>He(e,io))),lo=dr("pagination/nextPage"),fo=dr("pagination/previousPage"),po=dr("query/updateQuery",(t=>He(t,{q:new e,enableQuerySyntax:new a}))),go=(e,t,r)=>({analytics:{clientId:t.clientId,clientTimestamp:(new Date).toISOString(),documentReferrer:t.referrer,documentLocation:t.location,originContext:e.originContext,...r&&{actionCause:r.actionCause},...r&&{customData:r.customData},...e.userDisplayName&&{userDisplayName:e.userDisplayName},...e.deviceId&&{deviceId:e.deviceId},...e.trackingId&&{trackingId:e.trackingId},capture:!0,source:pn(e)}}),ho=(e,t,r)=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl??me(e.configuration.organizationId,e.configuration.environment),locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:t.referrer,timezone:e.configuration.search.timezone,...e.advancedSearchQueries?.aq&&{aq:e.advancedSearchQueries.aq},...e.advancedSearchQueries?.cq&&{cq:e.advancedSearchQueries.cq},...e.advancedSearchQueries?.lq&&{lq:e.advancedSearchQueries.lq},...e.advancedSearchQueries?.dq&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&go(e.configuration.analytics,t,r),...e.excerptLength&&!c(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}}),yo=async(e,t)=>{let r="next"===e.analyticsMode;return{analytics:{clientId:await ai(e),clientTimestamp:(new Date).toISOString(),documentReferrer:e.originLevel3,originContext:e.originContext,...t&&{actionCause:t.actionCause,customData:t.customData},...t&&!r&&{customData:t.customData},...e.userDisplayName&&{userDisplayName:e.userDisplayName},...e.documentLocation&&{documentLocation:e.documentLocation},...e.deviceId&&{deviceId:e.deviceId},...Ji()&&{pageId:Ji()},...r&&e.trackingId&&{trackingId:e.trackingId},capture:r,...r&&{source:pn(e)}}}},mo=async(e,t)=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl??me(e.configuration.organizationId,e.configuration.environment),locale:e.configuration.search.locale,debug:e.debug,tab:e.configuration.analytics.originLevel2,referrer:e.configuration.analytics.originLevel3,timezone:e.configuration.search.timezone,...e.configuration.analytics.enabled&&{actionsHistory:ii.getHistory()},...e.advancedSearchQueries?.aq&&{aq:e.advancedSearchQueries.aq},...e.advancedSearchQueries?.cq&&{cq:e.advancedSearchQueries.cq},...e.advancedSearchQueries?.lq&&{lq:e.advancedSearchQueries.lq},...e.advancedSearchQueries?.dq&&{dq:e.advancedSearchQueries.dq},...e.context&&{context:e.context.contextValues},...e.fields&&!e.fields.fetchAllFields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.query&&{q:e.query.q,enableQuerySyntax:e.query.enableQuerySyntax},...e.searchHub&&{searchHub:e.searchHub},...e.sortCriteria&&{sortCriteria:e.sortCriteria},...e.configuration.analytics.enabled&&await yo(e.configuration.analytics,t),...e.excerptLength&&!c(e.excerptLength.length)&&{excerptLength:e.excerptLength.length},...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}}),vo=()=>({cq:"",cqWasSet:!1,aq:"",aqWasSet:!1,lq:"",lqWasSet:!1,dq:"",dqWasSet:!1,defaultFilters:{cq:"",aq:"",lq:"",dq:""}}),So=()=>ns("search/logFetchMoreResults",(e=>e.makeFetchMoreResults())),wo=e=>ns("search/queryError",((t,r)=>t.makeQueryError({query:r.query?.q||Vi().q,aq:r.advancedSearchQueries?.aq||vo().aq,cq:r.advancedSearchQueries?.cq||vo().cq,dq:r.advancedSearchQueries?.dq||vo().dq,errorType:e.type,errorMessage:e.message}))),bo=q(P(),1),Co=q(j(),1),Io=q(P(),1),qo=q(V(),1);Io.default.extend(qo.default);var ko="YYYY/MM/DD@HH:mm:ss",xo="1401-01-01";function Ao(e,t){let r=(0,Io.default)(e,t);return r.isValid()||t?r:(0,Io.default)(e,ko)}function Ro(e){return e.format(ko)}function Oo(e,t){let r=Ao(e,t);if(!r.isValid()){throw new Error(`Could not parse the provided date "${e}"${t?` with the format "${t}"`:". Please provide a date format string in the configuration options. See https://day.js.org/docs/en/parse/string-format for more information."}`)}Fo(r)}function Fo(e){if(e.isBefore(xo))throw new Error(`Date is before year 1401, which is unsupported by the API: ${e}`)}bo.default.extend(Co.default);var Eo=["past","now","next"],To=["minute","hour","day","week","month","quarter","year"],Do=t=>{let r="now"===t;return{amount:new s({required:!r,min:1}),unit:new e({required:!r,constrainTo:To}),period:new e({required:!0,constrainTo:Eo})}};function Mo(e){if("string"==typeof e&&!_o(e))throw new Error(`The value "${e}" is not respecting the relative date format "period-amount-unit"`);let t="string"==typeof e?Uo(e):e;new o(Do(t.period)).validate(t);let r=Po(t),n=JSON.stringify(t);if(!r.isValid())throw new Error(`Date is invalid: ${n}`);Fo(r)}function Po(e){let{period:t,amount:r,unit:n}=e;switch(t){case"past":return(0,bo.default)().subtract(r,n);case"next":return(0,bo.default)().add(r,n);case"now":return(0,bo.default)()}}function jo(e){return Ro(Po(Uo(e)))}function Vo(e){return e.toLocaleLowerCase().split("-")}function _o(e){let[t,r,n]=Vo(e);if("now"===t)return!0;if(!Eo.includes(t)||!To.includes(n))return!1;let a=parseInt(r);return!(isNaN(a)||a<=0)}function Uo(e){let[t,r,n]=Vo(e);return"now"===t?{period:"now"}:{period:t,amount:r?parseInt(r):void 0,unit:n||void 0}}function Qo(e){return Mo(e),Uo(e)}function $o(e){return`start${e}`}function Lo(e){return`end${e}`}function No(e,t){if(function(e){return"dateRange"===e.type}(e)){let{facetId:r,currentValues:n}=e;return t.dateFacetValueMap[r]={},{...e,currentValues:n.map((e=>function(e,t,r){let n=e.start,a=e.end;return _o(n)&&(n=jo(n),r.dateFacetValueMap[t][$o(n)]=e.start),_o(a)&&(a=jo(a),r.dateFacetValueMap[t][Lo(a)]=e.end),{...e,start:n,end:a}}(e,r,t)))}}return e}function Bo(e){let t={dateFacetValueMap:{}};return{request:{...e,facets:e.facets?.map((e=>No(e,t)))},mappings:t}}function zo(e,t){return function(e,t){return e.facetId in t.dateFacetValueMap}(e,t)?{...e,values:e.values.map((r=>function(e,t,r){return{...e,start:r.dateFacetValueMap[t][$o(e.start)]||e.start,end:r.dateFacetValueMap[t][Lo(e.end)]||e.end}}(r,e.facetId,t)))}:e}function Ho(e,t){return"success"in e?{success:{...e.success,facets:e.success.facets?.map((e=>zo(e,t)))}}:e}var Yo=dr("didYouMean/enable"),Wo=dr("didYouMean/disable"),Go=dr("didYouMean/automaticCorrections/disable"),Ko=dr("didYouMean/automaticCorrections/enable"),Jo=dr("didYouMean/correction",(e=>He(e,_e))),Zo=dr("didYouMean/automaticCorrections/mode",(t=>He(t,new e({constrainTo:["next","legacy"],emptyAllowed:!1,required:!0})))),Xo=()=>ns("analytics/didyoumean/click",(e=>e.makeDidYouMeanClick())),ec=()=>ns("analytics/didyoumean/automatic",(e=>e.makeDidYouMeanAutomatic()));function tc(e){return{context:e.context||{contextValues:{}},dictionaryFieldContext:e.dictionaryFieldContext||{contextValues:{}},facetSet:e.facetSet||{},numericFacetSet:e.numericFacetSet||{},dateFacetSet:e.dateFacetSet||{},categoryFacetSet:e.categoryFacetSet||{},automaticFacetSet:e.automaticFacetSet??{desiredCount:5,numberOfValues:8,set:{}},pagination:e.pagination||{firstResult:0,defaultNumberOfResults:10,numberOfResults:10,totalCountFiltered:0},query:e.query||Vi(),tabSet:e.tabSet||{},advancedSearchQueries:e.advancedSearchQueries||vo(),staticFilterSet:e.staticFilterSet||{},querySet:e.querySet||{},sortCriteria:e.sortCriteria||Wi(),pipeline:e.pipeline||es(),searchHub:e.searchHub||ni(),facetOptions:e.facetOptions||{freezeFacetOrder:!1,facets:{}},facetOrder:e.facetOrder??[],debug:e.debug??_s()}}var rc=new r({values:{undoneQuery:Qe},options:{required:!0}}),nc=()=>ns("analytics/trigger/query",((e,t)=>t.triggers?.queryModification.newQuery?e.makeTriggerQuery():null)),ac=e=>ns("analytics/trigger/query/undo",(t=>(He(e,rc),t.makeUndoTriggerQuery(e)))),ic=()=>ns("analytics/trigger/notify",((e,t)=>t.triggers?.notifications.length?e.makeTriggerNotify({notifications:t.triggers.notifications}):null)),sc=()=>ns("analytics/trigger/redirect",((e,t)=>t.triggers?.redirectTo?e.makeTriggerRedirect({redirectedTo:t.triggers.redirectTo}):null)),oc=()=>ns("analytics/trigger/execute",((e,t)=>t.triggers?.executions.length?e.makeTriggerExecute({executions:t.triggers.executions}):null)),cc=dr("trigger/query/ignore",(t=>He(t,new e({emptyAllowed:!0,required:!0})))),uc=dr("trigger/query/modification",(e=>He(e,new r({values:{originalQuery:Ue,modification:Ue}}))));function lc(e){return Object.values(e).map((e=>e.request))}function dc(e,t){let r={};e.forEach((e=>r[e.facetId]=e));let n=[];t.forEach((e=>{e in r&&(n.push(r[e]),delete r[e])}));let a=Object.values(r);return[...n,...a]}function fc(e){return lc(e).map((e=>{let t=e.currentValues.some((({state:e})=>"idle"!==e));return e.generateAutomaticRanges&&!t?{...e,currentValues:[]}:e}))}function pc(e){return lc(e).map((e=>"alphanumericDescending"===e.sortCriteria?{...e,sortCriteria:{type:"alphanumeric",order:"descending"}}:e))}function gc(e){return function(e){return[...pc(e.facetSet??{}),...fc(e.numericFacetSet??{}),...fc(e.dateFacetSet??{}),...lc(e.categoryFacetSet??{})]}(e).filter((({facetId:t})=>e.facetOptions?.facets[t]?.enabled??!0))}function hc(e){return dc(gc(e),e.facetOrder??[])}var yc=async(e,t)=>{let r=function(e){let t=e.advancedSearchQueries?.cq.trim()||"",r=Object.values(e.tabSet||{}).find((e=>e.isActive))?.expression.trim()||"",n=function(e){return Object.values(e.staticFilterSet||{}).map((e=>{let t=e.values.filter((e=>"selected"===e.state&&!!e.expression.trim())),r=t.map((e=>e.expression)).join(" OR ");return t.length>1?`(${r})`:r}))}(e);return[t,r,...n].filter((e=>!!e)).join(" AND ")}(e),n=hc(e),a=function(e){let t=e.automaticFacetSet?.set;return t?Object.values(t).map((e=>e.response)).map(mc).filter((e=>e.currentValues.length>0)):void 0}(e);return Bo({...await mo(e,t),...e.didYouMean&&{queryCorrection:{enabled:e.didYouMean.enableDidYouMean&&"next"===e.didYouMean.queryCorrectionMode,options:{automaticallyCorrect:e.didYouMean.automaticallyCorrectQuery?"whenNoResults":"never"}},enableDidYouMean:e.didYouMean.enableDidYouMean&&"legacy"===e.didYouMean.queryCorrectionMode},...r&&{cq:r},...n.length&&{facets:n},...e.pagination&&{numberOfResults:e.pagination?e.pagination.firstResult+e.pagination.numberOfResults>5e3?5e3-e.pagination.firstResult:e.pagination.numberOfResults:void 0,firstResult:e.pagination.firstResult},...e.facetOptions&&{facetOptions:{freezeFacetOrder:e.facetOptions.freezeFacetOrder}},...e.folding?.enabled&&{filterField:e.folding.fields.collection,childField:e.folding.fields.parent,parentField:e.folding.fields.child,filterFieldRange:e.folding.filterFieldRange},...e.automaticFacetSet&&{generateAutomaticFacets:{desiredCount:e.automaticFacetSet.desiredCount,numberOfValues:e.automaticFacetSet.numberOfValues,currentFacets:a}},...e.generatedAnswer&&{pipelineRuleParameters:{mlGenerativeQuestionAnswering:{responseFormat:e.generatedAnswer.responseFormat,citationsFieldToInclude:e.generatedAnswer.fieldsToIncludeInCitations}}}})};function mc(e){let{field:t,label:r,values:n}=e,a=n.filter((e=>"selected"===e.state));return{field:t,label:r,currentValues:a}}var vc=class{constructor(e,t=(e=>{this.dispatch(po({q:e}))})){this.config=e,this.onUpdateQueryForCorrection=t}async fetchFromAPI({mappings:e,request:t},r){let n=(new Date).getTime();return{response:Ho(await this.extra.apiClient.search(t,r),e),duration:(new Date).getTime()-n,queryExecuted:this.getState().query?.q||"",requestExecuted:t}}async process(e){return this.processQueryErrorOrContinue(e)??await this.processQueryCorrectionsOrContinue(e)??await this.processQueryTriggersOrContinue(e)??this.processSuccessResponse(e)}processQueryErrorOrContinue(e){return Pe(e.response)?(this.dispatch(wo(e.response.error)),this.rejectWithValue(e.response.error)):null}async processQueryCorrectionsOrContinue(e){let t=this.getState(),r=this.getSuccessResponse(e);if(!r||!t.didYouMean)return null;let{enableDidYouMean:n,automaticallyCorrectQuery:a}=t.didYouMean,{results:i,queryCorrections:s,queryCorrection:o}=r;if(!n||!a)return null;let u=0===i.length&&s&&0!==s.length,l=!c(o)&&!c(o.correctedQuery);if(!u&&!l)return null;let d=u?await this.processLegacyDidYouMeanAutoCorrection(e):this.processModernDidYouMeanAutoCorrection(e);return this.dispatch(Ls(tc(this.getState()))),d}async processLegacyDidYouMeanAutoCorrection(e){let t=this.getCurrentQuery(),r=this.getSuccessResponse(e);if(!r.queryCorrections)return null;let{correctedQuery:n}=r.queryCorrections[0],a=await this.automaticallyRetryQueryWithCorrection(n);return Pe(a.response)?(this.dispatch(wo(a.response.error)),this.rejectWithValue(a.response.error)):(this.logOriginalAnalyticsQueryBeforeAutoCorrection(e),this.dispatch(Ls(tc(this.getState()))),{...a,response:{...a.response.success,queryCorrections:r.queryCorrections},automaticallyCorrected:!0,originalQuery:t,analyticsAction:ec()})}processModernDidYouMeanAutoCorrection(e){let t=this.getSuccessResponse(e),{correctedQuery:r,originalQuery:n}=t.queryCorrection;return this.onUpdateQueryForCorrection(r),{...e,response:{...t},queryExecuted:r,automaticallyCorrected:!0,originalQuery:n,analyticsAction:ec()}}logOriginalAnalyticsQueryBeforeAutoCorrection(e){let t=this.getState(),r=this.getSuccessResponse(e);this.analyticsAction&&this.analyticsAction()(this.dispatch,(()=>this.getStateAfterResponse(e.queryExecuted,e.duration,t,r)),this.extra)}async processQueryTriggersOrContinue(e){let t=this.getSuccessResponse(e);if(!t)return null;let r=t.triggers.find((e=>"query"===e.type))?.content||"";if(!r)return null;if(this.getState().triggers?.queryModification.queryToIgnore===r)return this.dispatch(cc("")),null;this.analyticsAction&&await this.dispatch(this.analyticsAction);let n=this.getCurrentQuery(),a=await this.automaticallyRetryQueryWithTriggerModification(r);return Pe(a.response)?(this.dispatch(wo(a.response.error)),this.rejectWithValue(a.response.error)):(this.dispatch(Ls(tc(this.getState()))),{...a,response:{...a.response.success},automaticallyCorrected:!1,originalQuery:n,analyticsAction:nc()})}getStateAfterResponse(e,t,r,n){return{...r,query:{q:e,enableQuerySyntax:r.query?.enableQuerySyntax??Vi().enableQuerySyntax},search:{response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],generateAutomaticFacets:{facets:[]},queryCorrections:[],triggers:[],questionAnswer:{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0},pipeline:"",splitTestRun:"",termsToHighlight:{},phrasesToHighlight:{},extendedResults:{}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[],searchResponseId:"",requestId:"",questionAnswer:{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0},extendedResults:{},duration:t,response:n,results:n.results}}}processSuccessResponse(e){return this.dispatch(Ls(tc(this.getState()))),{...e,response:this.getSuccessResponse(e),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery(),analyticsAction:this.analyticsAction}}getSuccessResponse(e){return Me(e.response)?e.response.success:null}async automaticallyRetryQueryWithCorrection(e){this.onUpdateQueryForCorrection(e);let t=await this.fetchFromAPI(await yc(this.getState()),{origin:"mainSearch"});return this.dispatch(Jo(e)),t}async automaticallyRetryQueryWithTriggerModification(e){return this.dispatch(uc({newQuery:e,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(e),await this.fetchFromAPI(await yc(this.getState()),{origin:"mainSearch"})}getCurrentQuery(){let e=this.getState();return void 0!==e.query?.q?e.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get analyticsAction(){return this.config.analyticsAction}get rejectWithValue(){return this.config.rejectWithValue}};Ur("search/prepareForSearchWithQuery",((t,r)=>{let{dispatch:n}=r;He(t,{q:new e,enableQuerySyntax:new a,clearFilters:new a}),t.clearFilters&&(n(Ks()),n(Js())),n(Zs({allow:!0})),n(po({q:t.q,enableQuerySyntax:t.enableQuerySyntax})),n(uo(1))}));var Sc=Ur("search/executeSearch",(async(e,t)=>{let r=t.getState();return await Ec(r,t,e)})),wc=Ur("search/fetchPage",(async(e,t)=>{let r=t.getState();return await Oc(r,t,e)})),bc=Ur("search/fetchMoreResults",(async(e,t)=>{let r=t.getState();return await Fc(t,r)})),Cc=Ur("search/fetchFacetValues",(async(e,t)=>{let r=t.getState();return await async function(e,t,r){let{analyticsClientMiddleware:n,preprocessRequest:a,logger:i}=e.extra,{description:s}=await t.prepare({getState:()=>e.getState(),analyticsClientMiddleware:n,preprocessRequest:a,logger:i}),o=new vc({...e,analyticsAction:t}),c=await xc(r,s),u=await o.fetchFromAPI(c,{origin:"facetValues"});return await o.process(u)}(t,e,r)})),Ic=Ur("search/fetchInstantResults",(async(e,t)=>Rc(e,t))),qc=async(e,t)=>{let r=await yc(e,t);return r.request={...r.request,firstResult:(e.pagination?.firstResult??0)+(e.search?.results.length??0)},r},kc=async(e,t,r)=>Bo({...await mo(e),...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:r,q:t}),xc=async(e,t)=>{let r=await yc(e,t);return r.request.numberOfResults=0,r},Ac=e=>{e.configuration.analytics.enabled&&ii.addElement({name:"Query",...e.query?.q&&{value:e.query.q},time:JSON.stringify(new Date)})};async function Rc(e,t){He(e,{id:_e,q:_e,maxResultsPerQuery:new s({required:!0,min:1}),cacheTimeout:new s});let{q:r,maxResultsPerQuery:n}=e,a=t.getState(),i=new vc({...t,analyticsAction:ns("analytics/instantResult/searchboxAsYouType",(e=>e.makeSearchboxAsYouType()),(e=>new Xs(e)))},(r=>{t.dispatch(no({q:r,id:e.id}))})),o=await kc(a,r,n),c=await i.fetchFromAPI(o,{origin:"instantResults",disableAbortWarning:!0}),u=await i.process(c);return"response"in u?{results:u.response.results,searchUid:u.response.searchUid,analyticsAction:u.analyticsAction,totalCountFiltered:u.response.totalCountFiltered,duration:u.duration}:u}async function Oc(e,t,r){Ac(e);let{analyticsClientMiddleware:n,preprocessRequest:a,logger:i}=t.extra,{description:s}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:a,logger:i}),o=new vc({...t,analyticsAction:r}),c=await yc(e,s),u=await o.fetchFromAPI(c,{origin:"mainSearch"});return await o.process(u)}async function Fc(e,t){let{analyticsClientMiddleware:r,preprocessRequest:n,logger:a}=e.extra,{description:i}=await So().prepare({getState:()=>e.getState(),analyticsClientMiddleware:r,preprocessRequest:n,logger:a}),s=new vc({...e,analyticsAction:So()}),o=await qc(t,i),c=await s.fetchFromAPI(o,{origin:"mainSearch"});return await s.process(c)}async function Ec(e,t,r){Ac(e);let{analyticsClientMiddleware:n,preprocessRequest:a,logger:i}=t.extra,{description:s}=await r.prepare({getState:()=>t.getState(),analyticsClientMiddleware:n,preprocessRequest:a,logger:i}),o=await yc(e,s),c=new vc({...t,analyticsAction:r}),u=await c.fetchFromAPI(o,{origin:"mainSearch"});return await c.process(u)}var Tc=async(e,t,r)=>{let n=function(e){let t=e.advancedSearchQueries?.cq.trim()||"",r=Object.values(e.tabSet||{}).find((e=>e.isActive))?.expression.trim()||"",n=function(e){return Object.values(e.staticFilterSet||{}).map((e=>{let t=e.values.filter((e=>"selected"===e.state&&!!e.expression.trim())),r=t.map((e=>e.expression)).join(" OR ");return t.length>1?`(${r})`:r}))}(e);return[t,r,...n].filter((e=>!!e)).join(" AND ")}(e),a=function(e){return dc(function(e){return function(e){return[...Mc(e.facetSet??{}),...Pc(e.numericFacetSet??{}),...Pc(e.dateFacetSet??{}),...lc(e.categoryFacetSet??{})]}(e).filter((({facetId:t})=>e.facetOptions?.facets[t]?.enabled??!0))}(e),e.facetOrder??[])}(e),i=function(e){let t=e.automaticFacetSet?.set;return t?Object.values(t).map((e=>e.response)).map(Dc).filter((e=>e.currentValues.length>0)):void 0}(e);return Bo({..."legacy"===e.configuration.analytics.analyticsMode?await mo(e,r):ho(e,t,r),...e.didYouMean&&{queryCorrection:{enabled:e.didYouMean.enableDidYouMean&&"next"===e.didYouMean.queryCorrectionMode,options:{automaticallyCorrect:e.didYouMean.automaticallyCorrectQuery?"whenNoResults":"never"}},enableDidYouMean:e.didYouMean.enableDidYouMean&&"legacy"===e.didYouMean.queryCorrectionMode},...n&&{cq:n},...a.length&&{facets:a},...e.pagination&&{numberOfResults:e.pagination?e.pagination.firstResult+e.pagination.numberOfResults>5e3?5e3-e.pagination.firstResult:e.pagination.numberOfResults:void 0,firstResult:e.pagination.firstResult},...e.facetOptions&&{facetOptions:{freezeFacetOrder:e.facetOptions.freezeFacetOrder}},...e.folding?.enabled&&{filterField:e.folding.fields.collection,childField:e.folding.fields.parent,parentField:e.folding.fields.child,filterFieldRange:e.folding.filterFieldRange},...e.automaticFacetSet&&{generateAutomaticFacets:{desiredCount:e.automaticFacetSet.desiredCount,numberOfValues:e.automaticFacetSet.numberOfValues,currentFacets:i}},...e.generatedAnswer&&{pipelineRuleParameters:{mlGenerativeQuestionAnswering:{responseFormat:e.generatedAnswer.responseFormat,citationsFieldToInclude:e.generatedAnswer.fieldsToIncludeInCitations}}}})};function Dc(e){let{field:t,label:r,values:n}=e,a=n.filter((e=>"selected"===e.state));return{field:t,label:r,currentValues:a}}function Mc(e){return lc(e).map((e=>"alphanumericDescending"===e.sortCriteria?{...e,sortCriteria:{type:"alphanumeric",order:"descending"}}:e))}function Pc(e){return lc(e).map((e=>{let t=e.currentValues.some((({state:e})=>"idle"!==e));return e.generateAutomaticRanges&&!t?{...e,currentValues:[]}:e}))}var jc=class{constructor(e,t=(e=>{this.dispatch(po({q:e}))})){this.config=e,this.onUpdateQueryForCorrection=t}async fetchFromAPI({mappings:e,request:t},r){let n=(new Date).getTime();return{response:Ho(await this.extra.apiClient.search(t,r),e),duration:(new Date).getTime()-n,queryExecuted:this.getState().query?.q||"",requestExecuted:t}}async process(e){return this.processQueryErrorOrContinue(e)??await this.processQueryCorrectionsOrContinue(e)??await this.processQueryTriggersOrContinue(e)??this.processSuccessResponse(e)}processQueryErrorOrContinue(e){return Pe(e.response)?(this.dispatch(wo(e.response.error)),this.rejectWithValue(e.response.error)):null}async processQueryCorrectionsOrContinue(e){let t=this.getState(),r=this.getSuccessResponse(e);if(!r||!t.didYouMean)return null;let{enableDidYouMean:n,automaticallyCorrectQuery:a}=t.didYouMean,{results:i,queryCorrections:s,queryCorrection:o}=r;if(!n||!a)return null;let u=0===i.length&&s&&0!==s.length,l=!c(o)&&!c(o.correctedQuery);if(!u&&!l)return null;let d=u?await this.processLegacyDidYouMeanAutoCorrection(e):this.processModernDidYouMeanAutoCorrection(e);return this.dispatch(Ls(tc(this.getState()))),d}async processLegacyDidYouMeanAutoCorrection(e){let t=this.getCurrentQuery(),r=this.getSuccessResponse(e);if(!r.queryCorrections)return null;let{correctedQuery:n}=r.queryCorrections[0],a=await this.automaticallyRetryQueryWithCorrection(n);return Pe(a.response)?(this.dispatch(wo(a.response.error)),this.rejectWithValue(a.response.error)):(this.dispatch(Ls(tc(this.getState()))),{...a,response:{...a.response.success,queryCorrections:r.queryCorrections},automaticallyCorrected:!0,originalQuery:t})}processModernDidYouMeanAutoCorrection(e){let t=this.getSuccessResponse(e),{correctedQuery:r,originalQuery:n}=t.queryCorrection;return this.onUpdateQueryForCorrection(r),{...e,response:{...t},queryExecuted:r,automaticallyCorrected:!0,originalQuery:n}}async processQueryTriggersOrContinue(e){let t=this.getSuccessResponse(e);if(!t)return null;let r=t.triggers.find((e=>"query"===e.type))?.content||"";if(!r)return null;if(this.getState().triggers?.queryModification.queryToIgnore===r)return this.dispatch(cc("")),null;let n=this.getCurrentQuery(),a=await this.automaticallyRetryQueryWithTriggerModification(r);return Pe(a.response)?(this.dispatch(wo(a.response.error)),this.rejectWithValue(a.response.error)):(this.dispatch(Ls(tc(this.getState()))),{...a,response:{...a.response.success},automaticallyCorrected:!1,originalQuery:n})}processSuccessResponse(e){return this.dispatch(Ls(tc(this.getState()))),{...e,response:this.getSuccessResponse(e),automaticallyCorrected:!1,originalQuery:this.getCurrentQuery()}}getSuccessResponse(e){return Me(e.response)?e.response.success:null}async automaticallyRetryQueryWithCorrection(e){this.onUpdateQueryForCorrection(e);let t=this.getState(),{actionCause:r}={actionCause:"didYouMeanAutomatic"},n=await this.fetchFromAPI(await Tc(t,this.extra.navigatorContext,{actionCause:r}),{origin:"mainSearch"});return this.dispatch(Jo(e)),n}async automaticallyRetryQueryWithTriggerModification(e){return this.dispatch(uc({newQuery:e,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(e),await this.fetchFromAPI(await Tc(this.getState(),this.extra.navigatorContext),{origin:"mainSearch"})}getCurrentQuery(){let e=this.getState();return void 0!==e.query?.q?e.query.q:""}get extra(){return this.config.extra}getState(){return this.config.getState()}get dispatch(){return this.config.dispatch}get rejectWithValue(){return this.config.rejectWithValue}},Vc=Ur("search/prepareForSearchWithQuery",((t,r)=>{let{dispatch:n}=r;He(t,{q:new e,enableQuerySyntax:new a,clearFilters:new a}),t.clearFilters&&(n(Ks()),n(Js())),n(Zs({allow:!0})),n(po({q:t.q,enableQuerySyntax:t.enableQuerySyntax})),n(uo(1))})),_c=Ur("search/executeSearch",(async(e,t)=>{let r=t.getState();if("legacy"===r.configuration.analytics.analyticsMode)return Ec(r,t,e.legacy);Hc(r);let n=e.next?Yc(e.next):void 0,a=await Tc(r,t.extra.navigatorContext,n),i=new jc({...t,analyticsAction:n??{}}),s=await i.fetchFromAPI(a,{origin:"mainSearch"});return await i.process(s)})),Uc=Ur("search/fetchPage",(async(e,t)=>{let r=t.getState();if(Hc(r),"legacy"===r.configuration.analytics.analyticsMode||!e.next)return Oc(r,t,e.legacy);let n=new jc({...t,analyticsAction:e.next}),a=await Tc(r,t.extra.navigatorContext,e.next),i=await n.fetchFromAPI(a,{origin:"mainSearch"});return await n.process(i)})),Qc=Ur("search/fetchMoreResults",(async(e,t)=>{let r=t.getState();if("legacy"===r.configuration.analytics.analyticsMode)return Fc(t,r);let n=function(e,t){return{...new Ki(t).getBaseMetadata(),actionCause:e,type:e}}("browseResults",t.getState),a=new jc({...t,analyticsAction:n}),i=await Nc(r,t.extra.navigatorContext,n),s=await a.fetchFromAPI(i,{origin:"mainSearch"});return await a.process(s)})),$c=Ur("search/fetchFacetValues",(async(e,t)=>{let r=t.getState();if("legacy"===r.configuration.analytics.analyticsMode)return Ec(r,t,e.legacy);let n=new jc({...t,analyticsAction:{}}),a=await zc(r,t.extra.navigatorContext),i=await n.fetchFromAPI(a,{origin:"facetValues"});return await n.process(i)})),Lc=Ur("search/fetchInstantResults",(async(e,t)=>{let r=t.getState();if("legacy"===r.configuration.analytics.analyticsMode)return Rc(e,t);He(e,{id:_e,q:_e,maxResultsPerQuery:new s({required:!0,min:1}),cacheTimeout:new s});let{q:n,maxResultsPerQuery:a}=e,i=Yc({actionCause:"searchboxAsYouType"}),o=await Bc(r,t.extra.navigatorContext,n,a,i),c=new jc({...t,analyticsAction:i},(r=>{t.dispatch(no({q:r,id:e.id}))})),u=await c.fetchFromAPI(o,{origin:"instantResults",disableAbortWarning:!0}),l=await c.process(u);return"response"in l?{results:l.response.results,searchUid:l.response.searchUid,totalCountFiltered:l.response.totalCountFiltered,duration:l.duration}:l})),Nc=async(e,t,r)=>{let n=await Tc(e,t,r);return n.request={...n.request,firstResult:(e.pagination?.firstResult??0)+(e.search?.results.length??0)},n},Bc=async(e,t,r,n,a)=>Bo({...ho(e,t,a),...e.didYouMean&&{enableDidYouMean:e.didYouMean.enableDidYouMean},numberOfResults:n,q:r}),zc=async(e,t,r)=>{let n=await Tc(e,t,r);return n.request.numberOfResults=0,n},Hc=e=>{e.configuration.analytics.enabled&&ii.addElement({name:"Query",...e.query?.q&&{value:e.query.q},time:JSON.stringify(new Date)})},Yc=e=>({actionCause:e.actionCause,type:e.actionCause}),Wc=(e,t)=>{let r=e;return c(r[t])?c(e.raw[t])?null:e.raw[t]:r[t]},Gc=(e,t)=>{let r=Wc(t,e);return z(r)?r:[r]},Kc={getResultProperty:Wc,fieldsMustBeDefined:e=>t=>e.every((e=>!c(Wc(t,e)))),fieldsMustNotBeDefined:e=>t=>e.every((e=>c(Wc(t,e)))),fieldMustMatch:(e,t)=>r=>{let n=Gc(e,r);return t.some((e=>n.some((t=>`${t}`.toLowerCase()===e.toLowerCase()))))},fieldMustNotMatch:(e,t)=>r=>{let n=Gc(e,r);return t.every((e=>n.every((t=>`${t}`.toLowerCase()!==e.toLowerCase()))))}};function Jc(e){return""!==e.search.response.searchUid}function Zc(e,t){let r=t.payload??null;r&&(e.response={results:[],searchUid:"",totalCountFiltered:0,facets:[],generateAutomaticFacets:{facets:[]},queryCorrections:[],triggers:[],questionAnswer:{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0},pipeline:"",splitTestRun:"",termsToHighlight:{},phrasesToHighlight:{},extendedResults:{}},e.results=[],e.questionAnswer={answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0}),e.error=r,e.isLoading=!1}function Xc(e,t){e.error=null,e.response=t.payload.response,e.queryExecuted=t.payload.queryExecuted,e.duration=t.payload.duration,e.isLoading=!1}function eu(e,t){e.isLoading=!0,e.requestId=t.meta.requestId}var tu=Ir({response:{results:[],searchUid:"",totalCountFiltered:0,facets:[],generateAutomaticFacets:{facets:[]},queryCorrections:[],triggers:[],questionAnswer:{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0},pipeline:"",splitTestRun:"",termsToHighlight:{},phrasesToHighlight:{},extendedResults:{}},duration:0,queryExecuted:"",error:null,automaticallyCorrected:!1,isLoading:!1,results:[],searchResponseId:"",requestId:"",questionAnswer:{answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0},extendedResults:{}},(e=>{e.addCase(Sc.rejected,((e,t)=>Zc(e,t))),e.addCase(bc.rejected,((e,t)=>Zc(e,t))),e.addCase(wc.rejected,((e,t)=>Zc(e,t))),e.addCase(Sc.fulfilled,((e,t)=>{!function(e,t){Xc(e,t),e.results=t.payload.response.results.map((e=>({...e,searchUid:t.payload.response.searchUid}))),e.searchResponseId=t.payload.response.searchUid,e.questionAnswer=t.payload.response.questionAnswer,e.extendedResults=t.payload.response.extendedResults}(e,t)})),e.addCase(bc.fulfilled,((e,t)=>{Xc(e,t),e.results=[...e.results,...t.payload.response.results.map((e=>({...e,searchUid:t.payload.response.searchUid})))]})),e.addCase(wc.fulfilled,((e,t)=>{Xc(e,t),e.results=[...t.payload.response.results.map((e=>({...e,searchUid:t.payload.response.searchUid})))]})),e.addCase(Cc.fulfilled,((e,t)=>{e.response.facets=t.payload.response.facets,e.response.searchUid=t.payload.response.searchUid})),e.addCase(Sc.pending,eu),e.addCase(bc.pending,eu),e.addCase(wc.pending,eu)})),ru=ir((e=>e.query),(e=>e)),nu=e=>iu(e)?{answerAPIEnabled:!0,id:zl(e).data?.answerId}:au(e)?{answerAPIEnabled:!1,id:e.search.response.extendedResults.generativeQuestionAnsweringId}:{answerAPIEnabled:!1,id:void 0},au=e=>"search"in e,iu=e=>"answer"in e&&"generatedAnswer"in e&&!c(e.generatedAnswer?.answerConfigurationId),su=ir((e=>e.generatedAnswer?.citations),((e,t)=>t),((e,t)=>e?.find((e=>e.id===t))));ir((e=>ru(e)?.q),(e=>e.search.requestId),((e,t)=>({q:e,requestId:t})));var ou=e=>"yes"===e||"no"!==e&&void 0,cu=e=>ns({prefix:"analytics/generatedAnswer/streamEnd",__legacy__getBuilder:(t,r)=>{let{id:n,answerAPIEnabled:a}=nu(r),i=e?!r.generatedAnswer?.answer||!r.generatedAnswer?.answer.length:void 0;return n?t.makeGeneratedAnswerStreamEnd({...a?{answerAPIStreamId:n}:{generativeQuestionAnsweringId:n},answerGenerated:e,answerTextIsEmpty:i}):null},analyticsType:"Rga.StreamEnd",analyticsPayloadBuilder:e=>{let{id:t}=nu(e);if(t)return{responseId:t,answerGenerated:!0}}}),uu={logCopyGeneratedAnswer:()=>ns({prefix:"analytics/generatedAnswer/copy",__legacy__getBuilder:(e,t)=>{let{id:r,answerAPIEnabled:n}=nu(t);return r?e.makeGeneratedAnswerCopyToClipboard({...n?{answerAPIStreamId:r}:{generativeQuestionAnsweringId:r}}):null},analyticsType:"Rga.AnswerAction",analyticsPayloadBuilder:e=>{let{id:t}=nu(e);if(t)return{responseId:t,action:"copyToClipboard"}}}),logGeneratedAnswerHideAnswers:()=>ns({prefix:"analytics/generatedAnswer/hide",__legacy__getBuilder:(e,t)=>{let{id:r,answerAPIEnabled:n}=nu(t);return r?e.makeGeneratedAnswerHideAnswers({...n?{answerAPIStreamId:r}:{generativeQuestionAnsweringId:r}}):null},analyticsType:"Rga.AnswerAction",analyticsPayloadBuilder:e=>{let{id:t}=nu(e);if(t)return{responseId:t,action:"hide"}}}),logGeneratedAnswerShowAnswers:()=>ns({prefix:"analytics/generatedAnswer/show",__legacy__getBuilder:(e,t)=>{let{id:r,answerAPIEnabled:n}=nu(t);return r?e.makeGeneratedAnswerShowAnswers({...n?{answerAPIStreamId:r}:{generativeQuestionAnsweringId:r}}):null},analyticsType:"Rga.AnswerAction",analyticsPayloadBuilder:e=>{let{id:t}=nu(e);if(t)return{responseId:t,action:"show"}}}),logGeneratedAnswerStreamEnd:cu,logGeneratedAnswerFeedback:e=>ns({prefix:"analytics/generatedAnswer/sendFeedback",__legacy__getBuilder:(t,r)=>{let{id:n,answerAPIEnabled:a}=nu(r);return n?t.makeGeneratedAnswerFeedbackSubmitV2({...a?{answerAPIStreamId:n}:{generativeQuestionAnsweringId:n},...e}):null},analyticsType:"Rga.SubmitFeedback",analyticsPayloadBuilder:t=>{let{id:r}=nu(t);if(r){let{helpful:t,readable:n,documented:a,hallucinationFree:i,correctTopic:s,documentUrl:o,details:c}=e;return{responseId:r,helpful:t,details:{readable:ou(n),documented:ou(a),correctTopic:ou(s),hallucinationFree:ou(i)},additionalNotes:c,correctAnswerUrl:o}}}}),logDislikeGeneratedAnswer:()=>ns({prefix:"analytics/generatedAnswer/dislike",__legacy__getBuilder:(e,t)=>{let{id:r,answerAPIEnabled:n}=nu(t);return r?e.makeDislikeGeneratedAnswer({...n?{answerAPIStreamId:r}:{generativeQuestionAnsweringId:r}}):null},analyticsType:"Rga.AnswerAction",analyticsPayloadBuilder:e=>{let{id:t}=nu(e);if(t)return{responseId:t,action:"dislike"}}}),logLikeGeneratedAnswer:()=>ns({prefix:"analytics/generatedAnswer/like",__legacy__getBuilder:(e,t)=>{let{id:r,answerAPIEnabled:n}=nu(t);return r?e.makeLikeGeneratedAnswer({...n?{answerAPIStreamId:r}:{generativeQuestionAnsweringId:r}}):null},analyticsType:"Rga.AnswerAction",analyticsPayloadBuilder:e=>{let{id:t}=nu(e);if(t)return{responseId:t,action:"like"}}}),logHoverCitation:(e,t)=>ns({prefix:"analytics/generatedAnswer/hoverCitation",__legacy__getBuilder:(r,n)=>{let{id:a,answerAPIEnabled:i}=nu(n),s=su(n,e);return a&&s?r.makeGeneratedAnswerSourceHover({...i?{answerAPIStreamId:a}:{generativeQuestionAnsweringId:a},permanentId:s.permanentid,citationId:s.id,citationHoverTimeMs:t}):null},analyticsType:"Rga.CitationHover",analyticsPayloadBuilder:r=>{let n=su(r,e),{id:a}=nu(r);if(a)return{responseId:a,citationId:e,itemMetadata:{uniqueFieldName:"permanentid",uniqueFieldValue:n?.permanentid??"",title:n?.title,url:n?.clickUri},citationHoverTimeInMs:t}}}),logOpenGeneratedAnswerSource:e=>ns({prefix:"analytics/generatedAnswer/openAnswerSource",__legacy__getBuilder:(t,r)=>{let{id:n,answerAPIEnabled:a}=nu(r),i=su(r,e);return n&&i?t.makeGeneratedAnswerCitationClick(((e,t)=>({sourceName:is(e),documentPosition:1,documentTitle:e.title,documentUri:e.uri,documentUrl:e.clickUri,queryPipeline:t.pipeline||es()}))(i,r),{...a?{answerAPIStreamId:n}:{generativeQuestionAnsweringId:n},citationId:i.id,documentId:ss(i)}):null},analyticsType:"Rga.CitationClick",analyticsPayloadBuilder:t=>{let r=su(t,e),{id:n}=nu(t);if(n)return{responseId:n??"",citationId:e,itemMetadata:{uniqueFieldName:"permanentid",uniqueFieldValue:r?.permanentid??"",title:r?.title,url:r?.clickUri}}}}),logRetryGeneratedAnswer:()=>ns("analytics/generatedAnswer/retry",(e=>e.makeRetryGeneratedAnswer())),logGeneratedAnswerExpand:()=>ns({prefix:"analytics/generatedAnswer/expand",__legacy__getBuilder:(e,t)=>{let{id:r,answerAPIEnabled:n}=nu(t);return r?e.makeGeneratedAnswerExpand({...n?{answerAPIStreamId:r}:{generativeQuestionAnsweringId:r}}):null},analyticsType:"Rga.AnswerAction",analyticsPayloadBuilder:e=>{let{id:t}=nu(e);if(t)return{responseId:t,action:"expand"}}}),logGeneratedAnswerCollapse:()=>ns({prefix:"analytics/generatedAnswer/collapse",__legacy__getBuilder:(e,t)=>{let{id:r,answerAPIEnabled:n}=nu(t);return r?e.makeGeneratedAnswerCollapse({...n?{answerAPIStreamId:r}:{generativeQuestionAnsweringId:r}}):null},analyticsType:"Rga.AnswerAction",analyticsPayloadBuilder:e=>{let{id:t}=nu(e);if(t)return{responseId:t,action:"collapse"}}})},lu=new e({required:!0}),du=new e,fu=new a({required:!0}),pu={id:lu,title:lu,uri:lu,permanentid:lu,clickUri:du},gu=new e({required:!0,constrainTo:["text/plain","text/markdown"]}),hu=dr("generatedAnswer/setIsVisible",(e=>He(e,fu))),yu=dr("generatedAnswer/setIsEnabled",(e=>He(e,fu))),mu=dr("generatedAnswer/updateMessage",(e=>He(e,{textDelta:lu}))),vu=dr("generatedAnswer/updateCitations",(e=>He(e,{citations:new t({required:!0,each:new r({values:pu})})}))),Su=dr("generatedAnswer/updateError",(e=>He(e,{message:du,code:new s({min:0})}))),wu=dr("generatedAnswer/resetAnswer"),bu=dr("generatedAnswer/like"),Cu=dr("generatedAnswer/dislike"),Iu=dr("generatedAnswer/feedbackModal/open"),qu=dr("generatedAnswer/expand"),ku=dr("generatedAnswer/collapse"),xu=dr("generatedAnswer/setId",(t=>He(t,{id:new e({required:!0})}))),Au=dr("generatedAnswer/feedbackModal/close"),Ru=dr("generatedAnswer/sendFeedback"),Ou=dr("generatedAnswer/setIsLoading",(e=>He(e,fu))),Fu=dr("generatedAnswer/setIsStreaming",(e=>He(e,fu))),Eu=dr("generatedAnswer/setAnswerContentFormat",(e=>He(e,gu))),Tu=dr("generatedAnswer/updateResponseFormat",(e=>He(e,{contentFormat:new t({each:gu,default:["text/plain"]})}))),Du=dr("knowledge/updateAnswerConfigurationId",(e=>He(e,lu))),Mu=dr("generatedAnswer/registerFieldsToIncludeInCitations",(e=>He(e,Le))),Pu=dr("generatedAnswer/setIsAnswerGenerated",(e=>He(e,fu))),ju=Ur("generatedAnswer/streamAnswer",(async(e,t)=>{let r=t.getState(),{dispatch:n,extra:a}=t,{setAbortControllerRef:i}=e,s=await(async e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:ye(e.configuration.organizationId,e.configuration.environment),streamId:e.search.extendedResults?.generativeQuestionAnsweringId}))(r);n(Ou(!0));let o=e=>e.streamId===t.getState().search.extendedResults.generativeQuestionAnsweringId,c=a.streamingClient?.streamGeneratedAnswer(s,{write:e=>{o(s)&&(n(Ou(!1)),e.payload&&e.payloadType&&((e,t)=>{switch(e){case"genqa.headerMessageType":{let e=JSON.parse(t);n(Eu(e.contentFormat));break}case"genqa.messageType":n(mu(JSON.parse(t)));break;case"genqa.citationsType":n(vu(JSON.parse(t)));break;case"genqa.endOfStreamType":{let e=JSON.parse(t).answerGenerated;n(Fu(!1)),n(Pu(e)),n(cu(e));break}default:r.debug&&a.logger.warn(`Unknown payloadType: "${e}"`)}})(e.payloadType,e.payload))},abort:e=>{o(s)&&n(Su(e))},close:()=>{o(s)&&n(Fu(!1))},resetAnswer:()=>{o(s)&&n(wu())}});c?i(c):n(Ou(!1))})),Vu=ir((e=>e.pipeline),(e=>e)),_u=ir((e=>e.searchHub),(e=>e));function Uu(e){return{status:e,isUninitialized:"uninitialized"===e,isLoading:"pending"===e,isSuccess:"fulfilled"===e,isError:"rejected"===e}}var Qu=et;function $u(e,t){if(e===t||!(Qu(e)&&Qu(t)||Array.isArray(e)&&Array.isArray(t)))return t;let r=Object.keys(t),n=Object.keys(e),a=r.length===n.length,i=Array.isArray(t)?[]:{};for(let n of r)i[n]=$u(e[n],t[n]),a&&(a=e[n]===i[n]);return a?e:i}function Lu(e){let t=0;for(let r in e)t++;return t}var Nu=e=>[].concat(...e);function Bu(e){return null!=e}var zu=e=>e.replace(/\/$/,""),Hu=e=>e.replace(/^\//,"");function Yu(e,t){if(!e)return t;if(!t)return e;if(function(e){return new RegExp("(^|:)//").test(e)}(t))return t;let r=e.endsWith("/")||!t.startsWith("?")?"/":"";return`${e=zu(e)}${r}${t=Hu(t)}`}var Wu=(...e)=>fetch(...e),Gu=e=>e.status>=200&&e.status<=299,Ku=e=>/ion\/(vnd\.api\+)?json/.test(e.get("content-type")||"");function Ju(e){if(!et(e))return e;let t={...e};for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return t}function Zu({baseUrl:e,prepareHeaders:t=(e=>e),fetchFn:r=Wu,paramsSerializer:n,isJsonContentType:a=Ku,jsonContentType:i="application/json",jsonReplacer:s,timeout:o,responseHandler:c,validateStatus:u,...l}={}){return typeof fetch>"u"&&r===Wu&&console.warn("Warning: `fetch` is not available. Please supply a custom `fetchFn` property to use `fetchBaseQuery` on SSR environments."),async(f,p)=>{let g,{signal:h,getState:y,extra:m,endpoint:v,forced:S,type:w}=p,{url:b,headers:C=new Headers(l.headers),params:I,responseHandler:q=c??"json",validateStatus:k=u??Gu,timeout:x=o,...A}="string"==typeof f?{url:f}:f,R={...l,signal:h,...A};C=new Headers(Ju(C)),R.headers=await t(C,{getState:y,extra:m,endpoint:v,forced:S,type:w})||C;let O=e=>"object"==typeof e&&(et(e)||Array.isArray(e)||"function"==typeof e.toJSON);if(!R.headers.has("content-type")&&O(R.body)&&R.headers.set("content-type",i),O(R.body)&&a(R.headers)&&(R.body=JSON.stringify(R.body,s)),I){let e=~b.indexOf("?")?"&":"?";b+=e+(n?n(I):new URLSearchParams(Ju(I)))}b=Yu(e,b);let F=new Request(b,R);g={request:new Request(b,R)};let E,T=!1,D=x&&setTimeout((()=>{T=!0,p.abort()}),x);try{E=await r(F)}catch(e){return{error:{status:T?"TIMEOUT_ERROR":"FETCH_ERROR",error:String(e)},meta:g}}finally{D&&clearTimeout(D)}let M=E.clone();g.response=M;let P,j="";try{let e;if(await Promise.all([d(E,q).then((e=>P=e),(t=>e=t)),M.text().then((e=>j=e),(()=>{}))]),e)throw e}catch(e){return{error:{status:"PARSING_ERROR",originalStatus:E.status,data:j,error:String(e)},meta:g}}return k(E,P)?{data:P,meta:g}:{error:{status:E.status,data:P},meta:g}};async function d(e,t){if("function"==typeof t)return t(e);if("content-type"===t&&(t=a(e.headers)?"json":"text"),"json"===t){let t=await e.text();return t.length?JSON.parse(t):null}return e.text()}}var Xu=class{constructor(e,t=void 0){this.value=e,this.meta=t}};async function el(e=0,t=5){let r=Math.min(e,t),n=~~((Math.random()+.4)*(300<<r));await new Promise((e=>setTimeout((t=>e(t)),n)))}var tl={},rl=Object.assign(((e,t)=>async(r,n,a)=>{let i=[5,(t||tl).maxRetries,(a||tl).maxRetries].filter((e=>void 0!==e)),[s]=i.slice(-1),o={maxRetries:s,backoff:el,retryCondition:(e,t,{attempt:r})=>r<=s,...t,...a},c=0;for(;;)try{let t=await e(r,n,a);if(t.error)throw new Xu(t);return t}catch(e){if(c++,e.throwImmediately){if(e instanceof Xu)return e.value;throw e}if(e instanceof Xu&&!o.retryCondition(e.value.error,r,{attempt:c,baseQueryApi:n,extraOptions:a}))return e.value;await o.backoff(c,o.maxRetries)}}),{fail:function(e){throw Object.assign(new Xu({error:e}),{throwImmediately:!0})}}),nl=dr("__rtkq/focused"),al=dr("__rtkq/unfocused"),il=dr("__rtkq/online"),sl=dr("__rtkq/offline");function ol(e){return"query"===e.type}function cl(e,t,r,n,a,i){return function(e){return"function"==typeof e}(e)?e(t,r,n,a).map(ul).map(i):Array.isArray(e)?e.map(ul).map(i):[]}function ul(e){return"string"==typeof e?{type:e}:e}var ll=Symbol("forceQueryFn"),dl=e=>"function"==typeof e[ll];function fl(e){return e}function pl(e,t,r,n){return cl(r[e.meta.arg.endpointName][t],Tr(e)?e.payload:void 0,Er(e)?e.payload:void 0,e.meta.arg.originalArgs,"baseQueryMeta"in e.meta?e.meta.baseQueryMeta:void 0,n)}function gl(e,t,r){let n=e[t];n&&r(n)}function hl(e){return("arg"in e?e.arg.fixedCacheKey:e.fixedCacheKey)??e.requestId}function yl(e,t,r){let n=e[hl(t)];n&&r(n)}var ml={};function vl({reducerPath:e,queryThunk:t,mutationThunk:r,context:{endpointDefinitions:n,apiUid:a,extractRehydrationInfo:i,hasRehydrationInfo:s},assertTagType:o,config:c}){let u=dr(`${e}/resetApiState`),l=Br({name:`${e}/queries`,initialState:ml,reducers:{removeQueryResult:{reducer(e,{payload:{queryCacheKey:t}}){delete e[t]},prepare:mr()},queryResultPatched:{reducer(e,{payload:{queryCacheKey:t,patches:r}}){gl(e,t,(e=>{e.data=Jt(e.data,r.concat())}))},prepare:mr()}},extraReducers(e){e.addCase(t.pending,((e,{meta:t,meta:{arg:r}})=>{var n;let a=dl(r);e[n=r.queryCacheKey]??(e[n]={status:"uninitialized",endpointName:r.endpointName}),gl(e,r.queryCacheKey,(e=>{e.status="pending",e.requestId=a&&e.requestId?e.requestId:t.requestId,void 0!==r.originalArgs&&(e.originalArgs=r.originalArgs),e.startedTimeStamp=t.startedTimeStamp}))})).addCase(t.fulfilled,((e,{meta:t,payload:r})=>{gl(e,t.arg.queryCacheKey,(e=>{if(e.requestId!==t.requestId&&!dl(t.arg))return;let{merge:a}=n[t.arg.endpointName];if(e.status="fulfilled",a)if(void 0!==e.data){let{fulfilledTimeStamp:n,arg:i,baseQueryMeta:s,requestId:o}=t,c=Gt(e.data,(e=>a(e,r,{arg:i.originalArgs,baseQueryMeta:s,fulfilledTimeStamp:n,requestId:o})));e.data=c}else e.data=r;else e.data=n[t.arg.endpointName].structuralSharing??1?$u(lt(e.data)?function(e){return lt(e)||ct(15),e[ot].base_}(e.data):e.data,r):r;delete e.error,e.fulfilledTimeStamp=t.fulfilledTimeStamp}))})).addCase(t.rejected,((e,{meta:{condition:t,arg:r,requestId:n},error:a,payload:i})=>{gl(e,r.queryCacheKey,(e=>{if(!t){if(e.requestId!==n)return;e.status="rejected",e.error=i??a}}))})).addMatcher(s,((e,t)=>{let{queries:r}=i(t);for(let[t,n]of Object.entries(r))("fulfilled"===n?.status||"rejected"===n?.status)&&(e[t]=n)}))}}),d=Br({name:`${e}/mutations`,initialState:ml,reducers:{removeMutationResult:{reducer(e,{payload:t}){let r=hl(t);r in e&&delete e[r]},prepare:mr()}},extraReducers(e){e.addCase(r.pending,((e,{meta:t,meta:{requestId:r,arg:n,startedTimeStamp:a}})=>{n.track&&(e[hl(t)]={requestId:r,status:"pending",endpointName:n.endpointName,startedTimeStamp:a})})).addCase(r.fulfilled,((e,{payload:t,meta:r})=>{r.arg.track&&yl(e,r,(e=>{e.requestId===r.requestId&&(e.status="fulfilled",e.data=t,e.fulfilledTimeStamp=r.fulfilledTimeStamp)}))})).addCase(r.rejected,((e,{payload:t,error:r,meta:n})=>{n.arg.track&&yl(e,n,(e=>{e.requestId===n.requestId&&(e.status="rejected",e.error=t??r)}))})).addMatcher(s,((e,t)=>{let{mutations:r}=i(t);for(let[t,n]of Object.entries(r))("fulfilled"===n?.status||"rejected"===n?.status)&&t!==n?.requestId&&(e[t]=n)}))}}),f=Br({name:`${e}/invalidation`,initialState:ml,reducers:{updateProvidedBy:{reducer(e,t){var r,n;let{queryCacheKey:a,providedTags:i}=t.payload;for(let t of Object.values(e))for(let e of Object.values(t)){let t=e.indexOf(a);-1!==t&&e.splice(t,1)}for(let{type:t,id:s}of i){let i=(r=e[t]??(e[t]={}))[n=s||"__internal_without_id"]??(r[n]=[]);i.includes(a)||i.push(a)}},prepare:mr()}},extraReducers(e){e.addCase(l.actions.removeQueryResult,((e,{payload:{queryCacheKey:t}})=>{for(let r of Object.values(e))for(let e of Object.values(r)){let r=e.indexOf(t);-1!==r&&e.splice(r,1)}})).addMatcher(s,((e,t)=>{var r,n;let{provided:a}=i(t);for(let[t,i]of Object.entries(a))for(let[a,s]of Object.entries(i)){let i=(r=e[t]??(e[t]={}))[n=a||"__internal_without_id"]??(r[n]=[]);for(let e of s)i.includes(e)||i.push(e)}})).addMatcher(kr(Tr(t),Er(t)),((e,t)=>{let r=pl(t,"providesTags",n,o),{queryCacheKey:a}=t.meta.arg;f.caseReducers.updateProvidedBy(e,f.actions.updateProvidedBy({queryCacheKey:a,providedTags:r}))}))}}),p=Br({name:`${e}/subscriptions`,initialState:ml,reducers:{updateSubscriptionOptions(e,t){},unsubscribeQueryResult(e,t){},internal_getRTKQSubscriptions(){}}}),g=Br({name:`${e}/internalSubscriptions`,initialState:ml,reducers:{subscriptionsUpdated:{reducer:(e,t)=>Jt(e,t.payload),prepare:mr()}}}),h=Br({name:`${e}/config`,initialState:{online:typeof navigator>"u"||void 0===navigator.onLine||navigator.onLine,focused:typeof document>"u"||"hidden"!==document.visibilityState,middlewareRegistered:!1,...c},reducers:{middlewareRegistered(e,{payload:t}){e.middlewareRegistered="conflict"!==e.middlewareRegistered&&a===t||"conflict"}},extraReducers:e=>{e.addCase(il,(e=>{e.online=!0})).addCase(sl,(e=>{e.online=!1})).addCase(nl,(e=>{e.focused=!0})).addCase(al,(e=>{e.focused=!1})).addMatcher(s,(e=>({...e})))}}),y=rt({queries:l.reducer,mutations:d.reducer,provided:f.reducer,subscriptions:g.reducer,config:h.reducer});return{reducer:(e,t)=>y(u.match(t)?void 0:e,t),actions:{...h.actions,...l.actions,...p.actions,...g.actions,...d.actions,...f.actions,resetApiState:u}}}var Sl=Symbol.for("RTKQ/skipToken"),wl={status:"uninitialized"},bl=Gt(wl,(()=>{})),Cl=Gt(wl,(()=>{}));var Il=WeakMap?new WeakMap:void 0,ql=({endpointName:e,queryArgs:t})=>{let r="",n=Il?.get(t);if("string"==typeof n)r=n;else{let e=JSON.stringify(t,((e,t)=>t=et(t="bigint"==typeof t?{$bigint:t.toString()}:t)?Object.keys(t).sort().reduce(((e,r)=>(e[r]=t[r],e)),{}):t));et(t)&&Il?.set(t,e),r=e}return`${e}(${r})`};function kl(e,...t){return Object.assign(e,...t)}var xl=({api:e,queryThunk:t,internalState:r})=>{let n=`${e.reducerPath}/subscriptions`,a=null,i=null,{updateSubscriptionOptions:s,unsubscribeQueryResult:o}=e.internalActions,c=()=>r.currentSubscriptions,u={getSubscriptions:c,getSubscriptionCount:e=>Lu(c()[e]??{}),isRequestSubscribed:(e,t)=>!!c()?.[e]?.[t]};return(c,l)=>{if(a||(a=JSON.parse(JSON.stringify(r.currentSubscriptions))),e.util.resetApiState.match(c))return a=r.currentSubscriptions={},i=null,[!0,!1];if(e.internalActions.internal_getRTKQSubscriptions.match(c))return[!1,u];let d=((r,n)=>{var a,i;if(s.match(n)){let{queryCacheKey:e,requestId:t,options:a}=n.payload;return r?.[e]?.[t]&&(r[e][t]=a),!0}if(o.match(n)){let{queryCacheKey:e,requestId:t}=n.payload;return r[e]&&delete r[e][t],!0}if(e.internalActions.removeQueryResult.match(n))return delete r[n.payload.queryCacheKey],!0;if(t.pending.match(n)){let{meta:{arg:e,requestId:t}}=n,i=r[a=e.queryCacheKey]??(r[a]={});return i[`${t}_running`]={},e.subscribe&&(i[t]=e.subscriptionOptions??i[t]??{}),!0}let c=!1;if(t.fulfilled.match(n)||t.rejected.match(n)){let e=r[n.meta.arg.queryCacheKey]||{},t=`${n.meta.requestId}_running`;c||(c=!!e[t]),delete e[t]}if(t.rejected.match(n)){let{meta:{condition:e,arg:t,requestId:a}}=n;if(e&&t.subscribe){let e=r[i=t.queryCacheKey]??(r[i]={});e[a]=t.subscriptionOptions??e[a]??{},c=!0}}return c})(r.currentSubscriptions,c),f=!0;if(d){i||(i=setTimeout((()=>{let t=JSON.parse(JSON.stringify(r.currentSubscriptions)),[,n]=Kt(a,(()=>t));l.next(e.internalActions.subscriptionsUpdated(n)),a=t,i=null}),500));let s="string"==typeof c.type&&!!c.type.startsWith(n),o=t.rejected.match(c)&&c.meta.condition&&!!c.meta.arg.subscribe;f=!s&&!o}return[f,!1]}};var Al=({reducerPath:e,api:t,queryThunk:r,context:n,internalState:a})=>{let{removeQueryResult:i,unsubscribeQueryResult:s}=t.internalActions,o=kr(s.match,r.fulfilled,r.rejected);function c(e){let t=a.currentSubscriptions[e];return!!t&&!function(e){for(let t in e)return!1;return!0}(t)}let u={};function l(e,t,r,a){let s=n.endpointDefinitions[t]?.keepUnusedDataFor??a.keepUnusedDataFor;if(s===1/0)return;let o=Math.max(0,Math.min(s,2147482.647));if(!c(e)){let t=u[e];t&&clearTimeout(t),u[e]=setTimeout((()=>{c(e)||r.dispatch(i({queryCacheKey:e})),delete u[e]}),1e3*o)}}return(r,a,i)=>{if(o(r)){let t=a.getState()[e],{queryCacheKey:n}=s.match(r)?r.payload:r.meta.arg;l(n,t.queries[n]?.endpointName,a,t.config)}if(t.util.resetApiState.match(r))for(let[e,t]of Object.entries(u))t&&clearTimeout(t),delete u[e];if(n.hasRehydrationInfo(r)){let t=a.getState()[e],{queries:i}=n.extractRehydrationInfo(r);for(let[e,r]of Object.entries(i))l(e,r?.endpointName,a,t.config)}}},Rl=new Error("Promise never resolved before cacheEntryRemoved."),Ol=({api:e,reducerPath:t,context:r,queryThunk:n,mutationThunk:a,internalState:i})=>{let s=Dr(n),o=Dr(a),c=Tr(n,a),u={};function l(t,n,a,i,s){let o=r.endpointDefinitions[t],c=o?.onCacheEntryAdded;if(!c)return;let l={},d=new Promise((e=>{l.cacheEntryRemoved=e})),f=Promise.race([new Promise((e=>{l.valueResolved=e})),d.then((()=>{throw Rl}))]);f.catch((()=>{})),u[a]=l;let p=e.endpoints[t].select("query"===o.type?n:a),g=i.dispatch(((e,t,r)=>r)),h={...i,getCacheEntry:()=>p(i.getState()),requestId:s,extra:g,updateCachedData:"query"===o.type?r=>i.dispatch(e.util.updateQueryData(t,n,r)):void 0,cacheDataLoaded:f,cacheEntryRemoved:d},y=c(n,h);Promise.resolve(y).catch((e=>{if(e!==Rl)throw e}))}return(r,i,d)=>{let f=function(t){return s(t)?t.meta.arg.queryCacheKey:o(t)?t.meta.arg.fixedCacheKey??t.meta.requestId:e.internalActions.removeQueryResult.match(t)?t.payload.queryCacheKey:e.internalActions.removeMutationResult.match(t)?hl(t.payload):""}(r);if(n.pending.match(r)){let e=d[t].queries[f],n=i.getState()[t].queries[f];!e&&n&&l(r.meta.arg.endpointName,r.meta.arg.originalArgs,f,i,r.meta.requestId)}else if(a.pending.match(r))i.getState()[t].mutations[f]&&l(r.meta.arg.endpointName,r.meta.arg.originalArgs,f,i,r.meta.requestId);else if(c(r)){let e=u[f];e?.valueResolved&&(e.valueResolved({data:r.payload,meta:r.meta.baseQueryMeta}),delete e.valueResolved)}else if(e.internalActions.removeQueryResult.match(r)||e.internalActions.removeMutationResult.match(r)){let e=u[f];e&&(delete u[f],e.cacheEntryRemoved())}else if(e.util.resetApiState.match(r))for(let[e,t]of Object.entries(u))delete u[e],t.cacheEntryRemoved()}},Fl=({api:e,context:{apiUid:t},reducerPath:r})=>(r,n)=>{e.util.resetApiState.match(r)&&n.dispatch(e.internalActions.middlewareRegistered(t))},El=({reducerPath:e,context:t,context:{endpointDefinitions:r},mutationThunk:n,queryThunk:a,api:i,assertTagType:s,refetchQuery:o,internalState:c})=>{let{removeQueryResult:u}=i.internalActions,l=kr(Tr(n),Er(n)),d=kr(Tr(n,a),Fr(n,a)),f=[];function p(r,n){let a=n.getState(),s=a[e];if(f.push(...r),"delayed"===s.config.invalidationBehavior&&function(e){for(let t in e.queries)if("pending"===e.queries[t]?.status)return!0;for(let t in e.mutations)if("pending"===e.mutations[t]?.status)return!0;return!1}(s))return;let l=f;if(f=[],0===l.length)return;let d=i.util.selectInvalidatedBy(a,l);t.batch((()=>{let e=Array.from(d.values());for(let{queryCacheKey:t}of e){let e=s.queries[t],r=c.currentSubscriptions[t]??{};e&&(0===Lu(r)?n.dispatch(u({queryCacheKey:t})):"uninitialized"!==e.status&&n.dispatch(o(e,t)))}}))}return(e,t)=>{l(e)?p(pl(e,"invalidatesTags",r,s),t):d(e)?p([],t):i.util.invalidateTags.match(e)&&p(cl(e.payload,void 0,void 0,void 0,void 0,s),t)}},Tl=({reducerPath:e,queryThunk:t,api:r,refetchQuery:n,internalState:a})=>{let i={};function s({queryCacheKey:t},r){let o=r.getState()[e],c=o.queries[t],l=a.currentSubscriptions[t];if(!c||"uninitialized"===c.status)return;let{lowestPollingInterval:d,skipPollingIfUnfocused:f}=u(l);if(!Number.isFinite(d))return;let p=i[t];p?.timeout&&(clearTimeout(p.timeout),p.timeout=void 0);let g=Date.now()+d;i[t]={nextPollTimestamp:g,pollingInterval:d,timeout:setTimeout((()=>{(o.config.focused||!f)&&r.dispatch(n(c,t)),s({queryCacheKey:t},r)}),d)}}function o({queryCacheKey:t},r){let n=r.getState()[e].queries[t],o=a.currentSubscriptions[t];if(!n||"uninitialized"===n.status)return;let{lowestPollingInterval:l}=u(o);if(!Number.isFinite(l))return void c(t);let d=i[t],f=Date.now()+l;(!d||f<d.nextPollTimestamp)&&s({queryCacheKey:t},r)}function c(e){let t=i[e];t?.timeout&&clearTimeout(t.timeout),delete i[e]}function u(e={}){let t=!1,r=Number.POSITIVE_INFINITY;for(let n in e)e[n].pollingInterval&&(r=Math.min(e[n].pollingInterval,r),t=e[n].skipPollingIfUnfocused||t);return{lowestPollingInterval:r,skipPollingIfUnfocused:t}}return(e,n)=>{(r.internalActions.updateSubscriptionOptions.match(e)||r.internalActions.unsubscribeQueryResult.match(e))&&o(e.payload,n),(t.pending.match(e)||t.rejected.match(e)&&e.meta.condition)&&o(e.meta.arg,n),(t.fulfilled.match(e)||t.rejected.match(e)&&!e.meta.condition)&&s(e.meta.arg,n),r.util.resetApiState.match(e)&&function(){for(let e of Object.keys(i))c(e)}()}},Dl=({api:e,context:t,queryThunk:r,mutationThunk:n})=>{let a=Or(r,n),i=Fr(r,n),s=Tr(r,n),o={};return(r,n)=>{if(a(r)){let{requestId:a,arg:{endpointName:i,originalArgs:s}}=r.meta,c=t.endpointDefinitions[i],u=c?.onQueryStarted;if(u){let t={},r=new Promise(((e,r)=>{t.resolve=e,t.reject=r}));r.catch((()=>{})),o[a]=t;let l=e.endpoints[i].select("query"===c.type?s:a),d=n.dispatch(((e,t,r)=>r)),f={...n,getCacheEntry:()=>l(n.getState()),requestId:a,extra:d,updateCachedData:"query"===c.type?t=>n.dispatch(e.util.updateQueryData(i,s,t)):void 0,queryFulfilled:r};u(s,f)}}else if(s(r)){let{requestId:e,baseQueryMeta:t}=r.meta;o[e]?.resolve({data:r.payload,meta:t}),delete o[e]}else if(i(r)){let{requestId:e,rejectedWithValue:t,baseQueryMeta:n}=r.meta;o[e]?.reject({error:r.payload??r.error,isUnhandledError:!t,meta:n}),delete o[e]}}};function Ml(e){let{reducerPath:t,queryThunk:r,api:n,context:a}=e,{apiUid:i}=a,s={invalidateTags:dr(`${t}/invalidateTags`)},o=e=>e.type.startsWith(`${t}/`),c=[Fl,Al,El,Tl,Ol,Dl];return{middleware:r=>{let s=!1,l={...e,internalState:{currentSubscriptions:{}},refetchQuery:u,isThisApiSliceAction:o},d=c.map((e=>e(l))),f=xl(l),p=(({reducerPath:e,context:t,api:r,refetchQuery:n,internalState:a})=>{let{removeQueryResult:i}=r.internalActions;function s(r,s){let o=r.getState()[e],c=o.queries,u=a.currentSubscriptions;t.batch((()=>{for(let e of Object.keys(u)){let t=c[e],a=u[e];a&&t&&(Object.values(a).some((e=>!0===e[s]))||Object.values(a).every((e=>void 0===e[s]))&&o.config[s])&&(0===Lu(a)?r.dispatch(i({queryCacheKey:e})):"uninitialized"!==t.status&&r.dispatch(n(t,e)))}}))}return(e,t)=>{nl.match(e)&&s(t,"refetchOnFocus"),il.match(e)&&s(t,"refetchOnReconnect")}})(l);return e=>c=>{if(!at(c))return e(c);s||(s=!0,r.dispatch(n.internalActions.middlewareRegistered(i)));let u,l={...r,next:e},g=r.getState(),[h,y]=f(c,l,g);if(u=h?e(c):y,r.getState()[t]&&(p(c,l,g),o(c)||a.hasRehydrationInfo(c)))for(let e of d)e(c,l,g);return u}},actions:s};function u(e,t,n={}){return r({type:"query",endpointName:e.endpointName,originalArgs:e.originalArgs,subscribe:!1,forceRefetch:!0,queryCacheKey:t,...n})}}var Pl=Symbol(),jl=function(...e){return function(t){let r=ar((e=>t.extractRehydrationInfo?.(e,{reducerPath:t.reducerPath??"api"}))),n={reducerPath:"api",keepUnusedDataFor:60,refetchOnMountOrArgChange:!1,refetchOnFocus:!1,refetchOnReconnect:!1,invalidationBehavior:"delayed",...t,extractRehydrationInfo:r,serializeQueryArgs(e){let r=ql;if("serializeQueryArgs"in e.endpointDefinition){let t=e.endpointDefinition.serializeQueryArgs;r=e=>{let r=t(e);return"string"==typeof r?r:ql({...e,queryArgs:r})}}else t.serializeQueryArgs&&(r=t.serializeQueryArgs);return r(e)},tagTypes:[...t.tagTypes||[]]},a={endpointDefinitions:{},batch(e){e()},apiUid:Mr(),extractRehydrationInfo:r,hasRehydrationInfo:ar((e=>null!=r(e)))},i={injectEndpoints:function(e){let t=e.endpoints({query:e=>({...e,type:"query"}),mutation:e=>({...e,type:"mutation"})});for(let[r,n]of Object.entries(t))if(!0!==e.overrideExisting&&r in a.endpointDefinitions){if("throw"===e.overrideExisting)throw new Error(Kr(39))}else{a.endpointDefinitions[r]=n;for(let e of s)e.injectEndpoint(r,n)}return i},enhanceEndpoints({addTagTypes:e,endpoints:t}){if(e)for(let t of e)n.tagTypes.includes(t)||n.tagTypes.push(t);if(t)for(let[e,r]of Object.entries(t))"function"==typeof r?r(a.endpointDefinitions[e]):Object.assign(a.endpointDefinitions[e]||{},r);return i}},s=e.map((e=>e.init(i,n,a)));return i.injectEndpoints({endpoints:t.endpoints})}}((({createSelector:e=ir}={})=>({name:Pl,init(t,{baseQuery:r,tagTypes:n,reducerPath:a,serializeQueryArgs:i,keepUnusedDataFor:s,refetchOnMountOrArgChange:o,refetchOnFocus:c,refetchOnReconnect:u,invalidationBehavior:l},d){Yt();let f=e=>e;Object.assign(t,{reducerPath:a,endpoints:{},internalActions:{onOnline:il,onOffline:sl,onFocus:nl,onFocusLost:al},util:{}});let{queryThunk:p,mutationThunk:g,patchQueryData:h,updateQueryData:y,upsertQueryData:m,prefetch:v,buildMatchThunkActions:S}=function({reducerPath:e,baseQuery:t,context:{endpointDefinitions:r},serializeQueryArgs:n,api:a,assertTagType:i}){let s=async(e,{signal:n,abort:a,rejectWithValue:i,fulfillWithValue:s,dispatch:c,getState:u,extra:l})=>{let d=r[e.endpointName];try{let r,i=fl,f={signal:n,abort:a,dispatch:c,getState:u,extra:l,endpoint:e.endpointName,type:e.type,forced:"query"===e.type?o(e,u()):void 0},p="query"===e.type?e[ll]:void 0;if(p?r=p():d.query?(r=await t(d.query(e.originalArgs),f,d.extraOptions),d.transformResponse&&(i=d.transformResponse)):r=await d.queryFn(e.originalArgs,f,d.extraOptions,(e=>t(e,f,d.extraOptions))),r.error)throw new Xu(r.error,r.meta);return s(await i(r.data,r.meta,e.originalArgs),{fulfilledTimeStamp:Date.now(),baseQueryMeta:r.meta,[yr]:!0})}catch(t){let r=t;if(r instanceof Xu){let t=fl;d.query&&d.transformErrorResponse&&(t=d.transformErrorResponse);try{return i(await t(r.value,r.meta,e.originalArgs),{baseQueryMeta:r.meta,[yr]:!0})}catch(e){r=e}}throw console.error(r),r}};function o(t,r){let n=r[e]?.queries?.[t.queryCacheKey],a=r[e]?.config.refetchOnMountOrArgChange,i=n?.fulfilledTimeStamp,s=t.forceRefetch??(t.subscribe&&a);return!!s&&(!0===s||(Number(new Date)-Number(i))/1e3>=s)}let c=Ur(`${e}/executeQuery`,s,{getPendingMeta:()=>({startedTimeStamp:Date.now(),[yr]:!0}),condition(t,{getState:n}){let a=n(),i=a[e]?.queries?.[t.queryCacheKey],s=i?.fulfilledTimeStamp,c=t.originalArgs,u=i?.originalArgs,l=r[t.endpointName];return!!dl(t)||"pending"!==i?.status&&(!!(o(t,a)||ol(l)&&l?.forceRefetch?.({currentArg:c,previousArg:u,endpointState:i,state:a}))||!s)},dispatchConditionRejection:!0}),u=Ur(`${e}/executeMutation`,s,{getPendingMeta:()=>({startedTimeStamp:Date.now(),[yr]:!0})});function l(e){return t=>t?.meta?.arg?.endpointName===e}return{queryThunk:c,mutationThunk:u,prefetch:(e,t,r)=>(n,i)=>{let s=(e=>"force"in e)(r)&&r.force,o=(e=>"ifOlderThan"in e)(r)&&r.ifOlderThan,c=(r=!0)=>{let n={forceRefetch:r,isPrefetch:!0};return a.endpoints[e].initiate(t,n)},u=a.endpoints[e].select(t)(i());if(s)n(c());else if(o){let e=u?.fulfilledTimeStamp;if(!e)return void n(c());(Number(new Date)-Number(new Date(e)))/1e3>=o&&n(c())}else n(c(!1))},updateQueryData:(e,t,r,n=!0)=>(i,s)=>{let o,c=a.endpoints[e].select(t)(s()),u={patches:[],inversePatches:[],undo:()=>i(a.util.patchQueryData(e,t,u.inversePatches,n))};if("uninitialized"===c.status)return u;if("data"in c)if(dt(c.data)){let[e,t,n]=Kt(c.data,r);u.patches.push(...t),u.inversePatches.push(...n),o=e}else o=r(c.data),u.patches.push({op:"replace",path:[],value:o}),u.inversePatches.push({op:"replace",path:[],value:c.data});return 0===u.patches.length||i(a.util.patchQueryData(e,t,u.patches,n)),u},upsertQueryData:(e,t,r)=>n=>n(a.endpoints[e].initiate(t,{subscribe:!1,forceRefetch:!0,[ll]:()=>({data:r})})),patchQueryData:(e,t,s,o)=>(c,u)=>{let l=r[e],d=n({queryArgs:t,endpointDefinition:l,endpointName:e});if(c(a.internalActions.queryResultPatched({queryCacheKey:d,patches:s})),!o)return;let f=a.endpoints[e].select(t)(u()),p=cl(l.providesTags,f.data,void 0,t,{},i);c(a.internalActions.updateProvidedBy({queryCacheKey:d,providedTags:p}))},buildMatchThunkActions:function(e,t){return{matchPending:xr(Or(e),l(t)),matchFulfilled:xr(Tr(e),l(t)),matchRejected:xr(Fr(e),l(t))}}}}({baseQuery:r,reducerPath:a,context:d,api:t,serializeQueryArgs:i,assertTagType:f}),{reducer:w,actions:b}=vl({context:d,queryThunk:p,mutationThunk:g,reducerPath:a,assertTagType:f,config:{refetchOnFocus:c,refetchOnReconnect:u,refetchOnMountOrArgChange:o,keepUnusedDataFor:s,reducerPath:a,invalidationBehavior:l}});kl(t.util,{patchQueryData:h,updateQueryData:y,upsertQueryData:m,prefetch:v,resetApiState:b.resetApiState}),kl(t.internalActions,b);let{middleware:C,actions:I}=Ml({reducerPath:a,context:d,queryThunk:p,mutationThunk:g,api:t,assertTagType:f});kl(t.util,I),kl(t,{reducer:w,middleware:C});let{buildQuerySelector:q,buildMutationSelector:k,selectInvalidatedBy:x,selectCachedArgsForQuery:A}=function({serializeQueryArgs:e,reducerPath:t,createSelector:r}){let n=e=>bl,a=e=>Cl;return{buildQuerySelector:function(t,a){return o=>{let c=e({queryArgs:o,endpointDefinition:a,endpointName:t});return r(o===Sl?n:e=>s(e)?.queries?.[c]??bl,i)}},buildMutationSelector:function(){return e=>{let t;return t="object"==typeof e?hl(e)??Sl:e,r(t===Sl?a:e=>s(e)?.mutations?.[t]??Cl,i)}},selectInvalidatedBy:function(e,r){let n=e[t],a=new Set;for(let e of r.map(ul)){let t=n.provided[e.type];if(!t)continue;let r=(void 0!==e.id?t[e.id]:Nu(Object.values(t)))??[];for(let e of r)a.add(e)}return Nu(Array.from(a.values()).map((e=>{let t=n.queries[e];return t?[{queryCacheKey:e,endpointName:t.endpointName,originalArgs:t.originalArgs}]:[]})))},selectCachedArgsForQuery:function(e,r){return Object.values(e[t].queries).filter((e=>e?.endpointName===r&&"uninitialized"!==e.status)).map((e=>e.originalArgs))}};function i(e){return{...e,...Uu(e.status)}}function s(e){return e[t]}}({serializeQueryArgs:i,reducerPath:a,createSelector:e});kl(t.util,{selectInvalidatedBy:x,selectCachedArgsForQuery:A});let{buildInitiateQuery:R,buildInitiateMutation:O,getRunningMutationThunk:F,getRunningMutationsThunk:E,getRunningQueriesThunk:T,getRunningQueryThunk:D}=function({serializeQueryArgs:e,queryThunk:t,mutationThunk:r,api:n,context:a}){let i=new Map,s=new Map,{unsubscribeQueryResult:o,removeMutationResult:c,updateSubscriptionOptions:u}=n.internalActions;return{buildInitiateQuery:function(r,a){let s=(c,{subscribe:l=!0,forceRefetch:d,subscriptionOptions:f,[ll]:p,...g}={})=>(h,y)=>{let m=e({queryArgs:c,endpointDefinition:a,endpointName:r}),v=t({...g,type:"query",subscribe:l,forceRefetch:d,subscriptionOptions:f,endpointName:r,originalArgs:c,queryCacheKey:m,[ll]:p}),S=n.endpoints[r].select(c),w=h(v),b=S(y()),{requestId:C,abort:I}=w,q=b.requestId!==C,k=i.get(h)?.[m],x=()=>S(y()),A=Object.assign(p?w.then(x):q&&!k?Promise.resolve(b):Promise.all([k,w]).then(x),{arg:c,requestId:C,subscriptionOptions:f,queryCacheKey:m,abort:I,async unwrap(){let e=await A;if(e.isError)throw e.error;return e.data},refetch:()=>h(s(c,{subscribe:!1,forceRefetch:!0})),unsubscribe(){l&&h(o({queryCacheKey:m,requestId:C}))},updateSubscriptionOptions(e){A.subscriptionOptions=e,h(u({endpointName:r,requestId:C,queryCacheKey:m,options:e}))}});if(!k&&!q&&!p){let e=i.get(h)||{};e[m]=A,i.set(h,e),A.then((()=>{delete e[m],Lu(e)||i.delete(h)}))}return A};return s},buildInitiateMutation:function(e){return(t,{track:n=!0,fixedCacheKey:a}={})=>(i,o)=>{let u=r({type:"mutation",endpointName:e,originalArgs:t,track:n,fixedCacheKey:a}),l=i(u),{requestId:d,abort:f,unwrap:p}=l,g=function(e,t){return e.catch(t)}(l.unwrap().then((e=>({data:e}))),(e=>({error:e}))),h=Object.assign(g,{arg:l.arg,requestId:d,abort:f,unwrap:p,reset:()=>{i(c({requestId:d,fixedCacheKey:a}))}}),y=s.get(i)||{};return s.set(i,y),y[d]=h,h.then((()=>{delete y[d],Lu(y)||s.delete(i)})),a&&(y[a]=h,h.then((()=>{y[a]===h&&(delete y[a],Lu(y)||s.delete(i))}))),h}},getRunningQueryThunk:function(t,r){return n=>{let s=a.endpointDefinitions[t],o=e({queryArgs:r,endpointDefinition:s,endpointName:t});return i.get(n)?.[o]}},getRunningMutationThunk:function(e,t){return e=>s.get(e)?.[t]},getRunningQueriesThunk:function(){return e=>Object.values(i.get(e)||{}).filter(Bu)},getRunningMutationsThunk:function(){return e=>Object.values(s.get(e)||{}).filter(Bu)}}}({queryThunk:p,mutationThunk:g,api:t,serializeQueryArgs:i,context:d});return kl(t.util,{getRunningMutationThunk:F,getRunningMutationsThunk:E,getRunningQueryThunk:D,getRunningQueriesThunk:T}),{name:Pl,injectEndpoint(e,r){var n;let a=t;(n=a.endpoints)[e]??(n[e]={}),ol(r)?kl(a.endpoints[e],{name:e,select:q(e,r),initiate:R(e,r)},S(p,e)):function(e){return"mutation"===e.type}(r)&&kl(a.endpoints[e],{name:e,select:k(),initiate:O(e)},S(g,e))}}}}))()),Vl=jl({reducerPath:"answer",baseQuery:rl((async(e,t,r)=>{let n=t.getState(),{accessToken:a,environment:i,organizationId:s}=n.configuration,o=n.generatedAnswer.answerConfigurationId,c={...e,headers:{...e?.headers||{},Authorization:`Bearer ${a}`}};try{return{data:Zu({baseUrl:`${ye(s,i)}/rest/organizations/${s}/answer/v1/configs/${o}`})(c,t,r)}}catch(e){return{error:e}}}),{maxRetries:3}),endpoints:()=>({})}),_l=(e,t,r)=>{let n=JSON.parse(e.data);"ERROR"===n.finishReason&&n.errorMessage&&((e,t)=>{e.error={message:t.errorMessage,code:t.code},e.isStreaming=!1,e.isLoading=!1,console.error(`${t.errorMessage} - code ${t.code}`)})(t,n);let a=n.payload.length?JSON.parse(n.payload):{};switch(n.payloadType){case"genqa.headerMessageType":a.contentFormat&&(((e,t)=>{let{contentFormat:r}=t;e.contentFormat=r,e.isStreaming=!0,e.isLoading=!1})(t,a),r(Eu(a.contentFormat)));break;case"genqa.messageType":a.textDelta&&(((e,t)=>{void 0===e.answer?e.answer=t.textDelta:"string"==typeof t.textDelta&&(e.answer=e.answer.concat(t.textDelta))})(t,a),r(mu({textDelta:a.textDelta})));break;case"genqa.citationsType":a.citations&&(((e,t)=>{e.citations=t.citations})(t,a),r(vu({citations:a.citations})));break;case"genqa.endOfStreamType":(t.answer?.length||a.answerGenerated)&&(((e,t)=>{e.generated=t.answerGenerated,e.isStreaming=!1})(t,a),r(cu(a.answerGenerated??!1)))}},Ul=Vl.injectEndpoints({overrideExisting:!0,endpoints:e=>({getAnswer:e.query({queryFn:()=>({data:{contentFormat:void 0,answer:void 0,citations:void 0,error:void 0,generated:!1,isStreaming:!0,isLoading:!0}}),async onCacheEntryAdded(e,{getState:t,cacheDataLoaded:r,updateCachedData:n,dispatch:a}){await r;let{configuration:i,generatedAnswer:s,insightConfiguration:o}=t(),{organizationId:c,environment:u,accessToken:l}=i,d=ye(c,u),f=`${d}/rest/organizations/${c}/insight/v1/configs/${o?.insightId}/answer/${s.answerConfigurationId}/generate`,p=`${d}/rest/organizations/${c}/answer/v1/configs/${s.answerConfigurationId}/generate`;await ae(o?f:p,{method:"POST",body:JSON.stringify(e),headers:{Authorization:`Bearer ${l}`,Accept:"application/json","Content-Type":"application/json","Accept-Encoding":"*"},fetch:fetch,onopen:async e=>{let t=e.headers.get("x-answer-id");t&&n((e=>{e.answerId=t}))},onmessage:e=>{n((t=>{_l(e,t,a)}))},onerror:e=>{throw e}})}})})}),Ql=ir((e=>ru(e)?.q),(e=>e.search.requestId),((e,t)=>({q:e,requestId:t}))),$l={},Ll=e=>e.pagination?e.pagination.firstResult+e.pagination.numberOfResults>5e3?5e3-e.pagination.firstResult:e.pagination.numberOfResults:void 0,Nl=(e,t)=>{let r=ru(e)?.q,n=_u(e),a=Vu(e),i=(e=>e.generatedAnswer?.fieldsToIncludeInCitations)(e)??[];return r&&"fetch"===t&&($l=((e,t)=>({...$l,[e]:hc(t)?.map((e=>No(e,{dateFacetValueMap:{}}))).sort(((e,t)=>e.facetId>t.facetId?1:t.facetId>e.facetId?-1:0))}))(r,e)),{q:r,pipelineRuleParameters:{mlGenerativeQuestionAnswering:{responseFormat:e.generatedAnswer.responseFormat,citationsFieldToInclude:i}},...n?.length&&{searchHub:n},...a?.length&&{pipeline:a},...$l[r]?.length&&{facets:$l[r]},...e.fields&&{fieldsToInclude:e.fields.fieldsToInclude},...e.didYouMean&&{queryCorrection:{enabled:e.didYouMean.enableDidYouMean&&"next"===e.didYouMean.queryCorrectionMode,options:{automaticallyCorrect:e.didYouMean.automaticallyCorrectQuery?"whenNoResults":"never"}},enableDidYouMean:e.didYouMean.enableDidYouMean&&"legacy"===e.didYouMean.queryCorrectionMode},...e.pagination&&{numberOfResults:Ll(e),firstResult:e.pagination.firstResult},tab:e.configuration.analytics.originLevel2}},Bl=e=>Ul.endpoints.getAnswer.initiate(Nl(e,"fetch")),zl=e=>Ul.endpoints.getAnswer.select(Nl(e,"select"))(e),Hl=Ir(fn,(e=>e));function Yl(){return typeof window<"u"&&typeof document<"u"}function Wl(e){return"type"in e}var Gl=e=>t=>r=>{let n;(function(e){let t=e.payload?.analyticsAction;return Wl(e)&&!c(t)})(r)&&(n=r.payload.analyticsAction,delete r.payload.analyticsAction);let a=t(r);return Wl(r)&&("search/executeSearch/fullfilled"===r.type&&void 0===n&&console.error("No analytics action associated with search:",r),"recommendation/get/fullfilled"===r.type&&void 0===n&&console.error("No analytics action associated with recommendation:",r),"productRecommendations/get/fullfilled"===r.type&&void 0===n&&console.error("No analytics action associated with product recommendation:",r)),void 0!==n&&e.dispatch(n),a},Kl=q(_(),1),Jl=dr("tab/register",(e=>{let t=new r({values:{id:_e,expression:Qe}});return He(e,t)})),Zl=dr("tab/updateActiveTab",(e=>He(e,_e))),Xl=q(P(),1),ed=q(U(),1),td=q(Q(),1);Xl.default.extend(td.default),Xl.default.extend(ed.default);var rd=()=>({organizationId:"",accessToken:"",search:{locale:"en-US",timezone:Xl.default.tz.guess(),authenticationProviders:[]},analytics:{enabled:!0,originContext:"Search",originLevel2:"default",originLevel3:"default",anonymous:!1,deviceId:"",userDisplayName:"",documentLocation:"",trackingId:"",analyticsMode:"next",source:{}},knowledge:{answerConfigurationId:""},environment:"prod"}),nd=Ir(rd(),(e=>e.addCase(xs,((e,t)=>{!function(e,t){c(t.accessToken)||(e.accessToken=t.accessToken),e.environment=t.environment??"prod",c(t.organizationId)||(e.organizationId=t.organizationId)}(e,t.payload)})).addCase(As,((e,t)=>{!function(e,t){c(t.proxyBaseUrl)||(e.search.apiBaseUrl=t.proxyBaseUrl),c(t.locale)||(e.search.locale=t.locale),c(t.timezone)||(e.search.timezone=t.timezone),c(t.authenticationProviders)||(e.search.authenticationProviders=t.authenticationProviders)}(e,t.payload)})).addCase(Os,((e,t)=>{!function(e,t){c(t.enabled)||(e.analytics.enabled=t.enabled),c(t.originContext)||(e.analytics.originContext=t.originContext),c(t.originLevel2)||(e.analytics.originLevel2=t.originLevel2),c(t.originLevel3)||(e.analytics.originLevel3=t.originLevel3),c(t.proxyBaseUrl)||(e.analytics.apiBaseUrl=t.proxyBaseUrl),c(t.trackingId)||(e.analytics.trackingId=t.trackingId),c(t.analyticsMode)||(e.analytics.analyticsMode=t.analyticsMode),c(t.source)||(e.analytics.source=t.source);let r=(0,Kl.default)();r&&(e.analytics.analyticsMode="next",e.analytics.trackingId=r),c(t.runtimeEnvironment)||(e.analytics.runtimeEnvironment=t.runtimeEnvironment),c(t.anonymous)||(e.analytics.anonymous=t.anonymous),c(t.deviceId)||(e.analytics.deviceId=t.deviceId),c(t.userDisplayName)||(e.analytics.userDisplayName=t.userDisplayName),c(t.documentLocation)||(e.analytics.documentLocation=t.documentLocation)}(e,t.payload)})).addCase(Fs,(e=>{e.analytics.enabled=!1})).addCase(Es,(e=>{e.analytics.enabled=!0})).addCase(Ts,((e,t)=>{e.analytics.originLevel2=t.payload.originLevel2})).addCase(Ds,((e,t)=>{e.analytics.originLevel3=t.payload.originLevel3})).addCase(Zl,((e,t)=>{e.analytics.originLevel2=t.payload})).addCase(Ps,((e,t)=>{e.analytics.originLevel2=t.payload.tab||e.analytics.originLevel2}))));var ad=nd;var id=()=>e=>t=>e(function(e){return e.instantlyCallable}(t)?t():t),sd=e=>()=>t=>r=>{let n=r;if(!n.error)return t(r);let a=n.error,i=[n.payload?.errorCode,n.payload?.message].filter(Boolean).join(" - ");return n.payload?.ignored||e.error(i||a.stack||a.message||a.name||"Error",`Action dispatch error ${n.type}`,r),"SchemaValidationError"!==n.error.name?t(r):void 0},od=e=>t=>r=>n=>(e.debug({action:n,nextState:t.getState()},`Action dispatched: ${n.type}`),r(n)),cd=e=>({referrer:document.referrer,userAgent:navigator.userAgent,location:window.location.href,clientId:e}),ud=()=>({referrer:null,userAgent:null,location:null,clientId:""});function ld(e,t){let r,n={...e};return{get combinedReducer(){let e=function(e){let t={};for(let[r,n]of e)t[r]=n;return t}(Object.entries(t).filter((([e])=>!(e in n))).map((([e,t])=>[e,()=>t])));return(e=>(t,n)=>{let a=e(t,n);return r?r(a,n):a})(rt({...e,...n}))},containsAll:e=>Object.keys(e).every((e=>e in n)),add(e){Object.keys(e).filter((e=>!(e in n))).forEach((t=>n[t]=e[t]))},addCrossReducer(e){r=e}}}function dd(e,t,r){var n,a,i;void 0===t&&(t=50),void 0===r&&(r={});var s=null!=(n=r.isImmediate)&&n,o=null!=(a=r.callback)&&a,c=r.maxWait,u=Date.now(),l=[];var d=function(){var r=[].slice.call(arguments),n=this;return new Promise((function(a,d){var f=s&&void 0===i;if(void 0!==i&&clearTimeout(i),i=setTimeout((function(){if(i=void 0,u=Date.now(),!s){var t=e.apply(n,r);o&&o(t),l.forEach((function(e){return(0,e.resolve)(t)})),l=[]}}),function(){if(void 0!==c){var e=Date.now()-u;if(e+t>=c)return c-e}return t}()),f){var p=e.apply(n,r);return o&&o(p),a(p)}l.push({resolve:a,reject:d})}))};return d.cancel=function(e){void 0!==i&&clearTimeout(i),l.forEach((function(t){return(0,t.reject)(e)})),l=[]},d}function fd(e,t){let r=0,n=dd((()=>r=0),500);return a=>i=>async s=>{if("function"!=typeof s)return i(s);let o=await i(s);if(!function(e){return e?.error?.name===(new de).name}(o))return o;if("function"!=typeof t)return e.warn("Unable to renew the expired token because a renew function was not provided. Please specify the #renewAccessToken option when initializing the engine."),o;if(r>=5)return e.warn("Attempted to renew the token but was not successful. Please check the #renewAccessToken function."),o;r++,n();let c=await async function(e){try{return await e()}catch{return""}}(t);a.dispatch(xs({accessToken:c})),a.dispatch(s)}}function pd(e,t){let{analytics:r}=e,{analyticsClientMiddleware:n,...a}=r??{},i={...a,...r?.proxyBaseUrl&&{apiBaseUrl:r.proxyBaseUrl,nexApiBaseUrl:r.proxyBaseUrl}};if("next"!==i.analyticsMode&&function(){if(typeof navigator>"u"||typeof window>"u")return!1;let e=navigator,t=window;return[e.globalPrivacyControl,e.doNotTrack,e.msDoNotTrack,t.doNotTrack].some((e=>G.has(e)))}())return t.info("Analytics disabled since doNotTrack is active."),{...i,enabled:!1};if("next"===i.analyticsMode&&!a.trackingId)throw new hd('analytics.trackingId is required when analytics.analyticsMode="next"');return i}function gd(e,t){let r={...e.reducers,configuration:ad,version:Hl},n=function(e,t,r){let{reducers:n}=e,a=ld({...n,configurationReducer:r},e.preloadedState??{});e.crossReducer&&a.addCrossReducer(e.crossReducer);let i=t.logger,s=()=>{let e="";try{e=gn(u.state).getMeta("").clientId}catch(e){i.warn("Error while obtaining clientID from relay",e)}return e},o={...t,get relay(){return gn(u.state)},get navigatorContext(){return e.navigatorContextProvider?e.navigatorContextProvider():Yl()?cd(s()):ud()}},c=function(e,t,r){let{preloadedState:n,configuration:a}=e,i=a.name||"coveo-headless",s=function(e,t){let{renewAccessToken:r}=e.configuration,n=fd(t,r);return[id,n,sd(t),Gl].concat(Ul.middleware,e.middlewares||[])}(e,t.logger);return function({reducer:e,preloadedState:t,middlewares:r=[],thunkExtraArguments:n,name:a}){return br({reducer:e,preloadedState:t,devTools:{stateSanitizer:e=>e.history?{...e,history:"<<OMIT>>"}:e,name:a,shouldHotReload:!1},middleware:e=>e({thunk:{extraArgument:n}}).prepend(...r).concat(od(n.logger))})}({preloadedState:n,reducer:r.combinedReducer,middlewares:s,thunkExtraArguments:t,name:i})}(e,o,a),u={addReducers(e){a.containsAll(e)||(a.add(e),c.replaceReducer(a.combinedReducer))},dispatch:c.dispatch,subscribe:c.subscribe,enableAnalytics(){c.dispatch(Es())},disableAnalytics(){c.dispatch(Fs())},get state(){return c.getState()},get relay(){return gn(this.state)},get navigatorContext(){return e.navigatorContextProvider?e.navigatorContextProvider():Yl()?cd(s()):ud()},logger:i,store:c};return u}({...e,reducers:r},t,ad),{accessToken:a,environment:i,organizationId:s}=e.configuration;n.dispatch(xs({accessToken:a,environment:i,organizationId:s}));let o=pd(e.configuration,n.logger);return o&&n.dispatch(Os(o)),n}var hd=class extends Error{constructor(e){super(e),this.name="InvalidEngineConfiguration"}},yd=q(L(),1);function md(e,t){let r=function(e){let{analytics:t}=e,r=(e,t)=>t;return t?.analyticsClientMiddleware||r}(e),n=ze,a=function(e){return e.preprocessRequest||Se}(e);return{analyticsClientMiddleware:r,validatePayload:n,preprocessRequest:a,logger:t}}var vd=(e,t,r,n,a,i)=>{let s=e[t];c(s)||c(a)||a!==s&&a!==n&&(i.warn(`Mismatch on access token (JWT Token) ${t} and engine configuration.`),i.warn(`To remove this warning, make sure that access token value [${s}] matches engine configuration value [${r}]`))},Sd=(e,t)=>!(c(e)||t===e),wd=e=>{try{let t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=atob(t);if(!r)return!1;let n=decodeURIComponent(r.split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join(""));return JSON.parse(n)}catch{return!1}},bd=(e,t)=>(Sd(e.searchHub,t.searchHub)&&(t.searchHub=e.searchHub),t),Cd=(e,t,r,n)=>(vd(e,"searchHub",t.searchHub,ni(),r,n),bd(e,t)),Id=(e,t)=>(Sd(e.pipeline,t.pipeline)&&(t.pipeline=e.pipeline),t),qd=(e,t,r,n)=>(vd(e,"pipeline",t.pipeline,es(),r,n),Id(e,t)),kd=(e,t)=>(Sd(e.userDisplayName,t.configuration.analytics.userDisplayName)&&(t.configuration.analytics.userDisplayName=e.userDisplayName),t),xd=e=>Ir({},(t=>{t.addCase(Ws,((t,r)=>{let n=wd(t.configuration.accessToken);return n?Cd(n,t,r.payload,e):t})).addCase(Hs,((t,r)=>{let n=wd(t.configuration.accessToken);return n?qd(n,t,r.payload,e):t})).addCase(xs,((e,t)=>{if(e.configuration.accessToken!==t.payload.accessToken)return e;let{accessToken:r}=t.payload;if(!r)return e;let n=wd(r);return n?[Id,bd,kd].reduce(((e,t)=>t(n,e)),e):e})).addCase(As,((t,r)=>{let n=wd(t.configuration.accessToken);if(!n)return t;let a=Cd(n,t,r.payload.searchHub,e);return qd(n,a,r.payload?.pipeline,e)})).addCase(Os,((t,r)=>{let n=wd(t.configuration.accessToken);return n?((e,t,r,n)=>(vd(e,"userDisplayName",t.configuration.analytics.userDisplayName,rd().analytics.userDisplayName,r,n),kd(e,t)))(n,t,r.payload.userDisplayName,e):t}))})),Ad={organizationId:_e,accessToken:_e,name:new e({required:!1,emptyAllowed:!1}),analytics:new r({options:{required:!1},values:{enabled:new a({required:!1}),originContext:new e({required:!1}),originLevel2:new e({required:!1}),originLevel3:new e({required:!1}),analyticsMode:new e({constrainTo:["legacy","next"],required:!1,default:"next"}),proxyBaseUrl:new e({required:!1,url:!0})}}),environment:new e({required:!1,default:"prod",constrainTo:["prod","hipaa","stg","dev"]})};var Rd=new o({...Ad,search:new r({options:{required:!1},values:{pipeline:new e({required:!1,emptyAllowed:!0}),searchHub:Ue,locale:Ue,timezone:Ue,authenticationProviders:new t({required:!1,each:_e}),proxyBaseUrl:new e({required:!1,url:!0})}})});function Od(){return{organizationId:"searchuisamples",accessToken:"xx564559b1-0045-48e1-953c-3addd1ee4457",search:{searchHub:"default"}}}var Fd={debug:Us,pipeline:Ys,searchHub:Gs,search:tu};function Ed(e){let t=function(e){return(0,yd.pino)({name:"@coveo/headless",level:e?.level||"warn",formatters:{log:e?.logFormatter}})}(e.loggerOptions),{configuration:r}=e;!function(e,t){try{Rd.validate(e)}catch(e){throw t.error(e,"Search engine configuration error"),e}}(r,t);let n=function(e,t){let{search:r}=e;return new De({logger:t,preprocessRequest:e.preprocessRequest||Se,postprocessSearchResponseMiddleware:r?.preprocessSearchResponseMiddleware||we,postprocessFacetSearchResponseMiddleware:r?.preprocessFacetSearchResponseMiddleware||be,postprocessQuerySuggestResponseMiddleware:r?.preprocessQuerySuggestResponseMiddleware||Ce})}(r,t),a=function(e){return new ue({logger:e})}(t),i={...md(r,t),apiClient:n,streamingClient:a},s=gd({...e,reducers:Fd,crossReducer:xd(t)},i),o=function(e){let{search:t,organizationId:r,environment:n}=e,a=t?.proxyBaseUrl?t.proxyBaseUrl:me(r,n);return{...t,apiBaseUrl:a}}(r);return o&&s.dispatch(As(o)),{...s,get state(){return s.state},executeFirstSearch(e=Ss()){if(Jc(s.state))return;let t=_c({legacy:e,next:{actionCause:"interfaceLoad"}});s.dispatch(t)},executeFirstSearchAfterStandaloneSearchBoxRedirect(e){let{cause:t,metadata:r}=e;if(Jc(s.state))return;let n=r&&"omniboxFromLink"===t,a=_c({legacy:n?Cs(r):bs(),next:n?{actionCause:"omniboxFromLink"}:{actionCause:"searchFromLink"}});s.dispatch(a)}}}function Td(e){let t,r=new Map,n=()=>0===r.size;return{subscribe(a){a();let i,s=Symbol();return n()&&(t=JSON.stringify(this.state),i=e.subscribe((()=>{(e=>{try{let r=JSON.stringify(e),n=t!==r;return t=r,n}catch(e){return console.warn('Could not detect if state has changed, check the controller "get state method"',e),!0}})(this.state)&&r.forEach((e=>e()))}))),r.set(s,a),()=>{r.delete(s),n()&&i&&i()}},get state(){return{}}}}var Dd=e=>{if(!e)return null;let t=/Document weights:\n((?:.)*?)\n+/g.exec(e),r=/Terms weights:\n((?:.|\n)*)\n+/g.exec(e),n=/Total weight: ([0-9]+)/g.exec(e),a=Vd(e);return{documentWeights:Md(t?t[1]:null),termsWeight:jd(r),totalWeight:n?Number(n[1]):null,qreWeights:a}},Md=e=>{let t=/^(\w+(?:\s\w+)*): ([-0-9]+)$/;if(!e)return null;let r=e.match(/(\w+(?:\s\w+)*): ([-0-9]+)/g);if(!r)return null;let n={};for(let e of r){let r=e.match(t);if(r){let e=r[1],t=r[2];n[e]=Number(t)}}return n},Pd=(e,t)=>{let r,n=[];for(;null!==(r=t.exec(e));)n.push(r);return n},jd=e=>{let t=/([^:]+): ([0-9]+), ([0-9]+); /g;if(!e||!e[1])return null;let r=Pd(e[1],/((?:[^:]+: [0-9]+, [0-9]+; )+)\n((?:\w+: [0-9]+; )+)/g);if(!r)return null;let n={};for(let e of r){let r=Pd(e[1],t),a={};for(let e of r)a[e[1]]={Correlation:Number(e[2]),"TF-IDF":Number(e[3])};let i=Md(e[2]);n[Object.keys(a).join(", ")]={terms:a,Weights:i}}return n},Vd=e=>{let t=/(Expression:\s".*")\sScore:\s(?!0)([-0-9]+)\n+/g,r=t.exec(e),n=[];for(;r;)n.push({expression:r[1],score:parseInt(r[2],10)}),r=t.exec(e);return n};function _d(e){return e.search.response.results.map((e=>({result:e,ranking:Dd(e.rankingInfo)})))}var Ud=dr("fields/registerFieldsToInclude",(e=>He(e,Le))),Qd=dr("fields/fetchall/enable"),$d=dr("fields/fetchall/disable"),Ld=Ur("fields/fetchDescription",(async(e,{extra:t,getState:r,rejectWithValue:n})=>{let a=r(),{accessToken:i,environment:s,organizationId:o}=a.configuration,{apiBaseUrl:c}=a.configuration.search,u=await t.apiClient.fieldDescriptions({accessToken:i,organizationId:o,url:c??me(o,s)});return Pe(u)?n(u.error):u.success.fields})),Nd={collectionField:new e({emptyAllowed:!1,required:!1}),parentField:new e({emptyAllowed:!1,required:!1}),childField:new e({emptyAllowed:!1,required:!1}),numberOfFoldedResults:new s({min:0,required:!1})},Bd=dr("folding/register",(e=>He(e,Nd))),zd=Ur("folding/loadCollection",(async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,navigatorContext:a}})=>{let i=t(),s="legacy"===i.configuration.analytics.analyticsMode?await mo(i):ho(i,a),o=await n.search({...s,q:Hd(i),enableQuerySyntax:!0,cq:`@${i.folding.fields.collection}="${e}"`,filterField:i.folding.fields.collection,childField:i.folding.fields.parent,parentField:i.folding.fields.child,filterFieldRange:100},{origin:"foldingCollection"});return Pe(o)?r(o.error):{collectionId:e,results:o.success.results,searchUid:o.success.searchUid,rootResult:i.folding.collections[e].result}}));function Hd(e){return""===e.query.q?"":e.query.enableQuerySyntax?`${e.query.q} OR @uri`:`( <@- ${e.query.q} -@> ) OR @uri`}var Yd=["author","language","urihash","objecttype","collection","source","permanentid"],Wd=[...Yd,"date","filetype","parents"],Gd=[...Wd,"ec_price","ec_name","ec_description","ec_brand","ec_category","ec_item_group_id","ec_shortdesc","ec_thumbnails","ec_images","ec_promo_price","ec_in_stock","ec_rating"],Kd=Ir({fieldsToInclude:Yd,fetchAllFields:!1,fieldsDescription:[]},(e=>e.addCase(Ud,((e,t)=>{e.fieldsToInclude=[...new Set(e.fieldsToInclude.concat(t.payload))]})).addCase(Qd,(e=>{e.fetchAllFields=!0})).addCase($d,(e=>{e.fetchAllFields=!1})).addCase(Ld.fulfilled,((e,{payload:t})=>{e.fieldsDescription=t})).addCase(Bd,((e,{payload:t})=>{let r={collection:"foldingcollection",parent:"foldingparent",child:"foldingchild"};e.fieldsToInclude.push(t.collectionField??r.collection,t.parentField??r.parent,t.childField??r.child)})))),Jd=new o({enabled:new a({default:!1})});function Zd(e,t={}){!function(e){e.addReducers({debug:Us,search:tu,configuration:ad,fields:Kd})}(e);let r=Td(e),{dispatch:n}=e;Ye(e,Jd,t.initialState,"buildRelevanceInspector").enabled&&n(js());let a=t=>{e.logger.warn(`Flag [ ${t} ] is now activated. This should *not* be used in any production environment as it negatively impact performance.`)};return{...r,get state(){let t=e.state,r=t.debug;if(!t.debug)return{isEnabled:r};let{executionReport:n,basicExpression:a,advancedExpression:i,constantExpression:s,userIdentities:o,rankingExpressions:c}=t.search.response,{fieldsDescription:u,fetchAllFields:l}=t.fields;return{isEnabled:r,rankingInformation:_d(t),executionReport:n,expressions:{basicExpression:a,advancedExpression:i,constantExpression:s},userIdentities:o,rankingExpressions:c,fieldsDescription:u,fetchAllFields:l}},enable(){n(js()),a("debug")},disable(){n(Vs()),n($d())},enableFetchAllFields(){n(Qd()),a("fetchAllFields")},disableFetchAllFields(){n($d())},fetchFieldsDescription(){!this.state.isEnabled&&n(js()),n(Ld()),a("fieldsDescription"),e.logger.warn("For production environment, please specify the necessary fields either when instantiating a ResultList controller, or by dispatching a registerFieldsToInclude action.\n        \n        https://docs.coveo.com/en/headless/latest/reference/search/controllers/result-list/#resultlistoptions\n        https://docs.coveo.com/en/headless/latest/reference/search/actions/field/#registerfieldstoinclude")}}}var Xd=new t({each:_e,required:!0}),ef=(e,t)=>(He(e,_e),l(t)?He(t,_e):He(t,Xd),{payload:{contextKey:e,contextValue:t}}),tf=dr("context/set",(e=>{for(let[t,r]of Object.entries(e))ef(t,r);return{payload:e}})),rf=dr("context/add",(e=>ef(e.contextKey,e.contextValue))),nf=dr("context/remove",(e=>He(e,_e))),af=Ir({contextValues:{}},(e=>{e.addCase(tf,((e,t)=>{e.contextValues=t.payload})).addCase(rf,((e,t)=>{e.contextValues[t.payload.contextKey]=t.payload.contextValue})).addCase(nf,((e,t)=>{delete e.contextValues[t.payload]})).addCase(zs.fulfilled,((e,t)=>{t.payload&&(e.contextValues=t.payload.context.contextValues)}))})),sf=["caseId","caseNumber"],of={caseId:"caseContext",caseNumber:"caseContext"},cf=class extends Error{constructor(e){super(`The key "${e}" is reserved for internal use. Use ${of[e]} to set this value.}`)}};function uf(e){return sf.includes(e)}var lf=new o({values:new r({options:{required:!1}})});function df(e,t={}){!function(e){e.addReducers({context:af})}(e);let r=Td(e),{dispatch:n}=e,a=()=>e.state,i=Ye(e,lf,t.initialState,"buildContext");return i.values&&n(tf(i.values)),{...r,get state(){return{values:a().context.contextValues}},set(e){n(tf(e))},..."legacy"===a().configuration.analytics.analyticsMode?ff(n):pf(n)}}var ff=e=>({add(t,r){e(rf({contextKey:t,contextValue:r}))},remove(t){e(nf(t))}}),pf=e=>({add(t,r){if(uf(t))throw new cf(t);e(rf({contextKey:t,contextValue:r}))},remove(t){if(uf(t))throw new cf(t);e(nf(t))}});function gf(e,t){return df(e,t)}var hf=dr("dictionaryFieldContext/set",(e=>{let n=new r({options:{required:!0}}),a=He(e,n).error;if(a)return{payload:e,error:a};let i=Object.values(e),s=new t({each:Qe}),o=He(i,s).error;return o?{payload:e,error:o}:{payload:e}})),yf=dr("dictionaryFieldContext/add",(e=>{let t=new r({options:{required:!0},values:{field:Qe,key:Qe}});return He(e,t)})),mf=dr("dictionaryFieldContext/remove",(e=>He(e,Qe))),vf=Ir({contextValues:{}},(e=>{e.addCase(hf,((e,t)=>{e.contextValues=t.payload})).addCase(yf,((e,t)=>{let{field:r,key:n}=t.payload;e.contextValues[r]=n})).addCase(mf,((e,t)=>{delete e.contextValues[t.payload]})).addCase(zs.fulfilled,((e,t)=>{t.payload&&(e.contextValues=t.payload.dictionaryFieldContext.contextValues)}))}));function Sf(e){!function(e){e.addReducers({dictionaryFieldContext:vf})}(e);let t=Td(e),{dispatch:r}=e;return{...t,get state(){return{values:e.state.dictionaryFieldContext.contextValues}},set(e){r(hf(e))},add(e,t){r(yf({field:e,key:t}))},remove(e){r(mf(e))}}}var wf=ir((e=>""!==e.queryCorrection.correctedQuery||""!==e.wasCorrectedTo),(e=>e));var bf=Ir({enableDidYouMean:!1,wasCorrectedTo:"",wasAutomaticallyCorrected:!1,queryCorrection:{correctedQuery:"",wordCorrections:[],originalQuery:""},originalQuery:"",automaticallyCorrectQuery:!0,queryCorrectionMode:"legacy"},(e=>{e.addCase(Yo,(e=>{e.enableDidYouMean=!0})).addCase(Wo,(e=>{e.enableDidYouMean=!1})).addCase(Ko,(e=>{e.automaticallyCorrectQuery=!0})).addCase(Go,(e=>{e.automaticallyCorrectQuery=!1})).addCase(_c.pending,(e=>{e.queryCorrection={correctedQuery:"",wordCorrections:[],originalQuery:""},e.wasAutomaticallyCorrected=!1,e.wasCorrectedTo=""})).addCase(_c.fulfilled,((e,t)=>{let{queryCorrection:r,queryCorrections:n}=t.payload.response;if("legacy"===e.queryCorrectionMode){let t=n&&n[0]?n[0]:{correctedQuery:"",wordCorrections:[],originalQuery:""};e.queryCorrection=t}"next"===e.queryCorrectionMode&&((e,t)=>{let r={correctedQuery:"",corrections:[],originalQuery:"",...t,correctedQuery:t?.correctedQuery||t?.corrections[0]?.correctedQuery||""};e.queryCorrection=r,e.wasCorrectedTo=r.correctedQuery})(e,r),e.wasAutomaticallyCorrected=t.payload.automaticallyCorrected,e.originalQuery=t.payload.originalQuery})).addCase(Jo,((e,t)=>{e.wasCorrectedTo=t.payload})).addCase(Zo,((e,t)=>{e.queryCorrectionMode=t.payload}))}));function Cf(e,t={}){!function(e){e.addReducers({configuration:ad,didYouMean:bf})}(e);let r=Td(e),{dispatch:n}=e;n(Yo()),!1===t.options?.automaticallyCorrectQuery&&n(Go()),n(Zo(t.options?.queryCorrectionMode||"next"));let a=()=>e.state;return{...r,get state(){let e=a();return{originalQuery:e.didYouMean.originalQuery,wasCorrectedTo:e.didYouMean.wasCorrectedTo,wasAutomaticallyCorrected:e.didYouMean.wasAutomaticallyCorrected,queryCorrection:e.didYouMean.queryCorrection,hasQueryCorrection:wf(a().didYouMean)}},applyCorrection(){n(Jo(this.state.queryCorrection.correctedQuery))},updateQueryCorrectionMode(e){n(Zo(e))}}}function If(e,t={}){let r=Cf(e,t),{dispatch:n}=e;return{...r,get state(){return r.state},applyCorrection(){r.applyCorrection(),n(_c({legacy:Xo(),next:{actionCause:"didYouMeanClick"}}))}}}var qf=_e,kf=dr("facetOptions/update",((e={freezeFacetOrder:!0})=>He(e,{freezeFacetOrder:new a({required:!1})}))),xf=dr("facetOptions/facet/enable",(e=>He(e,qf))),Af=dr("facetOptions/facet/disable",(e=>He(e,qf))),Rf={facetId:qf,captions:new r({options:{required:!1}}),numberOfValues:new s({required:!1,min:1}),query:new e({required:!1,emptyAllowed:!0})},Of={path:new t({required:!0,each:_e}),displayValue:Qe,rawValue:Qe,count:new s({required:!0,min:0})},Ff=dr("categoryFacet/selectSearchResult",(e=>He(e,{facetId:qf,value:new r({values:Of})}))),Ef=dr("categoryFacetSearch/register",(e=>He(e,Rf)));function Tf(e,t){let{facetId:r,criterion:n}=t,a=e[r]?.request;a&&(a.sortCriteria=n)}function Df(e){e&&(e.currentValues=e.currentValues.map((e=>({...e,state:"idle"}))),e.preventAutoSelect=!0)}function Mf(e,t){e&&(e.numberOfValues=t)}function Pf(e,t){let r=e[t];r&&(r.request.numberOfValues=r.initialNumberOfValues,r.request.currentValues=[],r.request.preventAutoSelect=!0)}function jf(e,t,r){e.currentValues=function(e,t){if(!e.length)return[];let r=Vf(e[0],t),n=r;for(let r of e.splice(1)){let e=Vf(r,t);n.children.push(e),n=e}return n.state="selected",n.retrieveChildren=!0,[r]}(t,r),e.numberOfValues=t.length?1:r,e.preventAutoSelect=!0}function Vf(e,t){return{value:e,retrieveCount:t,children:[],state:"idle",retrieveChildren:!1}}var _f={state:new i({required:!0}),numberOfResults:new s({required:!0,min:0}),value:new e({required:!0,emptyAllowed:!0}),path:new t({required:!0,each:_e}),moreValuesAvailable:new a({required:!1})};function Uf(e){e.children.forEach((e=>{Uf(e)})),ze({state:e.state,numberOfResults:e.numberOfResults,value:e.value,path:e.path,moreValuesAvailable:e.moreValuesAvailable},_f)}var Qf={facetId:qf,field:_e,tabs:new r({options:{required:!1},values:{included:new t({each:new e}),excluded:new t({each:new e})}}),activeTab:new e({required:!1}),delimitingCharacter:new e({required:!1,emptyAllowed:!0}),filterFacetCount:new a({required:!1}),injectionDepth:new s({required:!1,min:0}),numberOfValues:new s({required:!1,min:1}),sortCriteria:new i({required:!1}),basePath:new t({required:!1,each:_e}),filterByBasePath:new a({required:!1})},$f=dr("categoryFacet/register",(e=>He(e,Qf))),Lf=dr("categoryFacet/toggleSelectValue",(e=>{try{return ze(e.facetId,_e),Uf(e.selection),{payload:e,error:null}}catch(t){return{payload:e,error:Be(t)}}})),Nf=dr("categoryFacet/deselectAll",(e=>He(e,Qf.facetId))),Bf=dr("categoryFacet/updateNumberOfValues",(e=>He(e,{facetId:Qf.facetId,numberOfValues:Qf.numberOfValues}))),zf=dr("categoryFacet/updateSortCriterion",(e=>He(e,{facetId:Qf.facetId,criterion:new i}))),Hf=dr("categoryFacet/updateBasePath",(e=>He(e,{facetId:Qf.facetId,basePath:new t({each:_e})}))),Yf=Ir({},(e=>{e.addCase($f,((e,t)=>{let r=t.payload,{facetId:n}=r;if(n in e)return;let a=function(e){return{...Wf,currentValues:[],preventAutoSelect:!1,type:"hierarchical",...e}}(r),i=a.numberOfValues;e[n]={request:a,initialNumberOfValues:i}})).addCase(zs.fulfilled,((e,t)=>t.payload?.categoryFacetSet??e)).addCase(Ps,((e,t)=>{let r=t.payload.cf||{};Object.keys(e).forEach((t=>{let n=e[t].request,a=r[t]||[];(a.length||n.currentValues.length)&&jf(n,a,e[t].initialNumberOfValues)}))})).addCase(zf,((e,t)=>{let{facetId:r,criterion:n}=t.payload,a=e[r]?.request;a&&(a.sortCriteria=n)})).addCase(Hf,((e,t)=>{let{facetId:r,basePath:n}=t.payload,a=e[r]?.request;a&&(a.basePath=[...n])})).addCase(Lf,((e,t)=>{let{facetId:r,selection:n,retrieveCount:a}=t.payload,i=e[r]?.request;if(!i)return;let{path:s}=n,o=function(e,t,r){let n=e.currentValues;for(let e of t){let t=n[0];(!t||e!==t.value)&&(t=Gf(e,r),n.length=0,n.push(t)),t.retrieveChildren=!1,t.state="idle",n=t.children}return n}(i,s.slice(0,s.length-1),a);if(o.length){let e=o[0];return e.retrieveChildren=!0,e.state="selected",void(e.children=[])}let c=Gf(n.value,a);c.state="selected",o.push(c),i.numberOfValues=1})).addCase(Nf,((e,t)=>{Pf(e,t.payload)})).addCase(Ks,(e=>{Object.keys(e).forEach((t=>Pf(e,t)))})).addCase(Zs,((e,t)=>Object.keys(e).forEach((r=>{e[r].request.preventAutoSelect=!t.payload.allow})))).addCase(Bf,((e,t)=>{let{facetId:r,numberOfValues:n}=t.payload,a=e[r]?.request;if(a){if(!a.currentValues.length)return Mf(a,n);!function(e,t){let{facetId:r,numberOfValues:n}=t,a=e[r]?.request.currentValues[0];if(a){for(;a.children.length&&"selected"!==a?.state;)a=a.children[0];a.retrieveCount=n}}(e,t.payload)}})).addCase(Ff,((e,t)=>{let{facetId:r,value:n}=t.payload,a=e[r];if(!a)return;let i=[...n.path,n.rawValue];jf(a.request,i,a.initialNumberOfValues)})).addCase($c.fulfilled,((e,t)=>{Kf(e,t.payload.response.facets)})).addCase(_c.fulfilled,((e,t)=>{Kf(e,t.payload.response.facets)})).addCase(Af,((e,t)=>{Pf(e,t.payload)}))})),Wf={delimitingCharacter:";",filterFacetCount:!0,injectionDepth:1e3,numberOfValues:5,sortCriteria:"occurrences",basePath:[],filterByBasePath:!0,resultsMustMatch:"atLeastOneValue"};function Gf(e,t){return{value:e,state:"idle",children:[],retrieveChildren:!0,retrieveCount:t}}function Kf(e,t){t.forEach((t=>{if(!function(e,t){return t.facetId in e}(e,t))return;let r=t.facetId,n=e[r]?.request;if(!n)return;let a=function(e,t){let r=gi(e.currentValues),n=gi(t.values);return r.length!==n.length}(n,t);n.currentValues=a?[]:n.currentValues,n.preventAutoSelect=!1}))}var Jf=e=>void 0!==e.error;function Zf(e,t="prod"){return`${ye(e,t)}/rest/organizations/${e}/commerce/v2`}var Xf=e=>function(e,t){let r=e.reduce(((e,r)=>{let{productId:n,quantity:a}=t[r];return n in e||(e[n]={productId:n,quantity:0}),e[n].quantity+=a,e}),{});return[...Object.values(r)]}(e.cartItems,e.cart);var ep=(e=>(e.Relevance="relevance",e.Fields="fields",e))(ep||{}),tp=(e=>(e.Ascending="asc",e.Descending="desc",e))(tp||{});new r({options:{required:!1},values:{by:new n({enum:ep,required:!0}),fields:new t({each:new r({values:{name:new e,direction:new n({enum:tp})}})})}}),new r({options:{required:!1},values:{by:new n({enum:ep,required:!0}),fields:new t({each:new r({values:{field:new e({required:!0}),direction:new n({enum:tp}),displayName:new e}})})}});var rp=(e,t)=>({...np(e,t),facets:[...ip(e),...sp(e)],...e.commerceSort&&{sort:op(e.commerceSort.appliedSort)}}),np=(e,t,r)=>{let{view:n,location:a,...i}=e.commerceContext;return{accessToken:e.configuration.accessToken,url:e.configuration.commerce.apiBaseUrl??Zf(e.configuration.organizationId,e.configuration.environment),organizationId:e.configuration.organizationId,trackingId:e.configuration.analytics.trackingId,...i,...e.configuration.analytics.enabled?{clientId:t.clientId}:{},context:{user:{...a,...t.userAgent?{userAgent:t.userAgent}:{}},view:{...n,...t.referrer?{referrer:t.referrer}:{}},capture:e.configuration.analytics.enabled,cart:Xf(e.cart),source:pn(e.configuration.analytics)},...ap(e,r)}},ap=(e,t)=>{let r=t?e.commercePagination?.recommendations[t]:e.commercePagination?.principal;return r&&{page:r.page,...r.perPage&&{perPage:r.perPage}}};function ip(e){return e.facetOrder&&e.commerceFacetSet?e.facetOrder.filter((t=>e.commerceFacetSet?.[t])).map((t=>e.commerceFacetSet[t].request)).filter((e=>e&&e.values.length>0)):[]}function sp(e){return e.manualNumericFacetSet?Object.entries(e.manualNumericFacetSet).filter((([e,t])=>void 0!==t.manualRange)).map((([e,t])=>({facetId:e,field:e,numberOfValues:1,isFieldExpanded:!1,preventAutoSelect:!0,type:"numericalRange",values:[t.manualRange],initialNumberOfValues:1}))):[]}function op(e){return"relevance"===e.by?{sortCriteria:"relevance"}:{sortCriteria:"fields",fields:e.fields.map((({name:e,direction:t})=>({field:e,direction:t})))}}var cp=e=>{let t=[],r=e.values[0];for(;r;)t.push(r.value),r=r.children[0];return t},up=e=>async({facetId:t,facetSearchType:r},{getState:n,extra:{validatePayload:a,navigatorContext:i,apiClient:s}})=>{let o=n();a(t,_e);let c=fp(o,t)||pp(o,t)?((e,t,r,n)=>{let a=`*${t.facetSearchSet[e].options.query}*`,i=t.commerceQuery?.query,{url:s,accessToken:o,organizationId:c,trackingId:u,language:l,country:d,currency:f,clientId:p,context:g,...h}=rp(t,n);return{url:s,accessToken:o,organizationId:c,facetId:hp(e),facetQuery:a,trackingId:u,language:l,country:d,currency:f,clientId:p,context:g,query:i,...!r&&{...h,query:""}}})(t,o,e,i):((e,t,r,n)=>{let a=`*${t.categoryFacetSearchSet[e].options.query}*`,i=t.commerceFacetSet[hp(e)]?.request,s=i&&function(e){return"hierarchical"===e.type}(i)?i&&cp(i):[],o=s.length?[s]:[],c=t.commerceQuery?.query,{url:u,accessToken:l,organizationId:d,trackingId:f,language:p,country:g,currency:h,clientId:y,context:m,...v}=rp(t,n);return{url:u,accessToken:l,organizationId:d,facetId:hp(e),facetQuery:a,ignorePaths:o,trackingId:f,language:p,country:g,currency:h,clientId:y,context:m,query:c,...!r&&{...v,query:""}}})(t,o,e,i);return{facetId:t,response:await s.facetSearch(c,r)}},lp=Ur("commerce/facetSearch/executeSearch",up(!1)),dp=Ur("commerce/facetSearch/facetFieldSuggest",up(!0)),fp=(e,t)=>"facetSearchSet"in e&&void 0!==e.facetSearchSet[t]&&void 0!==e.commerceFacetSet[t],pp=(e,t)=>"fieldSuggestionsOrder"in e&&e.fieldSuggestionsOrder.some((e=>e.facetId===t&&"regular"===e.type)),gp="field_suggestion:";function hp(e){return e.startsWith(gp)?e.slice(gp.length):e}function yp(e){return e.startsWith(gp)?e:`${gp}${e}`}var mp=ir((e=>e.commercePagination?.principal.perPage||0),(e=>e));ir(((e,t)=>e.commercePagination?.recommendations[t]?.perPage||0),(e=>e));var vp=ir((e=>e.commercePagination?.principal.totalEntries||0),(e=>e));ir(((e,t)=>e.commercePagination?.recommendations[t]?.totalEntries||0),(e=>e)),ir((e=>e.commercePagination?.principal.page||0),(e=>e)),ir(((e,t)=>e.commercePagination?.recommendations[t]?.page||0),(e=>e));var Sp=Symbol.for("coveo-headless-internal-state");ir((e=>e[Sp].productListing.responseId),(e=>e)),ir((e=>e.productListing.responseId),(e=>e)),ir((e=>e.productListing.requestId),(e=>e));var wp=ir((e=>e.productListing?.products.length||0),(e=>e)),bp=ir((e=>({total:vp(e),current:wp(e)})),(({current:e,total:t})=>e<t));ir((e=>e.productListing?.isLoading),(e=>!c(e)&&e)),ir((e=>e.productListing?.error),(e=>e??null));var Cp=Ur("commerce/productListing/fetch",(async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,navigatorContext:a}})=>{let i=t(),s=await n.getProductListing(rp(i,a));return Jf(s)?r(s.error):{response:s.success}}));Ur("commerce/productListing/fetchMoreProducts",(async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,navigatorContext:a}})=>{let i=t();if(!bp(i))return null;let s=mp(i),o=wp(i)/s,c=await n.getProductListing({...rp(i,a),page:o});return Jf(c)?r(c.error):{response:c.success}}));var Ip={child:new r({options:{required:!0},values:{permanentid:new e({required:!0})}})};dr("commerce/productListing/promoteChildToParent",(e=>He(e,Ip)));var qp=dr("commerce/querySuggest/clear",(e=>He(e,{id:_e}))),kp=Ur("commerce/querySuggest/fetch",(async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,validatePayload:a,navigatorContext:i}})=>{a(e,{id:_e});let s=t(),o=Rp(e.id,s,i),c=await n.querySuggest(o);return Jf(c)?r(c.error):{id:e.id,query:o.query,...c.success}})),xp=dr("commerce/querySuggest/register",(e=>He(e,{id:_e,count:new s({min:0})}))),Ap=dr("commerce/querySuggest/selectSuggestion",(e=>He(e,{id:_e,expression:Qe}))),Rp=(e,t,r)=>{let{view:n,...a}=t.commerceContext;return{accessToken:t.configuration.accessToken,url:t.configuration.commerce.apiBaseUrl??Zf(t.configuration.organizationId,t.configuration.environment),organizationId:t.configuration.organizationId,trackingId:t.configuration.analytics.trackingId,query:t.querySet[e],...a,...t.configuration.analytics.enabled?{clientId:r.clientId}:{},context:{user:{...location,...r.userAgent?{userAgent:r.userAgent}:{}},view:{...n,...r.referrer?{referrer:r.referrer}:{}},capture:t.configuration.analytics.enabled,cart:Xf(t.cart),source:pn(t.configuration.analytics)}}};dr("commerce/facets/core/updateNumberOfValues",(e=>He(e,{facetId:_e,numberOfValues:new s({required:!0,min:1})}))),dr("commerce/facets/core/updateIsFieldExpanded",(e=>He(e,{facetId:_e,isFieldExpanded:new a({required:!0})})));var Op=dr("commerce/facets/core/clearAll");dr("commerce/facets/core/deselectAllValues",(e=>He(e,{facetId:_e}))),dr("commerce/facets/core/updateFreezeCurrentValues",(e=>He(e,{facetId:_e,freezeCurrentValues:new a({required:!0})})));var Fp=dr("commerce/facets/core/updateAutoSelectionForAll",(e=>He(e,{allow:new a({required:!0})}))),Ep={slotId:$e},Tp={...Ep,pageSize:new s({required:!0,min:0})};dr("commerce/pagination/setPageSize",(e=>He(e,Tp)));var Dp={...Ep,page:new s({required:!0,min:0})},Mp=dr("commerce/pagination/selectPage",(e=>He(e,Dp)));dr("commerce/pagination/nextPage",(e=>He(e,Ep))),dr("commerce/pagination/previousPage",(e=>He(e,Ep))),dr("commerce/pagination/registerRecommendationsSlot",(e=>He(e,{slotId:_e})));var Pp=dr("commerce/query/update",(t=>He(t,{query:new e}))),jp=dr("commerce/triggers/query/updateIgnore",(t=>He(t,{q:new e({emptyAllowed:!0,required:!0})}))),Vp=dr("commerce/triggers/query/applyModification",(e=>He(e,new r({values:{originalQuery:Ue,modification:Ue}}))));function _p(e,t,r){if(void 0===e)return{};let n=t(e);return n!==r?{q:n}:{}}function Up(e,t,r){if(void 0===e)return{};let n=t(e);return n!==r?{sortCriteria:n}:{}}function Qp(e,t,r,n){if(void 0===e)return{};let a=Object.entries(e).filter((([e])=>t(e))).map((([e,{request:t}])=>{let n=r(t);return n.length?{[e]:n}:{}})).reduce(((e,t)=>({...e,...t})),{});return Object.keys(a).length?{[n]:a}:{}}ir((e=>e[Sp].commerceSearch.responseId),(e=>e)),ir((e=>e.commerceSearch.responseId),(e=>e)),ir((e=>e.commerceSearch.requestId),(e=>e));var $p=ir((e=>e.commerceSearch?.products.length||0),(e=>e)),Lp=ir((e=>({total:vp(e),current:$p(e)})),(({current:e,total:t})=>e<t));ir((e=>e.commerceSearch?.isLoading),(e=>!c(e)&&e)),ir((e=>e.commerceSearch?.error),(e=>e??null));var Np=ir((e=>e.commerceQuery?.query),(e=>e??""));ir((e=>e.commerceSearch?.queryExecuted),(e=>e));var Bp=(e,t)=>c(t.queryCorrection?.correctedQuery)?Np(e):t.queryCorrection.correctedQuery,zp=class{constructor(e){this.config=e}async process(e){return this.processQueryErrorOrContinue(e)??await this.processQueryCorrectionsOrContinue(e)??await this.processQueryTriggersOrContinue(e)??this.processSuccessResponse(e)}async fetchFromAPI(e){let t=(new Date).getTime();return{response:await this.extra.apiClient.search(e),duration:(new Date).getTime()-t,queryExecuted:this.getState().commerceQuery.query||"",requestExecuted:e}}processSuccessResponse(e){return{...e,response:this.getSuccessResponse(e),originalQuery:this.getCurrentQuery()}}processQueryErrorOrContinue(e){return Jf(e.response)?this.rejectWithValue(e.response.error):null}async processQueryCorrectionsOrContinue(e){let t=this.getState(),r=this.getSuccessResponse(e);if(!r||!t.didYouMean)return null;let{queryCorrection:n}=r;if(c(n)||c(n.correctedQuery))return null;let{correctedQuery:a,originalQuery:i}=r.queryCorrection;return this.onUpdateQueryForCorrection(a??""),{...e,response:{...r},queryExecuted:Bp(t,r),originalQuery:i??""}}async processQueryTriggersOrContinue(e){let t=this.getSuccessResponse(e);if(!t)return null;let r=t.triggers.find((e=>"query"===e.type))?.content||"";if(!r)return null;if(this.getState().triggers?.queryModification.queryToIgnore===r)return this.dispatch(jp({q:""})),null;let n=this.getCurrentQuery(),a=await this.automaticallyRetryQueryWithTriggerModification(r);return Jf(a.response)?this.rejectWithValue(a.response.error):{...a,response:{...a.response.success},originalQuery:n}}async automaticallyRetryQueryWithTriggerModification(e){return this.dispatch(Vp({newQuery:e,originalQuery:this.getCurrentQuery()})),this.onUpdateQueryForCorrection(e),await this.fetchFromAPI({...rp(this.getState(),this.navigatorContext),query:e})}get dispatch(){return this.config.dispatch}get rejectWithValue(){return this.config.rejectWithValue}getState(){return this.config.getState()}get navigatorContext(){return this.config.extra.navigatorContext}getCurrentQuery(){let e=this.getState();return void 0!==e.commerceQuery.query?e.commerceQuery.query:""}getSuccessResponse(e){return Jf(e.response)?null:e.response.success}get extra(){return this.config.extra}onUpdateQueryForCorrection(e){this.dispatch(Pp({query:e}))}},Hp=Ur("commerce/search/executeSearch",(async(e,t)=>{let{getState:r}=t,n=r(),{navigatorContext:a}=t.extra,i=rp(n,a),s=Np(n),o=new zp(t),c=await o.fetchFromAPI({...i,query:s});return o.process(c)}));Ur("commerce/search/fetchMoreProducts",(async(e,t)=>{let{getState:r}=t,n=r(),{navigatorContext:a}=t.extra;if(!Lp(n))return null;let i=mp(n),s=$p(n)/i,o=Np(n),c=rp(n,a),u=new zp(t),l=await u.fetchFromAPI({...c,query:o,page:s});return u.process(l)})),Ur("commerce/search/prepareForSearchWithQuery",((t,r)=>{let{dispatch:n}=r;He(t,{query:new e,clearFilters:new a}),t.clearFilters&&(n(Op()),n(Js())),n(Fp({allow:!0})),n(Pp({query:t.query})),n(Mp({page:0}))})),Ur("commerce/search/fetchInstantProducts",(async(e,{getState:t,rejectWithValue:r,extra:n})=>{let a=t(),{apiClient:i,navigatorContext:s}=n,{q:o}=e,c=await i.productSuggestions({...rp(a,s),query:o});if(Jf(c))return r(c.error);let u=c.success.products.slice(0,5);return{response:{...c.success,products:u}}}));var Yp={child:new r({options:{required:!0},values:{permanentid:new e({required:!0})}})};function Wp(e,t,r){let{facetId:n}=t;if(e[n])return;let a={...ng,...t},i=r();e[n]={options:a,isLoading:!1,response:i,initialNumberOfValues:a.numberOfValues,requestId:""}}function Gp(e,t){let{facetId:r,...n}=t,a=e[r];a&&(a.options={...a.options,...n})}function Kp(e,t,r){let n=e[t];n&&(n.requestId=r,n.isLoading=!0)}function Jp(e,t){let r=e[t];r&&(r.isLoading=!1)}function Zp(e,t,r){let{facetId:n,response:a}=t,i=e[n];i&&i.requestId===r&&(i.isLoading=!1,i.response=a)}function Xp(e,t,r){let{facetId:n,response:a}=t,i=e[n];i&&i.requestId===r&&(i.isLoading=!1,"success"in a&&(i.response=a.success))}function eg(e,t,r,n){let{facetId:a,response:i}=t,s=yp(a),o=e[s];if(o){if(o.requestId!==r)return}else Wp(e,{facetId:s},n),o=e[s];o.isLoading=!1,"success"in i&&(o.response=i.success)}function tg(e,t,r){let{facetId:n}=t,a=e[n];a&&(a.requestId="",a.isLoading=!1,a.response=r(),a.options.numberOfValues=a.initialNumberOfValues,a.options.query=ng.query)}function rg(e,t){Object.keys(e).forEach((r=>tg(e,{facetId:r},t)))}dr("commerce/search/promoteChildToParent",(e=>He(e,Yp)));var ng={captions:{},numberOfValues:10,query:""},ag=e=>{let t=[],r=e.currentValues[0];for(;r;)t.push(r.value),r=r.children[0];return t},ig=e=>async(t,{getState:r,extra:{apiClient:n,validatePayload:a,navigatorContext:i}})=>{let s,o=r();return a(t,_e),s=ug(o,t)?await(async(e,t,r,n)=>{let{captions:a,query:i,numberOfValues:s}=t.facetSearchSet[e].options,{field:o,currentValues:c,filterFacetCount:u}=t.facetSet[e].request,l=c.filter((e=>"idle"!==e.state)).map((e=>e.value)),d=`*${i}*`;return{url:t.configuration.search.apiBaseUrl??me(t.configuration.organizationId,t.configuration.environment),accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,...t.configuration.search.authenticationProviders&&{authentication:t.configuration.search.authenticationProviders.join(",")},captions:a,numberOfValues:s,query:d,field:o,ignoreValues:l,filterFacetCount:u,type:"specific",...n?{}:{searchContext:(await Tc(t,r)).request}}})(t,o,i,e):await(async(e,t,r,n)=>{let a=t.categoryFacetSearchSet[e].options,i=t.categoryFacetSet[e].request,{captions:s,query:o,numberOfValues:c}=a,{field:u,delimitingCharacter:l,basePath:d,filterFacetCount:f}=i,p=ag(i),g=p.length?[p]:[],h=`*${o}*`;return{url:t.configuration.search.apiBaseUrl??me(t.configuration.organizationId,t.configuration.environment),accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,...t.configuration.search.authenticationProviders.length&&{authentication:t.configuration.search.authenticationProviders.join(",")},basePath:d,captions:s,numberOfValues:c,query:h,field:u,delimitingCharacter:l,ignorePaths:g,filterFacetCount:f,type:"hierarchical",...n?{}:{searchContext:(await Tc(t,r)).request}}})(t,o,i,e),{facetId:t,response:await n.facetSearch(s)}},sg=Ur("facetSearch/executeSearch",ig(!1)),og=Ur("facetSearch/executeSearch",ig(!0)),cg=dr("facetSearch/clearResults",(e=>He(e,{facetId:qf}))),ug=(e,t)=>void 0!==e.facetSearchSet&&void 0!==e.facetSet&&void 0!==e.facetSet[t],lg={facetId:qf,value:new r({values:{displayValue:Qe,rawValue:Qe,count:new s({required:!0,min:0})}})},dg=dr("facetSearch/register",(e=>He(e,Rf))),fg=dr("facetSearch/update",(e=>He(e,Rf))),pg=dr("facetSearch/toggleSelectValue",(e=>He(e,lg))),gg=dr("facetSearch/toggleExcludeValue",(e=>He(e,lg)));var hg=Ir({},(e=>{e.addCase(Ef,((e,t)=>{Wp(e,t.payload,yg)})).addCase(fg,((e,t)=>{Gp(e,t.payload)})).addCase(lp.pending,((e,t)=>{let{facetId:r}=t.meta.arg;Kp(e,r,t.meta.requestId)})).addCase(dp.pending,((e,t)=>{let{facetId:r}=t.meta.arg;Kp(e,r,t.meta.requestId)})).addCase(sg.pending,((e,t)=>{Kp(e,t.meta.arg,t.meta.requestId)})).addCase(lp.rejected,((e,t)=>{let{facetId:r}=t.meta.arg;Jp(e,r)})).addCase(dp.rejected,((e,t)=>{let{facetId:r}=t.meta.arg;Jp(e,yp(r))})).addCase(sg.rejected,((e,t)=>{Jp(e,t.meta.arg)})).addCase(lp.fulfilled,((e,t)=>{Xp(e,t.payload,t.meta.requestId)})).addCase(dp.fulfilled,((e,t)=>{eg(e,t.payload,t.meta.requestId,yg)})).addCase(kp.fulfilled,((e,t)=>{!function(e,t,r,n){if(t.fieldSuggestionsFacets)for(let a of t.fieldSuggestionsFacets){let i=yp(a.facetId);i in e||"hierarchical"!==a.type||(e[i]={options:{...ng,query:t.query??""},isLoading:!1,response:n(),initialNumberOfValues:ng.numberOfValues,requestId:r})}}(e,t.payload,t.meta.requestId,yg)})).addCase(sg.fulfilled,((e,t)=>{Zp(e,t.payload,t.meta.requestId)})).addCase(cg,((e,{payload:{facetId:t}})=>{tg(e,{facetId:t},yg)})).addCase(Cp.fulfilled,(e=>rg(e,yg))).addCase(Hp.fulfilled,(e=>rg(e,yg))).addCase(_c.fulfilled,(e=>{rg(e,yg)}))}));function yg(){return{moreValuesAvailable:!1,values:[]}}var mg=e=>ns("analytics/facet/showMore",((t,r)=>{He(e,qf);let n=vi(e,wi(r));return t.makeFacetShowMore(n)})),vg=e=>ns("analytics/facet/showLess",((t,r)=>{He(e,qf);let n=vi(e,wi(r));return t.makeFacetShowLess(n)})),Sg=e=>ns("analytics/facet/sortChange",((t,r)=>{He(e,{facetId:qf,criterion:new i({required:!0})});let{facetId:n,criterion:a}=e,s=wi(r),o={...vi(n,s),criteria:a};return t.makeFacetUpdateSort(o)})),wg=e=>ns("analytics/facet/reset",((t,r)=>{He(e,qf);let n=wi(r),a=vi(e,n);return t.makeFacetClearAll(a)})),bg=e=>ns("analytics/facet/select",((t,r)=>{He(e,{facetId:qf,facetValue:_e});let n=wi(r),a=Si(e,n);return t.makeFacetSelect(a)})),Cg=e=>ns("analytics/facet/exclude",((t,r)=>{He(e,{facetId:qf,facetValue:_e});let n=wi(r),a=Si(e,n);return t.makeFacetExclude(a)})),Ig=e=>ns("analytics/facet/deselect",((t,r)=>{He(e,{facetId:qf,facetValue:_e});let n=wi(r),a=Si(e,n);return t.makeFacetDeselect(a)})),qg=e=>ns("analytics/facet/unexclude",((t,r)=>{He(e,{facetId:qf,facetValue:_e});let n=wi(r),a=Si(e,n);return t.makeFacetUnexclude(a)})),kg=e=>ns("analytics/facet/breadcrumb",((t,r)=>{He(e,{facetId:qf,facetValue:_e});let n=Si(e,wi(r));return t.makeBreadcrumbFacet(n)})),xg=()=>({actionCause:"facetClearAll"}),Ag=()=>({actionCause:"facetSelect"}),Rg=()=>({actionCause:"facetExclude"}),Og=()=>({actionCause:"facetDeselect"}),Fg=(e,t)=>e.facetOptions.facets[t]?.enabled??!0,Eg=new e({regex:/^[a-zA-Z0-9-_]+$/}),Tg=new e({required:!0}),Dg=new t({each:new e}),Mg=new e,Pg=new a,jg=new a,Vg=new s({min:0}),_g=new s({min:1}),Ug=new a({required:!0}),Qg=new r,$g=new e,Lg=new r({values:{captions:Qg,numberOfValues:_g,query:$g}}),Ng=new r({options:{required:!1},values:{type:new e({constrainTo:["simple"],emptyAllowed:!1,required:!0}),values:new t({required:!0,max:25,each:new e({emptyAllowed:!1,required:!0})})}}),Bg=new a,zg=new t({min:1,max:25,required:!1,each:new e({emptyAllowed:!1,required:!0})}),Hg={value:_e,numberOfResults:new s({min:0}),state:_e},Yg={facetId:qf,field:new e({required:!0,emptyAllowed:!0}),tabs:new r({options:{required:!1},values:{included:new t({each:new e}),excluded:new t({each:new e})}}),activeTab:new e({required:!1}),filterFacetCount:new a({required:!1}),injectionDepth:new s({required:!1,min:0}),numberOfValues:new s({required:!1,min:1}),sortCriteria:new i({required:!1}),resultsMustMatch:new i({required:!1}),allowedValues:Ng,customSort:zg},Wg=dr("facet/register",(e=>He(e,Yg))),Gg=dr("facet/toggleSelectValue",(e=>He(e,{facetId:qf,selection:new r({values:Hg})}))),Kg=dr("facet/toggleExcludeValue",(e=>He(e,{facetId:qf,selection:new r({values:Hg})}))),Jg=dr("facet/deselectAll",(e=>He(e,qf))),Zg=dr("facet/updateSortCriterion",(e=>He(e,{facetId:qf,criterion:new i({required:!0})}))),Xg=dr("facet/updateNumberOfValues",(e=>He(e,{facetId:qf,numberOfValues:new s({required:!0,min:1})}))),eh=dr("facet/updateIsFieldExpanded",(e=>He(e,{facetId:qf,isFieldExpanded:new a({required:!0})}))),th=dr("facet/updateFreezeCurrentValues",(e=>He(e,{facetId:qf,freezeCurrentValues:new a({required:!0})})));function rh(e){return{start:nh(e.start,e),end:nh(e.end,e),endInclusive:e.endInclusive??!1,state:e.state??"idle"}}function nh(e,t){let{dateFormat:r}=t;return function(e){return!!e&&"object"==typeof e&&"period"in e}(e)?(Mo(e),function(e){let{period:t,amount:r,unit:n}=e;switch(t){case"past":case"next":return`${t}-${r}-${n}`;case"now":return t}}(e)):"string"==typeof e&&_o(e)?(Mo(e),e):(Oo(e,r),Ro(Ao(e,r)))}var ah=dr("rangeFacet/updateSortCriterion",(e=>He(e,{facetId:qf,criterion:new i({required:!0})}))),ih={state:_e,start:new s({required:!0}),end:new s({required:!0}),endInclusive:new a({required:!0}),numberOfResults:new s({required:!0,min:0})},sh={start:_e,end:_e,endInclusive:new a({required:!0}),state:_e,numberOfResults:new s({required:!0,min:0})},oh=e=>({facetId:qf,selection:"string"==typeof e.start?new r({values:sh}):new r({values:ih})}),ch={start:_e,end:_e,endInclusive:new a({required:!0}),state:_e},uh={facetId:qf,field:_e,tabs:new r({options:{required:!1},values:{included:new t({each:new e}),excluded:new t({each:new e})}}),activeTab:new e({required:!1}),currentValues:new t({required:!1,each:new r({values:ch})}),generateAutomaticRanges:new a({required:!0}),filterFacetCount:new a({required:!1}),injectionDepth:new s({required:!1,min:0}),numberOfValues:new s({required:!1,min:1}),sortCriteria:new i({required:!1}),rangeAlgorithm:new i({required:!1})};function lh(e){return _o(e)?jo(e):e}function dh(e){e.currentValues&&e.currentValues.forEach((e=>{let{start:t,end:r}=rh(e);if(Ao(lh(t)).isAfter(Ao(lh(r))))throw new Error(`The start value is greater than the end value for the date range ${e.start} to ${e.end}`)}))}var fh=dr("dateFacet/register",(e=>{try{return ze(e,uh),dh(e),{payload:e,error:null}}catch(t){return{payload:e,error:Be(t)}}})),ph=dr("dateFacet/toggleSelectValue",(e=>He(e,{facetId:qf,selection:new r({values:sh})}))),gh=dr("dateFacet/toggleExcludeValue",(e=>He(e,{facetId:qf,selection:new r({values:sh})}))),hh=dr("dateFacet/updateFacetValues",(e=>{try{return ze(e,{facetId:qf,values:new t({each:new r({values:sh})})}),dh({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:Be(t)}}})),yh=ah,mh=Jg,vh={state:_e,start:new s({required:!0}),end:new s({required:!0}),endInclusive:new a({required:!0})},Sh={facetId:qf,field:_e,tabs:new r({options:{required:!1},values:{included:new t({each:new e}),excluded:new t({each:new e})}}),activeTab:new e({required:!1}),currentValues:new t({required:!1,each:new r({values:vh})}),generateAutomaticRanges:new a({required:!0}),filterFacetCount:new a({required:!1}),injectionDepth:new s({required:!1,min:0}),numberOfValues:new s({required:!1,min:1}),sortCriteria:new i({required:!1}),rangeAlgorithm:new i({required:!1})};function wh(e){e.currentValues&&e.currentValues.forEach((({start:e,end:t})=>{if(e>t)throw new Error(`The start value is greater than the end value for the numeric range ${e} to ${t}`)}))}var bh=dr("numericFacet/register",(e=>{try{return He(e,Sh),wh(e),{payload:e,error:null}}catch(t){return{payload:e,error:Be(t)}}})),Ch=dr("numericFacet/toggleSelectValue",(e=>He(e,{facetId:qf,selection:new r({values:ih})}))),Ih=dr("numericFacet/toggleExcludeValue",(e=>He(e,{facetId:qf,selection:new r({values:ih})}))),qh=dr("numericFacet/updateFacetValues",(e=>{try{return ze(e,{facetId:qf,values:new t({each:new r({values:ih})})}),wh({currentValues:e.values}),{payload:e,error:null}}catch(t){return{payload:e,error:Be(t)}}})),kh=ah,xh=Jg,Ah=(e,t)=>0===Object.keys({...e}).length||!t||!e||(!e.excluded||!e.excluded.includes(t))&&!(!e.included||0!==e.included.length&&!e.included.includes(t)),Rh=Ir({freezeFacetOrder:!1,facets:{}},(e=>{e.addCase(kf,((e,t)=>({...e,...t.payload}))).addCase(_c.fulfilled,(e=>{e.freezeFacetOrder=!1})).addCase(_c.rejected,(e=>{e.freezeFacetOrder=!1})).addCase(Zl,((e,t)=>{for(let r in e.facets){let n=e.facets[r];Object.keys({...n.tabs}).length>0&&(n.enabled=Ah(n.tabs,t.payload))}})).addCase(zs.fulfilled,((e,t)=>t.payload?.facetOptions??e)).addCase($f,((e,t)=>{let{facetId:r,tabs:n,activeTab:a}=t.payload;Oh(n,a,e,r)})).addCase(Wg,((e,t)=>{let{facetId:r,tabs:n,activeTab:a}=t.payload;Oh(n,a,e,r)})).addCase(fh,((e,t)=>{let{facetId:r,tabs:n,activeTab:a}=t.payload;Oh(n,a,e,r)})).addCase(bh,((e,t)=>{let{facetId:r,tabs:n,activeTab:a}=t.payload;Oh(n,a,e,r)})).addCase(xf,((e,t)=>{e.facets[t.payload].enabled=!0})).addCase(Af,((e,t)=>{e.facets[t.payload].enabled=!1})).addCase(Ps,((e,t)=>{t.payload.tab&&Object.entries(e.facets).forEach((([,e])=>{Object.keys(e.tabs??{}).length>0&&(e.enabled=Ah(e.tabs,t.payload.tab))})),[...Object.keys(t.payload.f??{}),...Object.keys(t.payload.fExcluded??{}),...Object.keys(t.payload.cf??{}),...Object.keys(t.payload.nf??{}),...Object.keys(t.payload.df??{})].forEach((t=>{t in e||(e.facets[t]={enabled:!0,tabs:{}}),e.facets[t].enabled=!0}))}))}));function Oh(e,t,r,n){let a={enabled:!0,tabs:{},tabs:e??{}};e&&Object.keys(e).length>0&&(a.enabled=Ah(e,t)),r.facets[n]=a}var Fh=ir((e=>e),(e=>{if(!e)return"";for(let t in e)if(e[t].isActive)return e[t].id;return""}));function Eh(e,t){let{field:r,state:n}=e;if(!function(e){let{field:t,state:r}=e;return Th(r).some((e=>e&&t in e))}(e))return r;let a=`${r}_`,i=function(e,t){let r=Th(t).map((e=>Object.keys(e||{}))).reduce(((e,t)=>e.concat(t)),[]);return function(e,t){return e.map((e=>{let r=e.split(t)[1],n=parseInt(r,10);return Number.isNaN(n)?0:n})).sort().pop()??0}(r,e)+1}(a,n);return function(e,t){let r=`A facet with field "${e}" already exists.\n  To avoid unexpected behaviour, configure the #id option on the facet controller.`;t.warn(r)}(r,t),`${a}${i}`}function Th(e){let{facetSet:t,numericFacetSet:r,dateFacetSet:n,categoryFacetSet:a}=e;return[t,r,n,a]}function Dh(e,t){let{state:r,logger:n}=e,{field:a,facetId:i}=t;return i||Eh({field:a,state:r},n)}var Mh=new o({field:Tg,tabs:new r({options:{required:!1},values:{included:new t({each:new e}),excluded:new t({each:new e})}}),basePath:Dg,delimitingCharacter:Mg,facetId:Eg,facetSearch:Lg,filterByBasePath:Pg,filterFacetCount:jg,injectionDepth:Vg,numberOfValues:_g,sortCriteria:new e({constrainTo:["alphanumeric","occurrences"]})});function Ph(e,t){!function(e){e.addReducers({categoryFacetSet:Yf,categoryFacetSearchSet:hg,facetOptions:Rh,configuration:ad,search:tu})}(e);let r=Td(e),{dispatch:n}=e,a=Dh(e,t.options),i=t.options.tabs??{},s=Fh(e.state.tabSet),o={...Wf,...Y("facetSearch",t.options),field:t.options.field,facetId:a,tabs:i,activeTab:s},c={facetSearch:{...ng,...t.options.facetSearch},...o};We(e,Mh,c,"buildCategoryFacet");let u=()=>yi(e.state,a);return n($f(o)),{...r,toggleSelect(e){let t=c.numberOfValues;n(Lf({facetId:a,selection:e,retrieveCount:t})),n(kf())},deselectAll(){n(Nf(a)),n(kf())},sortBy(e){n(zf({facetId:a,criterion:e})),n(kf())},isSortedBy:e=>u().sortCriteria===e,showMoreValues(){let{numberOfValues:e}=c,{activeValue:t,valuesAsTrees:r}=this.state,i=(t?.children.length??r.length)+e;n(Bf({facetId:a,numberOfValues:i})),n(kf())},showLessValues(){let{numberOfValues:e}=c;n(Bf({facetId:a,numberOfValues:e})),n(kf())},enable(){n(xf(a))},disable(){n(Af(a))},get state(){let t=u(),r=hi(e.state,a),n=pi(e.state),i=Fg(e.state,a),s=r?.values??[],o=s.some((e=>e.children.length>0))??!1,{parents:l,values:d}=function(e){if(!e)return{parents:[],values:[]};let t=[],r=e;for(;r.length&&r[0].children.length;)t=[...t,...r],r=r[0].children;let n=r.find((e=>"selected"===e.state));return n&&(t=[...t,n],r=[]),{parents:t,values:r}}(r?.values),f=gi(s),p=f.length?f[f.length-1]:void 0,g=!!p,h=p?.moreValuesAvailable??r?.moreValuesAvailable??!1,y=p?p.children.length>c.numberOfValues:s.length>c.numberOfValues;return{facetId:a,parents:l,selectedValueAncestry:f,values:d,isHierarchical:o,valuesAsTrees:s,activeValue:p,isLoading:n,hasActiveValues:g,canShowMoreValues:h,canShowLessValues:y,sortCriteria:t.sortCriteria,enabled:i}}}}function jh(e,t){let r=e.dispatch,{options:n,getFacetSearch:a,executeFacetSearchActionCreator:i,executeFieldSuggestActionCreator:s}=t,{facetId:o}=n;return{updateText(e){r(fg({facetId:o,query:e,numberOfValues:a().initialNumberOfValues}))},showMoreResults(){let{initialNumberOfValues:e,options:n}=a();r(fg({facetId:o,numberOfValues:n.numberOfValues+e})),r(t.isForFieldSuggestions?s(o):i(o))},search(){r(t.isForFieldSuggestions?s(o):i(o))},clear(){r(cg({facetId:o}))},updateCaptions(e){r(fg({facetId:o,captions:e}))},get state(){let{response:e,isLoading:t,options:r}=a(),{query:n}=r,i=e.values;return{...e,values:i,isLoading:t,query:n}}}}function Vh(e,t){let{executeFacetSearchActionCreator:r,executeFieldSuggestActionCreator:n,select:a,isForFieldSuggestions:i}=t,{dispatch:s}=e,o={...ng,...t.options},{facetId:c}=o,u=function(e,t){let{dispatch:r}=e,n={...ng,...t.options},{facetId:a}=n;r(Ef(n));let i=jh(e,{options:n,getFacetSearch:()=>"state"in e?e.state.categoryFacetSearchSet[a]:e[Sp].categoryFacetSearchSet[a],isForFieldSuggestions:t.isForFieldSuggestions,executeFacetSearchActionCreator:t.executeFacetSearchActionCreator,executeFieldSuggestActionCreator:t.executeFieldSuggestActionCreator});return{...i,select(e){r(Ff({facetId:a,value:e})),t.select(e)},get state(){return i.state}}}(e,{options:{...o},executeFacetSearchActionCreator:r,executeFieldSuggestActionCreator:n,select:a,isForFieldSuggestions:i});s(Ef(o));let l=jh(e,{options:o,getFacetSearch:()=>e.state.categoryFacetSearchSet[c],isForFieldSuggestions:t.isForFieldSuggestions,executeFacetSearchActionCreator:sg,executeFieldSuggestActionCreator:og});return{...l,...u,get state(){return{...l.state,...u.state}}}}function _h(e,t){!function(e){e.addReducers({categoryFacetSet:Yf,categoryFacetSearchSet:hg,configuration:ad,search:tu})}(e);let r=Ph(e,t),{dispatch:n}=e,a=()=>r.state.facetId,i=Vh(e,{options:{facetId:a(),...t.options.facetSearch},executeFacetSearchActionCreator:sg,executeFieldSuggestActionCreator:og,select:e=>{n(kf()),n(_c({legacy:bg({facetId:a(),facetValue:e.rawValue}),next:Ag()}))},isForFieldSuggestions:!1}),{state:s,...o}=i;return{...r,facetSearch:o,toggleSelect(e){r.toggleSelect(e),n(_c({legacy:Uh(a(),e),next:Qh(e)}))},deselectAll(){r.deselectAll(),n(_c({legacy:wg(a()),next:xg()}))},sortBy(e){r.sortBy(e),n(_c({legacy:Sg({facetId:a(),criterion:e}),next:{actionCause:"facetUpdateSort"}}))},showMoreValues(){r.showMoreValues(),n($c({legacy:mg(a())}))},showLessValues(){r.showLessValues(),n($c({legacy:vg(a())}))},get state(){return{...r.state,facetSearch:i.state}}}}function Uh(e,t){let r={facetId:e,facetValue:t.value};return"selected"===t.state?Ig(r):bg(r)}function Qh(e){return"selected"===e.state?Og():Ag()}var $h=Intl.supportedValuesOf("currency"),Lh=new e({required:!0,emptyAllowed:!1,constrainTo:$h}),Nh={url:_e},Bh={latitude:new s({min:-90,max:90,required:!0}),longitude:new s({min:-180,max:180,required:!0})},zh={language:_e,country:_e,currency:Lh,view:new r({options:{required:!0},values:Nh}),location:new r({options:{required:!1},values:Bh})};new o(zh);var Hh=dr("commerce/context/set",(e=>He(e,zh))),Yh=dr("commerce/context/setView",(e=>He(e,Nh)));dr("commerce/context/setLocation",(e=>He(e,Bh)));var Wh=Ir({},(e=>{e.addCase(dg,((e,t)=>{Wp(e,t.payload,Gh)})).addCase(fg,((e,t)=>{Gp(e,t.payload)})).addCase(lp.pending,((e,t)=>{let{facetId:r}=t.meta.arg;Kp(e,r,t.meta.requestId)})).addCase(dp.pending,((e,t)=>{let{facetId:r}=t.meta.arg;Kp(e,yp(r),t.meta.requestId)})).addCase(sg.pending,((e,t)=>{Kp(e,t.meta.arg,t.meta.requestId)})).addCase(lp.rejected,((e,t)=>{let{facetId:r}=t.meta.arg;Jp(e,r)})).addCase(dp.rejected,((e,t)=>{let{facetId:r}=t.meta.arg;Jp(e,yp(r))})).addCase(sg.rejected,((e,t)=>{Jp(e,t.meta.arg)})).addCase(lp.fulfilled,((e,t)=>{Xp(e,t.payload,t.meta.requestId)})).addCase(dp.fulfilled,((e,t)=>{eg(e,t.payload,t.meta.requestId,Gh)})).addCase(kp.fulfilled,((e,t)=>{!function(e,t,r,n){if(t.fieldSuggestionsFacets)for(let a of t.fieldSuggestionsFacets)a.facetId in e||"regular"!==a.type||(e[a.facetId]={options:{...ng,query:t.query??""},isLoading:!1,response:n(),initialNumberOfValues:ng.numberOfValues,requestId:r})}(e,t.payload,t.meta.requestId,Gh)})).addCase(sg.fulfilled,((e,t)=>{Zp(e,t.payload,t.meta.requestId)})).addCase(cg,((e,{payload:t})=>{tg(e,t,Gh)})).addCase(_c.fulfilled,(e=>{rg(e,Gh)})).addCase(Cp.fulfilled,(e=>rg(e,Gh))).addCase(Hp.fulfilled,(e=>rg(e,Gh))).addCase(Yh,(e=>rg(e,Gh)))}));function Gh(){return{moreValuesAvailable:!1,values:[]}}var Kh=Ir({},(e=>{e.addCase(Wg,((e,t)=>{let{facetId:r}=t.payload;r in e||(e[r]=function(e){return{request:e,hasBreadcrumbs:!0}}(function(e){return{...Xh,type:"specific",currentValues:[],freezeCurrentValues:!1,isFieldExpanded:!1,preventAutoSelect:!1,...e}}(t.payload)))})).addCase(zs.fulfilled,((e,t)=>{if(t.payload&&0!==Object.keys(t.payload.facetSet).length)return t.payload.facetSet})).addCase(Ps,((e,t)=>{let r=t.payload.f||{},n=t.payload.fExcluded||{};Object.keys(e).forEach((t=>{let{request:a}=e[t],i=r[t]||[],s=n[t]||[],o=i.length+s.length,c=a.currentValues.filter((e=>!i.includes(e.value)&&!s.includes(e.value)));a.currentValues=[...i.map(ty),...s.map(ry),...c.map(ny)],a.preventAutoSelect=o>0,a.numberOfValues=Math.max(o,a.numberOfValues)}))})).addCase(Gg,((e,t)=>{let{facetId:r,selection:n}=t.payload,a=e[r]?.request;if(!a)return;a.preventAutoSelect=!0;let i=a.currentValues.find((e=>e.value===n.value));if(!i)return void Jh(a,n);let s="selected"===i.state;i.state=s?"idle":"selected",a.freezeCurrentValues=!0})).addCase(Kg,((e,t)=>{let{facetId:r,selection:n}=t.payload,a=e[r]?.request;if(!a)return;a.preventAutoSelect=!0;let i=a.currentValues.find((e=>e.value===n.value));if(!i)return void Jh(a,n);let s="excluded"===i.state;i.state=s?"idle":"excluded",a.freezeCurrentValues=!0})).addCase(th,((e,t)=>{let{facetId:r,freezeCurrentValues:n}=t.payload,a=e[r]?.request;a&&(a.freezeCurrentValues=n)})).addCase(Jg,((e,t)=>{Df(e[t.payload]?.request)})).addCase(Ks,(e=>{Object.values(e).filter((e=>e.hasBreadcrumbs)).forEach((({request:e})=>Df(e)))})).addCase(Js,(e=>{Object.values(e).filter((e=>!e.hasBreadcrumbs)).forEach((({request:e})=>Df(e)))})).addCase(Zs,((e,t)=>Object.values(e).forEach((e=>{e.request.preventAutoSelect=!t.payload.allow})))).addCase(Zg,((e,t)=>{Tf(e,t.payload)})).addCase(Xg,((e,t)=>{let{facetId:r,numberOfValues:n}=t.payload;Mf(e[r]?.request,n)})).addCase(eh,((e,t)=>{let{facetId:r,isFieldExpanded:n}=t.payload,a=e[r]?.request;a&&(a.isFieldExpanded=n)})).addCase(_c.fulfilled,((e,t)=>{t.payload.response.facets.forEach((t=>Zh(e[t.facetId]?.request,t)))})).addCase($c.fulfilled,((e,t)=>{t.payload.response.facets.forEach((t=>Zh(e[t.facetId]?.request,t)))})).addCase(pg,((e,t)=>{let{facetId:r,value:n}=t.payload,a=e[r]?.request;if(!a)return;let{rawValue:i}=n,{currentValues:s}=a,o=s.find((e=>e.value===i));o?o.state="selected":(Jh(a,ty(i)),a.freezeCurrentValues=!0,a.preventAutoSelect=!0)})).addCase(gg,((e,t)=>{let{facetId:r,value:n}=t.payload,a=e[r]?.request;if(!a)return;let{rawValue:i}=n,{currentValues:s}=a,o=s.find((e=>e.value===i));o?o.state="excluded":(Jh(a,ry(i)),a.freezeCurrentValues=!0,a.preventAutoSelect=!0)})).addCase(Af,((e,t)=>{if(!(t.payload in e))return;let{request:r}=e[t.payload];Df(r)}))}));function Jh(e,t){let{currentValues:r}=e,n=r.findIndex((e=>"idle"===e.state)),a=-1===n?r.length:n,i=r.slice(0,a),s=r.slice(a+1);e.currentValues=[...i,t,...s],e.numberOfValues=e.currentValues.length}function Zh(e,t){e&&(e.currentValues=t.values.map(ey),e.freezeCurrentValues=!1,e.preventAutoSelect=!1)}var Xh={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"automatic",resultsMustMatch:"atLeastOneValue"};function ey(e){let{value:t,state:r}=e;return{value:t,state:r}}function ty(e){return{value:e,state:"selected"}}function ry(e){return{value:e,state:"excluded"}}function ny(e){return{...e,state:"idle"}}var ay=e=>"selected"===e.state,iy=e=>"excluded"===e.state,sy=(e,t)=>{let r={facetId:e,facetValue:t.value};return ay(t)?Ig(r):bg(r)},oy=e=>ay(e)?Og():Ag(),cy=(e,t)=>{let r={facetId:e,facetValue:t.value};return iy(t)?qg(r):Cg(r)},uy=e=>iy(e)?{actionCause:"facetUnexclude"}:Rg();function ly(e,t){let{dispatch:r}=e,{options:n,select:a,exclude:i,isForFieldSuggestions:s,executeFacetSearchActionCreator:o,executeFieldSuggestActionCreator:c}=t,{facetId:u}=n;r(dg(n));let l=jh(e,{options:n,getFacetSearch:()=>"state"in e?e.state.facetSearchSet[u]:e[Sp].facetSearchSet[u],isForFieldSuggestions:s,executeFacetSearchActionCreator:o,executeFieldSuggestActionCreator:c});return{...l,select(e){r(pg({facetId:u,value:e})),a(e)},exclude(e){r(gg({facetId:u,value:e})),i(e)},singleSelect(e){r(Jg(u)),r(pg({facetId:u,value:e})),a(e)},singleExclude(e){r(Jg(u)),r(gg({facetId:u,value:e})),i(e)},get state(){let{values:e}=l.state;return{...l.state,values:e.map((({count:e,displayValue:t,rawValue:r})=>({count:e,displayValue:t,rawValue:r})))}}}}var dy={facetId:qf,selection:new r({values:Hg})},fy=Ur("facet/executeToggleSelect",(({facetId:e,selection:t},r)=>{let{dispatch:n,extra:{validatePayload:a}}=r;a({facetId:e,selection:t},dy),n(Gg({facetId:e,selection:t})),n(kf())})),py=Ur("facet/executeToggleExclude",(({facetId:e,selection:t},r)=>{let{dispatch:n,extra:{validatePayload:a}}=r;a({facetId:e,selection:t},dy),n(Kg({facetId:e,selection:t})),n(kf())})),gy=["allValues","atLeastOneValue"],hy=["score","alphanumeric","alphanumericDescending","occurrences","automatic"],yy=new o({facetId:Eg,tabs:new r({options:{required:!1},values:{included:new t({each:new e}),excluded:new t({each:new e})}}),field:Tg,filterFacetCount:jg,injectionDepth:Vg,numberOfValues:_g,sortCriteria:new e({constrainTo:hy}),resultsMustMatch:new e({constrainTo:gy}),facetSearch:Lg});function my(e,t,r=yy){!function(e){e.addReducers({facetSet:Kh,facetOptions:Rh,configuration:ad,facetSearchSet:Wh})}(e);let{dispatch:n}=e,a=Td(e),i=Dh(e,t.options),s=t.options.tabs??{},o=Fh(e.state.tabSet),c={...Xh,...Y("facetSearch",t.options),field:t.options.field,facetId:i,tabs:s,activeTab:o},u={facetSearch:{...ng,...t.options.facetSearch},...c};We(e,r,u,"buildFacet");let l=()=>ui(e.state,i),d=()=>{let{currentValues:e}=l(),t=u.numberOfValues,r=!!e.find((e=>"idle"===e.state));return t<e.length&&r};return n(Wg(c)),{...a,toggleSelect:e=>n(fy({facetId:u.facetId,selection:e})),toggleExclude:e=>n(py({facetId:u.facetId,selection:e})),toggleSingleSelect:function(e){"idle"===e.state&&n(Jg(i)),this.toggleSelect(e)},toggleSingleExclude:function(e){"idle"===e.state&&n(Jg(i)),this.toggleExclude(e)},isValueSelected:ay,isValueExcluded:iy,deselectAll(){n(Jg(i)),n(kf())},sortBy(e){n(Zg({facetId:i,criterion:e})),n(kf())},isSortedBy(e){return this.state.sortCriterion===e},showMoreValues(){let e=l().numberOfValues,t=u.numberOfValues;n(Xg({facetId:i,numberOfValues:e+(t-e%t)})),n(eh({facetId:i,isFieldExpanded:!0})),n(kf())},showLessValues(){let e=u.numberOfValues,t=Math.max(e,(()=>{let{currentValues:e}=l();return e.filter((e=>"idle"!==e.state)).length})());n(Xg({facetId:i,numberOfValues:t})),n(eh({facetId:i,isFieldExpanded:!1})),n(kf())},enable(){n(xf(i))},disable(){n(Af(i))},get state(){let t,r=l(),n=li(e.state,i),a=pi(e.state),o=Fg(e.state,i);t="object"==typeof r.sortCriteria?"descending"===r.sortCriteria.order?"alphanumericDescending":"alphanumeric":r.sortCriteria;let c=n?n.values:[],u=c.some((e=>"idle"!==e.state)),f=!!n&&n.moreValuesAvailable,p=r.resultsMustMatch;return{label:n?.label,facetId:i,tabs:s,values:c,sortCriterion:t,resultsMustMatch:p,isLoading:a,hasActiveValues:u,canShowMoreValues:f,canShowLessValues:d(),enabled:o}}}}var vy=new o({facetId:Eg,field:Tg,tabs:new r({options:{required:!1},values:{included:new t({each:new e}),excluded:new t({each:new e})}}),filterFacetCount:jg,injectionDepth:Vg,numberOfValues:_g,sortCriteria:new e({constrainTo:hy}),resultsMustMatch:new e({constrainTo:gy}),facetSearch:Lg,allowedValues:Ng,hasBreadcrumbs:Bg,customSort:zg});function Sy(e,t){!function(e){e.addReducers({facetSet:Kh,configuration:ad,facetSearchSet:Wh,search:tu})}(e);let{dispatch:r}=e,n=my(e,{...t,options:{...t.options,...t.options.allowedValues&&{allowedValues:{type:"simple",values:t.options.allowedValues}}}},vy),a=()=>n.state.facetId,i=(()=>{let{facetSearch:n}=t.options;return ly(e,{options:{facetId:a(),...n},select:e=>{r(kf()),r(_c({legacy:bg({facetId:a(),facetValue:e.rawValue}),next:Ag()}))},exclude:e=>{r(kf()),r(_c({legacy:Cg({facetId:a(),facetValue:e.rawValue}),next:Rg()}))},isForFieldSuggestions:!1,executeFacetSearchActionCreator:sg,executeFieldSuggestActionCreator:og})})(),{state:s,...o}=i;return{...n,facetSearch:o,toggleSelect(e){n.toggleSelect(e),r(_c({legacy:sy(a(),e),next:oy(e)}))},toggleExclude(e){n.toggleExclude(e),r(_c({legacy:cy(a(),e),next:uy(e)}))},deselectAll(){n.deselectAll(),r(_c({legacy:wg(a()),next:xg()}))},sortBy(e){n.sortBy(e),r(_c({legacy:Sg({facetId:a(),criterion:e}),next:{actionCause:"facetUpdateSort"}}))},isSortedBy(e){return this.state.sortCriterion===e},showMoreValues(){n.showMoreValues(),r($c({legacy:mg(a())}))},showLessValues(){n.showLessValues(),r($c({legacy:vg(a())}))},get state(){return{...n.state,facetSearch:i.state}}}}var wy=e=>"selected"===e.state,by=e=>"excluded"===e.state,Cy=(e,t)=>{let r={facetId:e,facetValue:`${t.start}..${t.end}`};return wy(t)?Ig(r):bg(r)},Iy=e=>wy(e)?Og():Ag(),qy=(e,t)=>{let r={facetId:e,facetValue:`${t.start}..${t.end}`};return by(t)?qg(r):Cg(r)},ky=dr("rangeFacet/executeToggleSelect",(e=>He(e,oh(e.selection)))),xy=dr("rangeFacet/executeToggleExclude",(e=>He(e,oh(e.selection)))),Ay={facetId:qf,selection:new r({values:sh})},Ry=Ur("dateFacet/executeToggleSelect",((e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,Ay),t(ph(e)),t(ky(e)),t(kf())})),Oy=Ur("dateFacet/executeToggleExclude",((e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,Ay),t(gh(e)),t(xy(e)),t(kf())})),Fy={filterFacetCount:!0,injectionDepth:1e3,numberOfValues:8,sortCriteria:"ascending",rangeAlgorithm:"even",resultsMustMatch:"atLeastOneValue"};function Ey(e,t){let{request:r}=t,{facetId:n}=r;if(n in e)return;let a=Uy(r);r.numberOfValues=a,e[n]=t}function Ty(e,t,r){let n=e[t]?.request;n&&(n.currentValues=r,n.numberOfValues=Uy(n))}function Dy(e,t,r){let n=e[t]?.request;if(!n)return;let a=_y(n.currentValues,r);if(!a)return;let i="selected"===a.state;a.state=i?"idle":"selected",n.preventAutoSelect=!0}function My(e,t,r){let n=e[t]?.request;if(!n)return;let a=_y(n.currentValues,r);if(!a)return;let i="excluded"===a.state;a.state=i?"idle":"excluded",n.preventAutoSelect=!0}function Py(e,t){let r=e[t]?.request;r&&r.currentValues.forEach((e=>e.state="idle"))}function jy(e,t){Object.entries(e).forEach((([e,{request:r}])=>{let n=t[e]||[];r.currentValues.forEach((e=>{let t=!!_y(n,e);return e.state=t?"selected":"idle",e}));let a=n.filter((e=>!_y(r.currentValues,e))),i=r.currentValues;i.push(...a),r.numberOfValues=Math.max(r.numberOfValues,i.length)}))}function Vy(e,t,r){t.forEach((t=>{let n=t.facetId,a=e[n]?.request;if(!a)return;let i=r(t.values);a.currentValues=i,a.preventAutoSelect=!1}))}function _y(e,t){let{start:r,end:n}=t;return e.find((e=>e.start===r&&e.end===n))}function Uy(e){let{generateAutomaticRanges:t,currentValues:r,numberOfValues:n}=e;return t?Math.max(n,r.length):r.length}var Qy=Ir({},(e=>{e.addCase(fh,((e,t)=>{let{payload:r}=t,n=function(e){return{...Fy,currentValues:[],preventAutoSelect:!1,type:"dateRange",...e}}(r);Ey(e,function(e){return{request:e}}(n))})).addCase(zs.fulfilled,((e,t)=>t.payload?.dateFacetSet??e)).addCase(Ps,((e,t)=>{jy(e,t.payload.df||{})})).addCase(ph,((e,t)=>{let{facetId:r,selection:n}=t.payload;Dy(e,r,n)})).addCase(gh,((e,t)=>{let{facetId:r,selection:n}=t.payload;My(e,r,n)})).addCase(hh,((e,t)=>{let{facetId:r,values:n}=t.payload;Ty(e,r,n)})).addCase(mh,((e,t)=>{Py(e,t.payload)})).addCase(Ks,(e=>{Object.keys(e).forEach((t=>{Py(e,t)}))})).addCase(yh,((e,t)=>{Tf(e,t.payload)})).addCase(_c.fulfilled,((e,t)=>{Vy(e,t.payload.response.facets,$y)})).addCase(Af,((e,t)=>{Py(e,t.payload)}))}));function $y(e){return e.map((e=>{let{numberOfResults:t,...r}=e;return r}))}function Ly(e,t){let{facetId:r,getRequest:n}=t,a=Td(e),i=e.dispatch;return{...a,isValueSelected:wy,isValueExcluded:by,deselectAll(){i(Jg(r)),i(kf())},sortBy(e){i(ah({facetId:r,criterion:e})),i(kf())},isSortedBy(e){return this.state.sortCriterion===e},enable(){i(xf(r))},disable(){i(Af(r))},get state(){let t=n(),a=ci(e.state,r),i=t.sortCriteria,s=t.resultsMustMatch,o=a?a.values:[],c=pi(e.state),u=Fg(e.state,r),l=o.some((e=>"idle"!==e.state));return{facetId:r,values:o,sortCriterion:i,resultsMustMatch:s,hasActiveValues:l,isLoading:c,enabled:u}}}}function Ny(e,t){if(!e.generateAutomaticRanges&&void 0===e.currentValues){throw new Error(`currentValues should be specified for ${t} when generateAutomaticRanges is false.`)}}var By=["idle","selected","excluded"],zy=["ascending","descending"],Hy=["even","equiprobable"],Yy={start:new e,end:new e,endInclusive:new a,state:new e({constrainTo:By})},Wy=new o({facetId:Eg,field:Tg,tabs:new r({options:{required:!1},values:{included:new t({each:new e}),excluded:new t({each:new e})}}),generateAutomaticRanges:Ug,filterFacetCount:jg,injectionDepth:Vg,numberOfValues:_g,currentValues:new t({each:new r({values:Yy})}),sortCriteria:new e({constrainTo:zy}),rangeAlgorithm:new e({constrainTo:Hy})});function Gy(e,t){We(e,Wy,t,"buildDateFacet"),dh(t)}function Ky(e,t){!function(e){e.addReducers({configuration:ad,search:tu,dateFacetSet:Qy,facetOptions:Rh})}(e),Ny(t.options,"buildDateFacet");let r=e.dispatch,n=Dh(e,t.options),a=t.options.tabs??{},i=Fh(e.state.tabSet),s={currentValues:[],...t.options,facetId:n,tabs:a,activeTab:i};Gy(e,s),r(fh(s));let o=Ly(e,{facetId:n,getRequest:()=>e.state.dateFacetSet[n].request});return{...o,toggleSelect:e=>r(Ry({facetId:n,selection:e})),toggleSingleSelect:function(e){"idle"===e.state&&r(Jg(n)),this.toggleSelect(e)},toggleExclude:e=>r(Oy({facetId:n,selection:e})),toggleSingleExclude:function(e){"idle"===e.state&&r(Jg(n)),this.toggleExclude(e)},get state(){return o.state}}}function Jy(e,t){let r=Ky(e,t),n=e.dispatch,a=()=>r.state.facetId;return{...r,deselectAll(){r.deselectAll(),n(_c({legacy:wg(a()),next:xg()}))},sortBy(e){r.sortBy(e),n(_c({legacy:Sg({facetId:a(),criterion:e}),next:{actionCause:"facetUpdateSort"}}))},toggleSelect:e=>{r.toggleSelect(e),n(_c({legacy:Cy(a(),e),next:Iy(e)}))},toggleExclude:e=>{r.toggleExclude(e),n(_c({legacy:qy(a(),e)}))},get state(){return r.state}}}var Zy=Ir({},(e=>{e.addCase(bh,((e,t)=>{let{payload:r}=t,n=function(e){return{...Fy,currentValues:[],preventAutoSelect:!1,type:"numericalRange",...e}}(r);Ey(e,function(e){return{request:e}}(n))})).addCase(zs.fulfilled,((e,t)=>t.payload?.numericFacetSet??e)).addCase(Ps,((e,t)=>{jy(e,t.payload.nf||{})})).addCase(Ch,((e,t)=>{let{facetId:r,selection:n}=t.payload;Dy(e,r,n)})).addCase(Ih,((e,t)=>{let{facetId:r,selection:n}=t.payload;My(e,r,n)})).addCase(qh,((e,t)=>{let{facetId:r,values:n}=t.payload;Ty(e,r,n)})).addCase(xh,((e,t)=>{Py(e,t.payload)})).addCase(Ks,(e=>{Object.keys(e).forEach((t=>{Py(e,t)}))})).addCase(kh,((e,t)=>{Tf(e,t.payload)})).addCase(_c.fulfilled,((e,t)=>{Vy(e,t.payload.response.facets,Xy)})).addCase(Af,((e,t)=>{Py(e,t.payload)}))}));function Xy(e){return e.map((e=>{let{numberOfResults:t,...r}=e;return r}))}var em={facetId:qf,selection:new r({values:ih})},tm=Ur("numericFacet/executeToggleSelect",((e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,em),t(Ch(e)),t(ky(e)),t(kf())}));Ur("numericFacet/executeToggleExclude",((e,{dispatch:t,extra:{validatePayload:r}})=>{r(e,em),t(Ih(e)),t(xy(e)),t(kf())}));var rm={start:new s,end:new s,endInclusive:new a,state:new e({constrainTo:By})},nm=new o({facetId:Eg,tabs:new r({options:{required:!1},values:{included:new t({each:new e}),excluded:new t({each:new e})}}),field:Tg,generateAutomaticRanges:Ug,filterFacetCount:jg,injectionDepth:Vg,numberOfValues:_g,currentValues:new t({each:new r({values:rm})}),sortCriteria:new e({constrainTo:zy}),resultsMustMatch:new e({constrainTo:gy}),rangeAlgorithm:new e({constrainTo:Hy})});function am(e,t){We(e,nm,t,"buildNumericFacet"),wh(t)}function im(e){return{endInclusive:!1,state:"idle",...e}}function sm(e,t){!function(e){e.addReducers({numericFacetSet:Zy,facetOptions:Rh,configuration:ad,search:tu})}(e),Ny(t.options,"buildNumericFacet");let r=e.dispatch,n=Dh(e,t.options),a=t.options.tabs??{},i=Fh(e.state.tabSet),s={currentValues:[],...t.options,facetId:n,tabs:a,activeTab:i};am(e,s),r(bh(s));let o=Ly(e,{facetId:n,getRequest:()=>e.state.numericFacetSet[n].request});return{...o,toggleSelect:e=>r(tm({facetId:n,selection:e})),toggleSingleSelect(e){"idle"===e.state&&r(Jg(n)),this.toggleSelect(e)},get state(){return o.state}}}function om(e,t){!function(e){e.addReducers({numericFacetSet:Zy,configuration:ad,search:tu})}(e);let r=sm(e,t),n=e.dispatch,a=()=>r.state.facetId;return{...r,deselectAll(){r.deselectAll(),n(_c({legacy:wg(a()),next:xg()}))},sortBy(e){r.sortBy(e),n(_c({legacy:Sg({facetId:a(),criterion:e}),next:{actionCause:"facetUpdateSort"}}))},toggleSelect:e=>{r.toggleSelect(e),n(_c({legacy:Cy(a(),e),next:Iy(e)}))},get state(){return{...r.state}}}}var cm=(e,t)=>{let r=ci(e,t);if(function(e,t){return!!t&&t.facetId in e.numericFacetSet}(e,r))return r},um=(e,t)=>(cm(e,t)||{values:[]}).values.filter((e=>"idle"!==e.state)),lm=(e,t)=>(cm(e,t)||{values:[]}).values.filter((e=>"selected"===e.state));function dm(e,t){!function(e){e.addReducers({numericFacetSet:Zy,facetOptions:Rh,configuration:ad,search:tu})}(e);let r=Td(e),{dispatch:n}=e,a=()=>e.state,i=Dh(e,t.options),s=t.options.tabs??{},o=Fh(e.state.tabSet),c={...t.options,currentValues:t.initialState?.range?[{...t.initialState.range,endInclusive:!0,state:"selected"}]:[],generateAutomaticRanges:!1,facetId:i,tabs:s,activeTab:o};am(e,c),n(bh(c));return{...r,clear:()=>{n(qh({facetId:i,values:[]})),n(kf())},setRange:e=>{let t={...e,state:"selected",numberOfResults:0,endInclusive:!0},r=qh({facetId:i,values:[t]});return!r.error&&(n(r),n(kf()),!0)},enable(){n(xf(i))},disable(){n(Af(i))},get state(){let t=pi(a()),r=Fg(e.state,i),n=lm(a(),i),s=n.length?n[0]:void 0;return{facetId:i,isLoading:t,range:s,enabled:r}}}}function fm(e,t){!function(e){e.addReducers({numericFacetSet:Zy,configuration:ad,search:tu})}(e);let r=dm(e,t),{dispatch:n}=e,a=()=>r.state.facetId;return{...r,clear:()=>{r.clear(),n(_c({legacy:wg(a()),next:xg()}))},setRange:e=>{let t=r.setRange(e);return t&&n(_c({legacy:bg({facetId:a(),facetValue:`${e.start}..${e.end}`}),next:Ag()})),t},get state(){return{...r.state}}}}var pm=(e,t)=>{let r=ci(e,t);if(function(e,t){return!!t&&t.facetId in e.dateFacetSet}(e,r))return r},gm=(e,t)=>(pm(e,t)||{values:[]}).values.filter((e=>"selected"===e.state)),hm=(e,t)=>(pm(e,t)||{values:[]}).values.filter((e=>"idle"!==e.state));function ym(e,t){!function(e){e.addReducers({dateFacetSet:Qy,facetOptions:Rh,configuration:ad,search:tu})}(e);let r=Td(e),{dispatch:n}=e,a=()=>e.state,i=Dh(e,t.options),s=t.options.tabs??{},o=Fh(e.state.tabSet),c={...t.options,currentValues:t.initialState?.range?[{...t.initialState.range,endInclusive:!0,state:"selected"}]:[],generateAutomaticRanges:!1,facetId:i,tabs:s,activeTab:o};Gy(e,c),n(fh(c));return{...r,clear:()=>{n(hh({facetId:i,values:[]})),n(kf())},setRange:e=>{let t={...e,state:"selected",numberOfResults:0,endInclusive:!0},r=hh({facetId:i,values:[t]});return!r.error&&(n(r),n(kf()),!0)},enable(){n(xf(i))},disable(){n(Af(i))},get state(){let t=pi(a()),r=Fg(e.state,i),n=gm(a(),i),s=n.length?n[0]:void 0;return{facetId:i,isLoading:t,range:s,enabled:r}}}}function mm(e,t){!function(e){e.addReducers({dateFacetSet:Qy,configuration:ad,search:tu})}(e);let r=ym(e,t),{dispatch:n}=e,a=()=>r.state.facetId;return{...r,clear:()=>{r.clear(),n(_c({legacy:wg(a()),next:xg()}))},setRange:e=>{let t=r.setRange(e);return t&&n(_c({legacy:bg({facetId:a(),facetValue:`${e.start}..${e.end}`}),next:Ag()})),t},get state(){return{...r.state}}}}var vm={f:new r,lf:new r,cf:new r,nf:new r,mnf:new r,df:new r,sortCriteria:new r,page:new s({min:0}),perPage:new s({min:1})},Sm=dr("commerce/productListingParameters/restore",(e=>He(e,vm))),wm={q:new e,...vm},bm=dr("commerce/searchParameters/restore",(e=>He(e,wm))),Cm=Ir([],(e=>{e.addCase(_c.fulfilled,Im).addCase(Cp.fulfilled,Im).addCase(Hp.fulfilled,Im).addCase(bm,qm).addCase(Sm,qm).addCase(zs.fulfilled,((e,t)=>t.payload?.facetOrder??e)).addCase(Yh,(()=>[])).addCase(Hh,(()=>[]))}));function Im(e,t){return t.payload.response.facets.map((e=>e.facetId))}function qm(e,t){return[...Object.keys(t.payload.f??{}),...Object.keys(t.payload.lf??{}),...Object.keys(t.payload.nf??{}),...Object.keys(t.payload.df??{}),...Object.keys(t.payload.cf??{}),...Object.keys(t.payload.mnf??{})]}var km=()=>ns("history/analytics/forward",(e=>e.makeSearchEvent("historyForward"))),xm=()=>ns("history/analytics/backward",(e=>e.makeSearchEvent("historyBackward"))),Am=()=>ns("history/analytics/noresultsback",(e=>e.makeNoResultsBack())),Rm=e=>({past:[],present:e,future:[]}),Om=Object.getOwnPropertyNames,Fm=Object.getOwnPropertySymbols,Em=Object.prototype.hasOwnProperty;function Tm(e,t){return function(r,n,a){return e(r,n,a)&&t(r,n,a)}}function Dm(e){return function(t,r,n){if(!t||!r||"object"!=typeof t||"object"!=typeof r)return e(t,r,n);var a=n.cache,i=a.get(t),s=a.get(r);if(i&&s)return i===r&&s===t;a.set(t,r),a.set(r,t);var o=e(t,r,n);return a.delete(t),a.delete(r),o}}function Mm(e){return Om(e).concat(Fm(e))}var Pm=Object.hasOwn||function(e,t){return Em.call(e,t)};function jm(e,t){return e||t?e===t:e===t||e!=e&&t!=t}var Vm="_owner",_m=Object.getOwnPropertyDescriptor,Um=Object.keys;function Qm(e,t,r){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function $m(e,t){return jm(e.getTime(),t.getTime())}function Lm(e,t,r){if(e.size!==t.size)return!1;for(var n,a,i={},s=e.entries(),o=0;(n=s.next())&&!n.done;){for(var c=t.entries(),u=!1,l=0;(a=c.next())&&!a.done;){var d=n.value,f=d[0],p=d[1],g=a.value,h=g[0],y=g[1];!u&&!i[l]&&(u=r.equals(f,h,o,l,e,t,r)&&r.equals(p,y,f,h,e,t,r))&&(i[l]=!0),l++}if(!u)return!1;o++}return!0}function Nm(e,t,r){var n,a=Um(e),i=a.length;if(Um(t).length!==i)return!1;for(;i-- >0;)if((n=a[i])===Vm&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!Pm(t,n)||!r.equals(e[n],t[n],n,n,e,t,r))return!1;return!0}function Bm(e,t,r){var n,a,i,s=Mm(e),o=s.length;if(Mm(t).length!==o)return!1;for(;o-- >0;)if((n=s[o])===Vm&&(e.$$typeof||t.$$typeof)&&e.$$typeof!==t.$$typeof||!Pm(t,n)||!r.equals(e[n],t[n],n,n,e,t,r)||(a=_m(e,n),i=_m(t,n),(a||i)&&(!a||!i||a.configurable!==i.configurable||a.enumerable!==i.enumerable||a.writable!==i.writable)))return!1;return!0}function zm(e,t){return jm(e.valueOf(),t.valueOf())}function Hm(e,t){return e.source===t.source&&e.flags===t.flags}function Ym(e,t,r){if(e.size!==t.size)return!1;for(var n,a,i={},s=e.values();(n=s.next())&&!n.done;){for(var o=t.values(),c=!1,u=0;(a=o.next())&&!a.done;)!c&&!i[u]&&(c=r.equals(n.value,a.value,n.value,a.value,e,t,r))&&(i[u]=!0),u++;if(!c)return!1}return!0}function Wm(e,t){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(e[r]!==t[r])return!1;return!0}var Gm="[object Arguments]",Km="[object Boolean]",Jm="[object Date]",Zm="[object Map]",Xm="[object Number]",ev="[object Object]",tv="[object RegExp]",rv="[object Set]",nv="[object String]",av=Array.isArray,iv="function"==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView:null,sv=Object.assign,ov=Object.prototype.toString.call.bind(Object.prototype.toString);function cv(e){void 0===e&&(e={});var t=e.circular,r=void 0!==t&&t,n=e.createInternalComparator,a=e.createState,i=e.strict,s=void 0!==i&&i,o=function(e){var t=e.circular,r=e.createCustomConfig,n=e.strict,a={areArraysEqual:n?Bm:Qm,areDatesEqual:$m,areMapsEqual:n?Tm(Lm,Bm):Lm,areObjectsEqual:n?Bm:Nm,arePrimitiveWrappersEqual:zm,areRegExpsEqual:Hm,areSetsEqual:n?Tm(Ym,Bm):Ym,areTypedArraysEqual:n?Bm:Wm};if(r&&(a=sv({},a,r(a))),t){var i=Dm(a.areArraysEqual),s=Dm(a.areMapsEqual),o=Dm(a.areObjectsEqual),c=Dm(a.areSetsEqual);a=sv({},a,{areArraysEqual:i,areMapsEqual:s,areObjectsEqual:o,areSetsEqual:c})}return a}(e),c=function(e){var t=e.areArraysEqual,r=e.areDatesEqual,n=e.areMapsEqual,a=e.areObjectsEqual,i=e.arePrimitiveWrappersEqual,s=e.areRegExpsEqual,o=e.areSetsEqual,c=e.areTypedArraysEqual;return function(e,u,l){if(e===u)return!0;if(null==e||null==u||"object"!=typeof e||"object"!=typeof u)return e!=e&&u!=u;var d=e.constructor;if(d!==u.constructor)return!1;if(d===Object)return a(e,u,l);if(av(e))return t(e,u,l);if(null!=iv&&iv(e))return c(e,u,l);if(d===Date)return r(e,u,l);if(d===RegExp)return s(e,u,l);if(d===Map)return n(e,u,l);if(d===Set)return o(e,u,l);var f=ov(e);return f===Jm?r(e,u,l):f===tv?s(e,u,l):f===Zm?n(e,u,l):f===rv?o(e,u,l):f===ev?"function"!=typeof e.then&&"function"!=typeof u.then&&a(e,u,l):f===Gm?a(e,u,l):(f===Km||f===Xm||f===nv)&&i(e,u,l)}}(o),u=n?n(c):function(e){return function(t,r,n,a,i,s,o){return e(t,r,o)}}(c);return function(e){var t=e.circular,r=e.comparator,n=e.createState,a=e.equals,i=e.strict;if(n)return function(e,s){var o=n(),c=o.cache,u=void 0===c?t?new WeakMap:void 0:c,l=o.meta;return r(e,s,{cache:u,equals:a,meta:l,strict:i})};if(t)return function(e,t){return r(e,t,{cache:new WeakMap,equals:a,meta:void 0,strict:i})};var s={cache:void 0,equals:a,meta:void 0,strict:i};return function(e,t){return r(e,t,s)}}({circular:r,comparator:c,createState:a,equals:u,strict:s})}function uv(e,t,r=((e,t)=>e===t)){return e.length===t.length&&-1===e.findIndex(((e,n)=>!r(t[n],e)))}function lv(e,t){return e.length===t.length&&e.every((e=>-1!==t.findIndex((t=>dv(e,t)))))}cv(),cv({strict:!0}),cv({circular:!0}),cv({circular:!0,strict:!0}),cv({createInternalComparator:function(){return jm}}),cv({strict:!0,createInternalComparator:function(){return jm}}),cv({circular:!0,createInternalComparator:function(){return jm}}),cv({circular:!0,createInternalComparator:function(){return jm},strict:!0});var dv=cv({createCustomConfig:e=>({...e,areArraysEqual:lv})}),fv=Ir(tc({}),(e=>{e.addCase(Ls,((e,t)=>pv(e,t.payload)?void 0:t.payload))})),pv=(e,t)=>gv(e.context,t.context)&&hv(e.dictionaryFieldContext,t.dictionaryFieldContext)&&kv(e.advancedSearchQueries,t.advancedSearchQueries)&&yv(e.tabSet,t.tabSet)&&vv(e.staticFilterSet,t.staticFilterSet)&&wv(e.facetSet,t.facetSet)&&wv(e.dateFacetSet,t.dateFacetSet)&&wv(e.numericFacetSet,t.numericFacetSet)&&Cv(e.automaticFacetSet,t.automaticFacetSet)&&bv(e.categoryFacetSet,t.categoryFacetSet)&&Iv(e.pagination,t.pagination)&&qv(e.query,t.query)&&xv(e,t)&&Av(e.pipeline,t.pipeline)&&Rv(e.searchHub,t.searchHub)&&Ov(e.facetOrder,t.facetOrder)&&Fv(e.debug,t.debug),gv=(e,t)=>JSON.stringify(e.contextValues)===JSON.stringify(t.contextValues),hv=(e,t)=>JSON.stringify(e.contextValues)===JSON.stringify(t.contextValues),yv=(e,t)=>{let r=mv(e),n=mv(t);return r?.id===n?.id},mv=e=>Object.values(e).find((e=>e.isActive)),vv=(e,t)=>{for(let[r,n]of Object.entries(t)){if(!e[r])return!1;let t=Sv(e[r]),a=Sv(n);if(JSON.stringify(t)!==JSON.stringify(a))return!1}return!0},Sv=e=>e.values.filter((e=>"idle"!==e.state)),wv=(e,t)=>{for(let[r,n]of Object.entries(t)){if(!e[r])return!1;let t=e[r].request.currentValues.filter((e=>"idle"!==e.state)),a=n.request.currentValues.filter((e=>"idle"!==e.state));if(JSON.stringify(t)!==JSON.stringify(a))return!1}return!0},bv=(e,t)=>{for(let[r,n]of Object.entries(t)){if(!e[r])return!1;let t=gi(e[r]?.request.currentValues).map((({value:e})=>e)),a=gi(n?.request.currentValues).map((({value:e})=>e));if(JSON.stringify(t)!==JSON.stringify(a))return!1}return!0},Cv=(e,t)=>{for(let[r,n]of Object.entries(t.set)){if(!e.set[r])return!1;let t=e.set[r].response.values.filter((e=>"idle"!==e.state)),a=n.response.values.filter((e=>"idle"!==e.state));if(JSON.stringify(t)!==JSON.stringify(a))return!1}return!0},Iv=(e,t)=>e.firstResult===t.firstResult&&e.numberOfResults===t.numberOfResults,qv=(e,t)=>JSON.stringify(e)===JSON.stringify(t),kv=(e,t)=>JSON.stringify(e)===JSON.stringify(t),xv=(e,t)=>e.sortCriteria===t.sortCriteria,Av=(e,t)=>e===t,Rv=(e,t)=>e===t,Ov=(e,t)=>uv(e,t),Fv=(e,t)=>e===t,Ev=(e=>{let{actionTypes:t,reducer:r}=e,n=Rm();return(e=n,a)=>{switch(a.type){case t.undo:return(e=>{let{past:t,present:r,future:n}=e;if(!r||0===t.length)return e;let a=t[t.length-1];return{past:t.slice(0,t.length-1),present:a,future:[r,...n]}})(e);case t.redo:return(e=>{let{past:t,present:r,future:n}=e;return r&&0!==n.length?{past:[...t,r],present:n[0],future:n.slice(1)}:e})(e);case t.snapshot:return(e=>{let{action:t,state:r,reducer:n}=e,{past:a,present:i}=r,s=n(i,t);return i?i===s?r:{past:[...a,i].slice(-10),present:s,future:[]}:Rm(s)})({state:e,reducer:r,action:a});default:return e}}})({actionTypes:{redo:$s.type,undo:Qs.type,snapshot:Ls.type},reducer:fv});function Tv(e){!function(e){e.addReducers({history:Ev,configuration:ad,facetOrder:Cm})}(e);let t=Td(e),{dispatch:r}=e,n=()=>e.state,a=e=>e.past.length>0&&!c(e.present);return{...t,subscribe(t){t();let r=JSON.stringify(n().history.present);return e.subscribe((()=>(()=>{let e=JSON.stringify(n().history.present);r!==e&&(r=e,t())})()))},get state(){return n().history},async back(){a(this.state)&&(await r(Ns()),r(_c({legacy:xm(),next:{actionCause:"historyBackward"}})))},async forward(){!this.state.future.length||!this.state.present||(await r(Bs()),r(_c({legacy:km(),next:{actionCause:"historyForward"}})))},async backOnNoResults(){a(this.state)&&(await r(Ns()),r(_c({legacy:Am(),next:{actionCause:"noResultsBack"}})))}}}var Dv=new s({min:1,default:8,required:!1}),Mv={desiredCount:new s({min:1,max:20,default:5,required:!1}),numberOfValues:Dv},Pv=dr("automaticFacet/setOptions",(e=>He(e,Mv))),jv=dr("automaticFacet/deselectAll",(e=>He(e,qf))),Vv=_e,_v=dr("automaticFacet/toggleSelectValue",(e=>He(e,{field:Vv,selection:new r({values:Hg})}))),Uv=Ir({firstResult:0,defaultNumberOfResults:10,numberOfResults:10,totalCountFiltered:0},(e=>{e.addCase(so,((e,t)=>{let r=$v(e),n=t.payload;e.defaultNumberOfResults=e.numberOfResults=n,e.firstResult=Lv(r,n)})).addCase(oo,((e,t)=>{e.numberOfResults=t.payload,e.firstResult=0})).addCase(Zl,(e=>{e.firstResult=0})).addCase(co,((e,t)=>{let r=t.payload;e.firstResult=Lv(r,e.numberOfResults)})).addCase(uo,((e,t)=>{let r=t.payload;e.firstResult=Lv(r,e.numberOfResults)})).addCase(fo,(e=>{let t=$v(e),r=Math.max(t-1,1);e.firstResult=Lv(r,e.numberOfResults)})).addCase(lo,(e=>{let t=$v(e),r=function(e){let{totalCountFiltered:t,numberOfResults:r}=e;return Bv(t,r)}(e),n=Math.min(t+1,r);e.firstResult=Lv(n,e.numberOfResults)})).addCase(zs.fulfilled,((e,t)=>{t.payload&&(e.numberOfResults=t.payload.pagination.numberOfResults,e.firstResult=t.payload.pagination.firstResult)})).addCase(Ps,((e,t)=>{e.firstResult=t.payload.firstResult??e.firstResult,e.numberOfResults=t.payload.numberOfResults??e.defaultNumberOfResults})).addCase(_c.fulfilled,((e,t)=>{let{response:r}=t.payload;e.totalCountFiltered=r.totalCountFiltered})).addCase(Jg,(e=>{Qv(e)})).addCase(gh,(e=>{Qv(e)})).addCase(Kg,(e=>{Qv(e)})).addCase(Ih,(e=>{Qv(e)})).addCase(gg,(e=>{Qv(e)})).addCase(Gg,(e=>{Qv(e)})).addCase(Nf,(e=>{Qv(e)})).addCase(Lf,(e=>{Qv(e)})).addCase(Ff,(e=>{Qv(e)})).addCase(ph,(e=>{Qv(e)})).addCase(Ch,(e=>{Qv(e)})).addCase(Ks,(e=>{Qv(e)})).addCase(hh,(e=>{Qv(e)})).addCase(qh,(e=>{Qv(e)})).addCase(pg,(e=>{Qv(e)})).addCase(_v,(e=>{Qv(e)}))}));function Qv(e){e.firstResult=0}function $v(e){let{firstResult:t,numberOfResults:r}=e;return Nv(t,r)}function Lv(e,t){return(e-1)*t}function Nv(e,t){return Math.round(e/t)+1}function Bv(e,t){let r=Math.min(e,5e3);return Math.ceil(r/t)}function zv(e){return e.pagination.numberOfResults}var Hv=e=>{let t=function(e){return e.pagination.firstResult}(e);return Nv(t,zv(e))},Yv=e=>{let t=function(e){return e.pagination.totalCountFiltered}(e);return Bv(t,zv(e))},Wv=(e,t)=>{let r=Hv(e),n=Yv(e),a=function(e,t){let r=t%2==0,n=Math.floor(t/2),a=r?n-1:n,i=e-n,s=e+a;return{start:i,end:s}}(r,t);return a=function(e){let t=Math.max(1-e.start,0),r=e.start+t,n=e.end+t;return{start:r,end:n}}(a),a=function(e,t){let r=Math.max(e.end-t,0),n=Math.max(e.start-r,1),a=e.end-r;return{start:n,end:a}}(a,n),function(e){let t=[];for(let r=e.start;r<=e.end;++r)t.push(r);return t}(a)};var Gv=()=>ns("analytics/pager/resize",((e,t)=>e.makePagerResize({currentResultsPerPage:t.pagination?.numberOfResults||10}))),Kv=()=>ns("analytics/pager/number",((e,t)=>e.makePagerNumber({pagerNumber:Hv(t)}))),Jv=()=>ns("analytics/pager/next",((e,t)=>e.makePagerNext({pagerNumber:Hv(t)}))),Zv=()=>ns("analytics/pager/previous",((e,t)=>e.makePagerPrevious({pagerNumber:Hv(t)}))),Xv=new o({numberOfPages:new s({default:5,min:0})}),eS=new o({page:new s({min:1})});function tS(e,t={}){!function(e){e.addReducers({configuration:ad,pagination:Uv})}(e);let r=Td(e),{dispatch:n}=e,a=We(e,Xv,t.options,"buildPager"),i=Ye(e,eS,t.initialState,"buildPager").page;i&&n(co(i));let s=()=>{let{numberOfPages:t}=a;return Wv(e.state,t)};return{...r,get state(){let t=Hv(e.state),r=Yv(e.state),n=t>1&&r>0,a=t<r;return{currentPage:t,currentPages:s(),maxPage:r,hasPreviousPage:n,hasNextPage:a}},selectPage(e){n(uo(e))},nextPage(){n(lo())},previousPage(){n(fo())},isCurrentPage(e){return e===this.state.currentPage}}}function rS(e,t={}){let{dispatch:r}=e,n=tS(e,t);return{...n,get state(){return n.state},selectPage(e){n.selectPage(e),r(Uc({legacy:Kv(),next:{actionCause:"browseResults"}}))},nextPage(){n.nextPage(),r(Uc({legacy:Jv(),next:{actionCause:"browseResults"}}))},previousPage(){n.previousPage(),r(Uc({legacy:Zv(),next:{actionCause:"browseResults"}}))}}}function nS(e){!function(e){e.addReducers({search:tu})}(e);let t=Td(e),r=()=>e.state;return{...t,get state(){return{hasError:null!==r().search.error,error:r().search.error}}}}function aS(e){return nS(e)}function iS(e){!function(e){e.addReducers({search:tu})}(e);let t=Td(e);return{...t,get state(){let t=e.state;return{hasError:null!==t.search.error,isLoading:t.search.isLoading,hasResults:!!t.search.results.length,firstSearchExecuted:Jc(t)}}}}function sS(e){!function(e){e.addReducers({search:tu,pagination:Uv})}(e);let t=Td(e),r=iS(e),n=()=>e.state,a=()=>{let e=n().search.duration/1e3;return Math.round(100*(e+Number.EPSILON))/100};return{...t,get state(){return{...r.state,durationInMilliseconds:n().search.duration,durationInSeconds:a(),firstResult:n().pagination.firstResult+1,hasDuration:0!==n().search.duration,hasQuery:""!==n().search.queryExecuted,lastResult:n().pagination.firstResult+n().search.results.length,query:n().search.queryExecuted,total:n().pagination.totalCountFiltered}}}}function oS(e){return sS(e)}var cS=new o({fieldsToInclude:new t({required:!1,each:new e({required:!0,emptyAllowed:!1})})});function uS(e,t){!function(e){e.addReducers({search:tu,configuration:ad,fields:Kd})}(e);let r=Td(e),n=iS(e),{dispatch:a}=e,i=We(e,cS,t?.options,"buildCoreResultList");i.fieldsToInclude&&a(Ud(i.fieldsToInclude));let s=()=>e.state.search.results.length<e.state.search.response.totalCountFiltered,o=0,c=0,u=!1;return{...r,get state(){let t=e.state;return{...n.state,results:t.search.results,moreResultsAvailable:s(),searchResponseId:t.search.searchResponseId}},fetchMoreResults:async()=>{if(!e.state.search.isLoading)if(s()){if(Date.now()-o<200){if(c++,c>=5)return o=Date.now(),!u&&e.logger.error('The result list method "fetchMoreResults" execution prevented because it has been triggered consecutively 5 times, with little delay. Please verify the conditions under which the function is called.'),void(u=!0)}else c=0;u=!1,t?.fetchMoreResultsActionCreator&&(await a(t?.fetchMoreResultsActionCreator()),o=Date.now())}else e.logger.info("No more results are available for the result list to fetch.")}}}function lS(e,t){return uS(e,{...t,fetchMoreResultsActionCreator:Qc})}var dS={results:new t({required:!0,each:new r({values:us})}),maxLength:new s({required:!0,min:1,default:10})},fS=dr("recentResults/registerRecentResults",(e=>He(e,dS))),pS=dr("recentResults/pushRecentResult",(e=>(ps(e),{payload:e}))),gS=dr("recentResults/clearRecentResults"),hS=e=>ns({prefix:"analytics/result/open",__legacy__getBuilder:(t,r)=>(ps(e),t.makeDocumentOpen(as(e,r),os(e))),analyticsType:"itemClick",analyticsPayloadBuilder:t=>{let r=as(e,t),n=os(e);return{searchUid:e.searchUid??"",position:r.documentPosition,itemMetadata:{uniqueFieldName:n.contentIDKey,uniqueFieldValue:n.contentIDValue,title:r.documentTitle,author:r.documentAuthor,url:r.documentUrl}}}});function yS(e,t,r){!function(e){e.addReducers({configuration:ad})}(e);let n,a={selectionDelay:1e3,debounceWait:1e3,...t.options};return{select:dd(r,a.debounceWait,{isImmediate:!0}),beginDelayedSelect(){n=setTimeout(r,a.selectionDelay)},cancelPendingSelect(){n&&clearTimeout(n)}}}function mS(e,t){let r=!1;return yS(e,t,(()=>{r||(r=!0,e.dispatch(hS(t.options.result))),e.dispatch(pS(t.options.result))}))}function vS(e,t){let r=!1,n=()=>{r||(r=!0,e.dispatch((e=>ns({prefix:"analytics/instantResult/open",__legacy__getBuilder:(t,r)=>(ps(e),t.makeDocumentOpen(as(e,r),os(e))),__legacy__provider:e=>new Xs(e),analyticsType:"itemClick",analyticsPayloadBuilder:t=>{let r=as(e,t),n=os(e);return{searchUid:e.searchUid??"",position:r.documentPosition,itemMetadata:{uniqueFieldName:n.contentIDKey,uniqueFieldValue:n.contentIDValue,title:r.documentTitle,author:r.documentAuthor,url:r.documentUrl}}}}))(t.options.result)))};return yS(e,t,(()=>{n(),e.dispatch(pS(t.options.result))}))}var SS=new o({numberOfResults:new s({min:0})});function wS(e,t={}){!function(e){e.addReducers({pagination:Uv,configuration:ad})}(e);let r=Td(e),{dispatch:n}=e,a=Ye(e,SS,t.initialState,"buildResultsPerPage").numberOfResults;return void 0!==a&&n(so(a)),{...r,get state(){return{numberOfResults:e.state.pagination.numberOfResults}},set(e){n(oo(e))},isSetTo(e){return e===this.state.numberOfResults}}}function bS(e,t={}){!function(e){e.addReducers({pagination:Uv,configuration:ad})}(e);let r=wS(e,t),{dispatch:n}=e;return{...r,get state(){return{...r.state}},set(e){r.set(e),n(Uc({legacy:Gv(),next:{actionCause:"browseResults"}}))}}}var CS={id:_e},IS=dr("querySuggest/register",(e=>He(e,{...CS,count:new s({min:0})}))),qS=dr("querySuggest/unregister",(e=>He(e,CS))),kS=dr("querySuggest/selectSuggestion",(e=>He(e,{...CS,expression:Qe}))),xS=dr("querySuggest/clear",(e=>He(e,CS))),AS=Ur("querySuggest/fetch",(async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n,validatePayload:a,navigatorContext:i}})=>{a(e,CS);let s=e.id,o=await RS(s,t(),i),c=await n.querySuggest(o);return Pe(c)?r(c.error):{id:s,q:o.q,...c.success}})),RS=async(e,t,r)=>({accessToken:t.configuration.accessToken,organizationId:t.configuration.organizationId,url:t.configuration.search.apiBaseUrl??me(t.configuration.organizationId,t.configuration.environment),count:t.querySuggest[e].count,q:t.querySet[e],locale:t.configuration.search.locale,timezone:t.configuration.search.timezone,actionsHistory:t.configuration.analytics.enabled?ii.getHistory():[],...t.context&&{context:t.context.contextValues},...t.pipeline&&{pipeline:t.pipeline},...t.searchHub&&{searchHub:t.searchHub},tab:t.configuration.analytics.originLevel2,...t.configuration.analytics.enabled&&{...t.configuration.analytics.enabled&&"legacy"===t.configuration.analytics.analyticsMode?await yo(t.configuration.analytics):go(t.configuration.analytics,r)},...t.configuration.search.authenticationProviders.length&&{authentication:t.configuration.search.authenticationProviders.join(",")}}),OS=()=>ns("analytics/searchbox/submit",(e=>e.makeSearchboxSubmit())),FS=()=>({actionCause:"searchboxSubmit"}),ES={id:_e,query:Qe},TS=dr("querySet/register",(e=>He(e,ES))),DS=dr("querySet/update",(e=>He(e,ES))),MS=dr("commerce/querySet/register",(e=>He(e,ES))),PS=dr("commerce/querySet/update",(e=>He(e,ES))),jS=Ir({},(e=>{e.addCase(TS,((e,t)=>QS(e,t.payload))).addCase(MS,((e,t)=>QS(e,t.payload))).addCase(DS,((e,t)=>{let{id:r,query:n}=t.payload;US(e,r,n)})).addCase(PS,((e,t)=>{let{id:r,query:n}=t.payload;US(e,r,n)})).addCase(kS,((e,t)=>{let{id:r,expression:n}=t.payload;US(e,r,n)})).addCase(Ap,((e,t)=>{let{id:r,expression:n}=t.payload;US(e,r,n)})).addCase(Hp.fulfilled,((e,t)=>{let{queryExecuted:r}=t.payload;_S(e,r)})).addCase(_c.fulfilled,((e,t)=>{let{queryExecuted:r}=t.payload;_S(e,r)})).addCase(Ps,VS).addCase(bm,VS).addCase(zs.fulfilled,((e,t)=>{if(t.payload)for(let[r,n]of Object.entries(t.payload.querySet))US(e,r,n)}))}));function VS(e,t){c(t.payload.q)||_S(e,t.payload.q)}function _S(e,t){Object.keys(e).forEach((r=>e[r]=t))}var US=(e,t,r)=>{t in e&&(e[t]=r)},QS=(e,t)=>{let{id:r,query:n}=t;r in e||(e[r]=n)},$S=e=>ns("analytics/querySuggest",((t,r)=>{let n=NS(r,e);return t.makeOmniboxAnalytics(n)})),LS=()=>({actionCause:"omniboxAnalytics"});function NS(e,t){let{id:r,suggestion:n}=t,a=e.querySuggest&&e.querySuggest[r];if(!a)throw new Error(`Unable to determine the query suggest analytics metadata to send because no query suggest with id "${r}" was found. Please check the sent #id.`);let i=a.completions.map((e=>e.expression)),s=a.partialQueries.length-1,o=a.partialQueries[s]||"",c=a.responseId;return{suggestionRanking:i.indexOf(n),partialQuery:o,partialQueries:a.partialQueries,suggestions:i,querySuggestResponseId:c}}var BS=Ir({},(e=>e.addCase(IS,((e,t)=>{zS(e,t.payload)})).addCase(xp,((e,t)=>{zS(e,t.payload)})).addCase(qS,((e,t)=>{delete e[t.payload.id]})).addCase(AS.pending,HS).addCase(AS.fulfilled,((e,t)=>{let r=e[t.meta.arg.id];if(!r||t.meta.requestId!==r.currentRequestId)return;let{q:n}=t.payload;n&&r.partialQueries.push(n.replace(/;/,encodeURIComponent(";"))),r.responseId=t.payload.responseId,r.completions=t.payload.completions,r.isLoading=!1,r.error=null})).addCase(AS.rejected,YS).addCase(kp.pending,HS).addCase(kp.fulfilled,((e,t)=>{let r=e[t.meta.arg.id];if(!r||t.meta.requestId!==r.currentRequestId)return;let{query:n}=t.payload;n&&r.partialQueries.push(n.replace(/;/,encodeURIComponent(";"))),r.responseId=t.payload.responseId,r.completions=t.payload.completions.map((e=>({expression:e.expression,highlighted:e.highlighted,score:0,executableConfidence:0}))),r.isLoading=!1,r.error=null})).addCase(kp.rejected,YS).addCase(xS,((e,t)=>{WS(e,t.payload)})).addCase(qp,((e,t)=>{WS(e,t.payload)}))));function zS(e,t){let r=t.id;r in e||(e[r]=function(e){return{id:"",completions:[],responseId:"",count:5,currentRequestId:"",error:null,partialQueries:[],isLoading:!1,...e}}(t))}function HS(e,t){let r=e[t.meta.arg.id];r&&(r.currentRequestId=t.meta.requestId,r.isLoading=!0)}function YS(e,t){let r=e[t.meta.arg.id];r&&(r.error=t.payload||null,r.isLoading=!1)}function WS(e,t){let r=e[t.id];r&&(r.responseId="",r.completions=[],r.partialQueries=[])}var GS=Ir(Vi(),(e=>e.addCase(po,((e,t)=>({...e,...t.payload}))).addCase(Jo,((e,t)=>{e.q=t.payload})).addCase(kS,((e,t)=>{e.q=t.payload.expression})).addCase(zs.fulfilled,((e,t)=>t.payload?.query??e)).addCase(Ps,((e,t)=>{e.q=t.payload.q??e.q,e.enableQuerySyntax=t.payload.enableQuerySyntax??e.enableQuerySyntax})))),KS={enableQuerySyntax:!1,numberOfSuggestions:5,clearFilters:!0},JS={open:new e,close:new e},ZS={id:_e,numberOfSuggestions:new s({min:0}),enableQuerySyntax:new a,highlightOptions:new r({values:{notMatchDelimiters:new r({values:JS}),exactMatchDelimiters:new r({values:JS}),correctionDelimiters:new r({values:JS})}}),clearFilters:new a},XS=new o(ZS);function ew(e,t){!function(e){e.addReducers({query:GS,querySuggest:BS,configuration:ad,querySet:jS,search:tu})}(e);let r=Td(e),{dispatch:n}=e,a=t.options?.id||B("search_box"),i={id:a,highlightOptions:{...t.options?.highlightOptions},...KS,...t.options};We(e,XS,i,"buildSearchBox"),n(TS({id:a,query:e.state.query.q})),i.numberOfSuggestions&&n(IS({id:a,count:i.numberOfSuggestions}));let s=()=>e.state.querySet[i.id],o=async e=>{let{enableQuerySyntax:r,clearFilters:a}=i;n(Vc({q:s(),enableQuerySyntax:r,clearFilters:a})),t.isNextAnalyticsReady?n(t.executeSearchActionCreator(e)):n(t.executeSearchActionCreator(e.legacy))};return{...r,updateText(e){n(DS({id:a,query:e})),this.showSuggestions()},clear(){n(DS({id:a,query:""})),n(xS({id:a}))},showSuggestions(){i.numberOfSuggestions&&n(t.fetchQuerySuggestionsActionCreator({id:a}))},selectSuggestion(e){n(kS({id:a,expression:e})),o({legacy:$S({id:a,suggestion:e}),next:LS()}).then((()=>{n(xS({id:a}))}))},submit(e=OS(),t){o({legacy:e,next:t}),n(xS({id:a}))},get state(){let t=e.state,r=t.querySuggest[i.id],n=function(e,t){return e?e.completions.map((e=>({highlightedValue:Z(e.highlighted,t),rawValue:e.expression}))):[]}(r,i.highlightOptions),o=!!r&&r.isLoading;return{searchBoxId:a,value:s(),suggestions:n,isLoading:t.search.isLoading,isLoadingSuggestions:o}}}}function tw(e,t={}){let r=ew(e,{...t,executeSearchActionCreator:_c,fetchQuerySuggestionsActionCreator:AS,isNextAnalyticsReady:!0});return{...r,submit(){r.submit(OS(),FS())},get state(){return r.state}}}function rw(e){return!!e&&(e.expiresAt&&Date.now()>=e.expiresAt)}var nw=(e,t)=>{let{q:r,id:n}=e;return t[n].cache[r]||null},aw=(e,t,r)=>{let{q:n,id:a}=e;t[a].cache[n]={isLoading:!0,error:null,expiresAt:0,isActive:!0,searchUid:"",totalCountFiltered:0,duration:0,...r}};var iw=Ir({},(e=>{e.addCase(ro,((e,t)=>{((e,t)=>{let{id:r}=e;if(!t[r])t[r]={q:"",cache:{}}})(t.payload,e)})),e.addCase(no,((e,t)=>{((e,t)=>{let{q:r,id:n}=e;r&&(t[n].q=r)})(t.payload,e)})),e.addCase(ao,((e,t)=>{((e,t)=>{let{id:r}=e;Object.entries(t[r].cache).forEach((([e,n])=>{rw(n)&&delete t[r].cache[e]}))})(t.payload,e)})),e.addCase(Lc.pending,((e,t)=>{((e,t,r)=>{for(let e in t)for(let r in t[e].cache)t[e].cache[r].isActive=!1;if(!nw(e,t))return void aw(e,t,r);let n=nw(e,t);n.isLoading=!0,n.isActive=!0,n.error=null})(t.meta.arg,e,{results:[]})})),e.addCase(Lc.fulfilled,((e,t)=>{let r=t.payload.results.map((e=>({...e,searchUid:t.payload.searchUid})));((e,t,r)=>{let{id:n,q:a,searchUid:i,cacheTimeout:s,totalCountFiltered:o,duration:c}=e;t[n].cache[a]={...nw(e,t),...r,isActive:!0,searchUid:i,isLoading:!1,error:null,expiresAt:s?s+Date.now():0,totalCountFiltered:o,duration:c}})({...t.payload,...t.meta.arg},e,{results:r})})),e.addCase(Lc.rejected,((e,t)=>{((e,t)=>{let{id:r,q:n,error:a}=e;t[r].cache[n].error=a||null,t[r].cache[n].isLoading=!1,t[r].cache[n].isActive=!1})(t.meta.arg,e)}))})),sw={searchBoxId:Ue,maxResultsPerQuery:new s({required:!0,min:1}),cacheTimeout:new s},ow=new o(sw);function cw(e,t){!function(e){e.addReducers({instantResults:iw})}(e);let r=Td(e),{dispatch:n}=e,a={searchBoxId:t.options.searchBoxId||B("instant-results-"),cacheTimeout:t.options.cacheTimeout||6e4,maxResultsPerQuery:t.options.maxResultsPerQuery};We(e,ow,a,"buildInstantResults");let i=a.searchBoxId;n(ro({id:i}));let s=()=>e.state.instantResults[i],o=e=>s().cache[e],c=()=>s().q,u=()=>{let e=o(c());return e?e.isLoading?[]:e.results:[]};return{...r,updateQuery(e){if(!e)return;let t=o(e);(!t||!t.isLoading&&(t.error||rw(t)))&&n(Lc({id:i,q:e,maxResultsPerQuery:a.maxResultsPerQuery,cacheTimeout:a.cacheTimeout})),n(no({id:i,q:e}))},clearExpired(){n(ao({id:i}))},get state(){let e=c(),t=o(e);return{q:e,isLoading:t?.isLoading||!1,error:t?.error||null,results:u()}}}}var uw=()=>ns("analytics/sort/results",((e,t)=>e.makeResultsSort({resultsSortBy:t.sortCriteria||Wi()}))),lw=()=>({actionCause:"resultsSort"}),dw={by:new n({enum:Qi,required:!0})},fw=dr("sortCriteria/register",(e=>gw(e))),pw=dr("sortCriteria/update",(e=>gw(e))),gw=e=>u(e)?(e.forEach((e=>He(e,dw))),{payload:e}):He(e,dw),hw=Ir(Wi(),(e=>{e.addCase(fw,((e,t)=>$i(t.payload))).addCase(pw,((e,t)=>$i(t.payload))).addCase(zs.fulfilled,((e,t)=>t.payload?.sortCriteria??e)).addCase(Ps,((e,t)=>t.payload.sortCriteria??e))}));function yw(e,r){if(!r)return;let n=new o({criterion:new t({each:Yi})}),a=function(e){return e.criterion?u(e.criterion)?e.criterion:[e.criterion]:[]}(r),i={...r,criterion:a};Ye(e,n,i,"buildSort")}function mw(e,t){!function(e){e.addReducers({configuration:ad,sortCriteria:hw})}(e);let r=Td(e),{dispatch:n}=e;yw(e,t.initialState);let a=t.initialState?.criterion;return a&&n(fw(a)),{...r,sortBy(e){n(pw(e)),n(uo(1))},isSortedBy(e){return this.state.sortCriteria===$i(e)},get state(){return{sortCriteria:e.state.sortCriteria}}}}function vw(e,t={}){let{dispatch:r}=e,n=mw(e,t);return{...n,get state(){return n.state},sortBy(e){n.sortBy(e),r(_c({legacy:uw(),next:lw()}))}}}var Sw=_e,ww=new r({options:{required:!0},values:{caption:Qe,expression:Qe,state:new e({constrainTo:["idle","selected","excluded"]})}}),bw=new t({required:!0,each:ww}),Cw=dr("staticFilter/register",(e=>He(e,{id:Sw,values:bw}))),Iw=dr("staticFilter/toggleSelect",(e=>He(e,{id:Sw,value:ww}))),qw=dr("staticFilter/toggleExclude",(e=>He(e,{id:Sw,value:ww}))),kw=dr("staticFilter/deselectAllFilterValues",(e=>He(e,Sw))),xw=e=>ns("analytics/staticFilter/select",(t=>t.makeStaticFilterSelect(e))),Aw=e=>ns("analytics/staticFilter/deselect",(t=>t.makeStaticFilterDeselect(e))),Rw=e=>ns("analytics/staticFilter/clearAll",(t=>t.makeStaticFilterClearAll(e))),Ow=()=>({actionCause:"staticFilterSelect"}),Fw=()=>({actionCause:"staticFilterDeselect"}),Ew=Ir({},(e=>e.addCase(Cw,((e,t)=>{let r=t.payload,{id:n}=r;n in e||(e[n]=r)})).addCase(Iw,((e,t)=>{let{id:r,value:n}=t.payload,a=e[r];if(!a)return;let i=a.values.find((e=>e.caption===n.caption));if(!i)return;let s="selected"===i.state;i.state=s?"idle":"selected"})).addCase(qw,((e,t)=>{let{id:r,value:n}=t.payload,a=e[r];if(!a)return;let i=a.values.find((e=>e.caption===n.caption));if(!i)return;let s="excluded"===i.state;i.state=s?"idle":"excluded"})).addCase(kw,((e,t)=>{let r=e[t.payload];r&&r.values.forEach((e=>e.state="idle"))})).addCase(Ks,(e=>{Object.values(e).forEach((e=>{e.values.forEach((e=>e.state="idle"))}))})).addCase(Ps,((e,t)=>{let r=t.payload.sf||{};Object.entries(e).forEach((([e,t])=>{let n=r[e]||[];t.values.forEach((e=>{e.state=n.includes(e.caption)?"selected":"idle"}))}))}))));function Tw(e){return{state:"idle",...e}}var Dw=new o({id:Sw,values:bw});function Mw(e,t){!function(e){e.addReducers({staticFilterSet:Ew})}(e),We(e,Dw,t.options,"buildStaticFilter");let r=Td(e),{dispatch:n}=e,{id:a}=t.options;return n(Cw(t.options)),{...r,toggleSelect(e){n(Iw({id:a,value:e})),n(_c({legacy:Pw(a,e),next:jw(e)}))},toggleSingleSelect(e){"idle"===e.state&&n(kw(a)),n(Iw({id:a,value:e})),n(_c({legacy:Pw(a,e),next:jw(e)}))},toggleExclude(e){n(qw({id:a,value:e})),n(_c({legacy:Pw(a,e),next:jw(e)}))},toggleSingleExclude(e){"idle"===e.state&&n(kw(a)),n(qw({id:a,value:e})),n(_c({legacy:Pw(a,e),next:jw(e)}))},deselectAll(){n(kw(a)),n(_c({legacy:Rw({staticFilterId:a}),next:{actionCause:"staticFilterClearAll"}}))},isValueSelected:e=>"selected"===e.state,isValueExcluded:e=>"excluded"===e.state,get state(){let t=e.state.staticFilterSet[a]?.values||[],r=t.some((e=>"idle"!==e.state));return{id:a,values:t,hasActiveValues:r}}}}function Pw(e,t){let{caption:r,expression:n,state:a}=t;return("idle"===a?xw:Aw)({staticFilterId:e,staticFilterValue:{caption:r,expression:n}})}function jw(e){return"selected"===e.state?Ow():Fw()}var Vw=Ir({},(e=>{e.addCase(Jl,((e,t)=>{let r=t.payload,{id:n}=r;n in e||(e[n]={...r,isActive:!1})})).addCase(Zl,((e,t)=>{_w(e,t.payload)})).addCase(Ps,((e,t)=>{let r=t.payload.tab||"";_w(e,r),Zl(r)})).addCase(zs.fulfilled,((e,t)=>t.payload?.tabSet??e))}));function _w(e,t){t in e&&Object.keys(e).forEach((r=>{e[r].isActive=r===t}))}var Uw=new o({expression:Qe,id:_e,clearFiltersOnTabChange:new a}),Qw=new o({isActive:new a});function $w(e,t){(function(e){let t=rd().analytics.originLevel2;if(e===t)throw new Error(`The #id option on the Tab controller cannot use the reserved value "${t}". Please specify a different value.`)})(t.options.id),function(e){e.addReducers({configuration:ad,tabSet:Vw})}(e);let r=Td(e),{dispatch:n}=e;We(e,Uw,t.options,"buildTab");let a=Ye(e,Qw,t.initialState,"buildTab"),{id:i,expression:s}=t.options;return n(Jl({id:i,expression:s})),a.isActive&&n(Zl(i)),{...r,select(){t.options.clearFiltersOnTabChange&&n(Vc({q:"",clearFilters:!0})),n(Zl(i))},get state(){return{isActive:e.state.tabSet[i]?.isActive}}}}function Lw(e,t){let{dispatch:r}=e,n=$w(e,t);return{...n,get state(){return n.state},select(){n.select(),r(_c({legacy:ws(),next:Is()}))}}}function Nw(e){!function(e){e.addReducers({tabSet:Vw})}(e);let t=Td(e),r=ir((e=>e.tabSet),(e=>Object.values(e).find((e=>e.isActive))?.id??""));return{...t,get state(){return{activeTab:r(e.state)}}}}function Bw(e){let t=Nw(e);return{...t,get state(){return t.state}}}function zw(e){!function(e){e.addReducers({search:tu,facetOptions:Rh})}(e);let t=Td(e);return{...t,sort(e){return dc(e,this.state.facetIds)},get state(){return{facetIds:e.state.search.response.facets.map((e=>e.facetId))}}}}function Hw(e){return zw(e)}var Yw={categoryFacetId:qf,categoryFacetPath:new t({required:!0,each:_e})},Ww=e=>ns("analytics/categoryFacet/breadcrumb",((t,r)=>(He(e,Yw),t.makeBreadcrumbFacet(((e,{categoryFacetId:t,categoryFacetPath:r})=>{let n=e.categoryFacetSet[t]?.request.field;return{categoryFacetId:t,categoryFacetPath:r,categoryFacetField:n,categoryFacetTitle:`${n}_${t}`}})(r,e))))),Gw=()=>ns("analytics/facet/deselectAllBreadcrumbs",(e=>e.makeBreadcrumbResetAll())),Kw=(e,{facetId:t,selection:r})=>{let n=(e.dateFacetSet[t]||e.numericFacetSet[t]).request.field;return{facetId:t,facetField:n,facetTitle:`${n}_${t}`,facetRangeEndInclusive:r.endInclusive,facetRangeEnd:`${r.end}`,facetRangeStart:`${r.start}`}},Jw=()=>({actionCause:"breadcrumbFacet"}),Zw=e=>ns("analytics/dateFacet/breadcrumb",((t,r)=>{He(e,oh(e.selection));let n=Kw(r,e);return t.makeBreadcrumbFacet(n)})),Xw=Jw,eb=e=>ns("analytics/numericFacet/breadcrumb",((t,r)=>{He(e,oh(e.selection));let n=Kw(r,e);return t.makeBreadcrumbFacet(n)})),tb=Jw,rb=e=>Object.keys(e.facetSet).map((t=>{let r=e.facetValuesSelector(e.engine.state,t).map((r=>({value:r,deselect:()=>{"selected"===r.state?e.executeToggleSelect({facetId:t,selection:r}):"excluded"===r.state&&e.executeToggleExclude({facetId:t,selection:r})}})));return{facetId:t,field:e.facetSet[t].request.field,values:r}})).filter((e=>e.values.length));function nb(e){!function(e){e.addReducers({configuration:ad,search:tu,facetSet:Kh,numericFacetSet:Zy,dateFacetSet:Qy,categoryFacetSet:Yf})}(e);let t=function(e){let t=Td(e),{dispatch:r}=e;return{...t,get state(){return{facetBreadcrumbs:[],categoryFacetBreadcrumbs:[],numericFacetBreadcrumbs:[],dateFacetBreadcrumbs:[],staticFilterBreadcrumbs:[],hasBreadcrumbs:!1}},deselectAll:()=>{r(Ks())},deselectBreadcrumb(e){e.deselect()}}}(e),{dispatch:r}=e,n=()=>e.state,a=()=>{let t={engine:e,facetSet:n().facetSet,executeToggleSelect:({facetId:e,selection:t})=>{r(Gg({facetId:e,selection:t})),r(th({facetId:e,freezeCurrentValues:!1})),r(_c({legacy:kg({facetId:e,facetValue:t.value}),next:{actionCause:"breadcrumbFacet"}}))},executeToggleExclude:({facetId:e,selection:t})=>{r(Kg({facetId:e,selection:t})),r(th({facetId:e,freezeCurrentValues:!1})),r(_c({legacy:kg({facetId:e,facetValue:t.value}),next:{actionCause:"breadcrumbFacet"}}))},facetValuesSelector:fi};return rb(t)},i=()=>{let t={engine:e,facetSet:n().numericFacetSet,executeToggleSelect:e=>{r(Ch(e)),r(_c({legacy:eb(e),next:tb()}))},executeToggleExclude:e=>{r(Ih(e)),r(_c({legacy:eb(e),next:tb()}))},facetValuesSelector:um};return rb(t)},s=()=>{let t={engine:e,facetSet:n().dateFacetSet,executeToggleSelect:e=>{r(ph(e)),r(_c({legacy:Zw(e),next:Xw()}))},executeToggleExclude:e=>{r(gh(e)),r(_c({legacy:Zw(e),next:Xw()}))},facetValuesSelector:hm};return rb(t)},o=()=>Object.keys(n().categoryFacetSet).map(c).filter((e=>e.path.length)),c=e=>{let t=((e,t)=>{let r=hi(e,t);return gi(r?.values??[])})(n(),e);return{facetId:e,field:n().categoryFacetSet[e].request.field,path:t,deselect:()=>{r(Nf(e)),r(_c({legacy:Ww({categoryFacetPath:t.map((e=>e.value)),categoryFacetId:e}),next:{actionCause:"breadcrumbFacet"}}))}}},u=()=>{let e=n().staticFilterSet??{};return Object.values(e).map(l)},l=e=>{let{id:t,values:r}=e,n=r.filter((e=>"idle"!==e.state)).map((e=>d(t,e)));return{id:t,values:n}},d=(e,t)=>({value:t,deselect:()=>{let{caption:n,expression:a}=t;"selected"===t.state?r(Iw({id:e,value:t})):"excluded"===t.state&&r(qw({id:e,value:t})),r(_c({legacy:Aw({staticFilterId:e,staticFilterValue:{caption:n,expression:a}}),next:Fw()}))}}),f=()=>{let e=n().automaticFacetSet?.set??{};return Object.values(e).map((e=>p(e.response))).filter((e=>e.values.length>0))},p=e=>{let{field:t,label:r}=e,n=e.values.filter((e=>"idle"!==e.state)).map((e=>g(t,e)));return{facetId:t,field:t,label:r,values:n}},g=(e,t)=>({value:t,deselect:()=>{r(_v({field:e,selection:t})),r(_c({legacy:kg({facetId:e,facetValue:t.value}),next:{actionCause:"breadcrumbFacet"}}))}});return{...t,get state(){return{facetBreadcrumbs:a(),categoryFacetBreadcrumbs:o(),numericFacetBreadcrumbs:i(),dateFacetBreadcrumbs:s(),staticFilterBreadcrumbs:u(),automaticFacetBreadcrumbs:f(),hasBreadcrumbs:!![...a(),...i(),...s(),...o(),...u(),...f()].length}},deselectAll:()=>{t.deselectAll(),r(_c({legacy:Gw()}))}}}function ab(e){return"redirect"===e.type}var ib=dr("standaloneSearchBox/register",(e=>He(e,{id:_e,redirectionUrl:_e,overwrite:new a({required:!1})}))),sb=dr("standaloneSearchBox/updateRedirectionUrl",(e=>He(e,{id:_e,redirectionUrl:_e}))),ob=dr("standaloneSearchBox/reset",(e=>He(e,{id:_e}))),cb=dr("standaloneSearchBox/updateAnalyticsToSearchFromLink",(e=>He(e,{id:_e}))),ub=dr("standaloneSearchBox/updateAnalyticsToOmniboxFromLink"),lb=Ur("standaloneSearchBox/fetchRedirect",(async(t,{dispatch:r,getState:n,rejectWithValue:a,extra:{apiClient:i,validatePayload:s,navigatorContext:o}})=>{s(t,{id:new e({emptyAllowed:!1})});let c=await fb(n(),o),u=await i.plan(c);if(Pe(u))return a(u.error);let{redirectionUrl:l}=new class{constructor(e){this.response=e}get basicExpression(){return this.response.parsedInput.basicExpression}get largeExpression(){return this.response.parsedInput.largeExpression}get redirectionUrl(){let e=this.response.preprocessingOutput.triggers.filter(ab);return e.length?e[0].content:null}}(u.success);return l&&r(db(l)),l||""})),db=e=>ns("analytics/standaloneSearchBox/redirect",(t=>t.makeTriggerRedirect({redirectedTo:e}))),fb=async(e,t)=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl??me(e.configuration.organizationId,e.configuration.environment),locale:e.configuration.search.locale,timezone:e.configuration.search.timezone,q:e.query.q,...e.context&&{context:e.context.contextValues},...e.pipeline&&{pipeline:e.pipeline},...e.searchHub&&{searchHub:e.searchHub},...e.configuration.analytics.enabled&&"legacy"===e.configuration.analytics.analyticsMode?await yo(e.configuration.analytics):go(e.configuration.analytics,t),...e.configuration.search.authenticationProviders.length&&{authentication:e.configuration.search.authenticationProviders.join(",")}});var pb=Ir({},(e=>e.addCase(ib,((e,t)=>{let{id:r,redirectionUrl:n,overwrite:a}=t.payload;!a&&r in e||(e[r]=gb(n))})).addCase(ob,((e,t)=>{let{id:r}=t.payload,n=e[r];n&&(e[r]=gb(n.defaultRedirectionUrl))})).addCase(sb,((e,t)=>{let{id:r,redirectionUrl:n}=t.payload;r in e&&(e[r]=gb(n))})).addCase(lb.pending,((e,t)=>{let r=e[t.meta.arg.id];r&&(r.isLoading=!0)})).addCase(lb.fulfilled,((e,t)=>{let r=t.payload,n=e[t.meta.arg.id];n&&(n.redirectTo=r||n.defaultRedirectionUrl,n.isLoading=!1)})).addCase(lb.rejected,((e,t)=>{let r=e[t.meta.arg.id];r&&(r.isLoading=!1)})).addCase(cb,((e,t)=>{let r=e[t.payload.id];r&&(r.analytics.cause="searchFromLink")})).addCase(ub,((e,t)=>{let r=e[t.payload.id];r&&(r.analytics.cause="omniboxFromLink",r.analytics.metadata=t.payload.metadata)}))));function gb(e){return{defaultRedirectionUrl:e,redirectTo:"",isLoading:!1,analytics:{cause:"",metadata:null}}}var hb=new o({...ZS,redirectionUrl:new e({required:!0,emptyAllowed:!1}),overwrite:new a({required:!1})});function yb(e,t){!function(e){e.addReducers({standaloneSearchBoxSet:pb,configuration:ad,query:GS,querySuggest:BS})}(e);let{dispatch:r}=e,n=()=>e.state,a=t.options.id||B("standalone_search_box"),i={id:a,highlightOptions:{...t.options.highlightOptions},...KS,overwrite:!1,...t.options};We(e,hb,i,"buildStandaloneSearchBox");let s=tw(e,{options:i});return r(ib({id:a,redirectionUrl:i.redirectionUrl,overwrite:i.overwrite})),{...s,updateText(e){s.updateText(e),r(cb({id:a}))},selectSuggestion(e){let t=NS(n(),{id:a,suggestion:e});r(kS({id:a,expression:e})),r(ub({id:a,metadata:t})),this.submit()},afterRedirection(){r(ob({id:a}))},updateRedirectUrl(e){r(sb({id:a,redirectionUrl:e}))},submit(){r(po({q:this.state.value,enableQuerySyntax:i.enableQuerySyntax})),r(lb({id:a}))},get state(){let e=n().standaloneSearchBoxSet[a];return{...s.state,isLoading:e.isLoading,redirectTo:e.redirectTo,analytics:e.analytics}}}}function mb(e,t){return e.q!==t.q?OS():e.sortCriteria!==t.sortCriteria?uw():e.firstResult!==t.firstResult?Kv():e.numberOfResults!==t.numberOfResults?Gv():bb(e.f,t.f)?vb(e.f,t.f):bb(e.fExcluded,t.fExcluded)?vb(e.fExcluded,t.fExcluded,!0):bb(e.cf,t.cf)?vb(e.cf,t.cf):bb(e.af,t.af)?vb(e.af,t.af):bb(e.nf,t.nf)?Sb(e.nf,t.nf):bb(e.df,t.df)?Sb(e.df,t.df):ws()}function vb(e={},t={},r=!1){let n=Object.keys(e),a=Object.keys(t),i=n.filter((e=>!a.includes(e)));if(i.length){let t=i[0];switch(!0){case e[t].length>1:return wg(t);case r:return qg({facetId:t,facetValue:e[t][0]});default:return Ig({facetId:t,facetValue:e[t][0]})}}let s=a.filter((e=>!n.includes(e)));if(s.length){let e=s[0];return r?Cg({facetId:e,facetValue:t[e][0]}):bg({facetId:e,facetValue:t[e][0]})}let o=a.find((r=>t[r].filter((t=>e[r].includes(t)))));if(!o)return ws();let c=e[o],u=t[o],l=u.filter((e=>!c.includes(e)));if(l.length)return r?Cg({facetId:o,facetValue:l[0]}):bg({facetId:o,facetValue:l[0]});let d=c.filter((e=>!u.includes(e)));return d.length?r?qg({facetId:o,facetValue:d[0]}):Ig({facetId:o,facetValue:d[0]}):ws()}function Sb(e={},t={}){return vb(Ib(e),Ib(t))}function wb(e,t){return e.q!==t.q?FS():e.sortCriteria!==t.sortCriteria?lw():bb(e.f,t.f)?Cb(e.f,t.f):bb(e.fExcluded,t.fExcluded)?Cb(e.fExcluded,t.fExcluded,!0):bb(e.cf,t.cf)?Cb(e.cf,t.cf):bb(e.af,t.af)?Cb(e.af,t.af):bb(e.nf,t.nf)?Cb(Ib(e.nf),Ib(t.nf)):bb(e.df,t.df)?Cb(Ib(e.df),Ib(t.df)):Is()}function bb(e={},t={}){return JSON.stringify(e)!==JSON.stringify(t)}function Cb(e={},t={},r=!1){let n=Object.keys(e),a=Object.keys(t),i=n.filter((e=>!a.includes(e)));if(i.length){let t=i[0];return e[t].length>1?xg():Og()}if(a.filter((e=>!n.includes(e))).length)return r?Rg():Ag();let s=a.find((r=>t[r].filter((t=>e[r].includes(t)))));if(!s)return Is();let o=e[s],c=t[s];return c.filter((e=>!o.includes(e))).length?r?Rg():Ag():o.filter((e=>!c.includes(e))).length?Og():Is()}function Ib(e={}){let t={};return Object.keys(e).forEach((r=>t[r]=e[r].map((e=>`${e.start}..${e.end}`)))),t}function qb(e){return{q:Vi().q,enableQuerySyntax:Vi().enableQuerySyntax,aq:e.advancedSearchQueries?.defaultFilters.aq??vo().defaultFilters.aq,cq:e.advancedSearchQueries?.defaultFilters.cq??vo().defaultFilters.cq,firstResult:0,numberOfResults:e.pagination?.defaultNumberOfResults??10,sortCriteria:Wi(),f:{},fExcluded:{},cf:{},nf:{},df:{},debug:_s(),sf:{},tab:"",af:{},mnf:{}}}var kb=new o({parameters:new r({options:{required:!0},values:Ms})});function xb(e,t){return{...qb(e.state),...t}}function Ab(e,t){return function(e,t){let r=e.state.tabSet,n=t.tab;if(!r||!Object.entries(r).length||!n)return!0;let a=n in r;return a||e.logger.warn(`The tab search parameter "${n}" is invalid. Ignoring change.`),a}(e,t)}function Rb(e){let t=e.state;return{..._p(t.query,(e=>e.q),Vi().q),...Fb(t),...Up(t.sortCriteria,(e=>e),Wi()),...Qp(t.facetSet,Ob(t),Eb,"f"),...Qp(t.facetSet,Ob(t),Db,"fExcluded"),...Mb(t),...Pb(t),...jb(t),...Vb(t)}}function Ob(e){return t=>e.facetOptions?.facets[t]?.enabled??!0}function Fb(e){let t=Object.values(e.tabSet??{}).find((e=>e.isActive));return t?{tab:t.id}:{}}function Eb(e){return e.currentValues.filter((e=>"selected"===e.state)).map((e=>e.value))}function Tb(e){return e.currentValues.filter((e=>"selected"===e.state))}function Db(e){return e.currentValues.filter((e=>"excluded"===e.state)).map((e=>e.value))}function Mb(e){return Qp(e.categoryFacetSet,Ob(e),(e=>gi(e.currentValues).map((e=>e.value))),"cf")}function Pb(e){return Qp(e.numericFacetSet,Ob(e),Tb,"nf")}function jb(e){return Qp(e.dateFacetSet,Ob(e),Tb,"df")}function Vb(e){let t=e.automaticFacetSet?.set;if(void 0===t)return{};let r=Object.entries(t).map((([e,{response:t}])=>{let r=function(e){return e.values.filter((e=>"selected"===e.state)).map((e=>e.value))}(t);return r.length?{[e]:r}:{}})).reduce(((e,t)=>({...e,...t})),{});return Object.keys(r).length?{af:r}:{}}function _b(e,t){let{dispatch:r}=e,n=function(e,t){let{dispatch:r}=e,n=Td(e);return Ye(e,kb,t.initialState,"buildSearchParameterManager"),r(Ps(t.initialState.parameters)),{...n,synchronize(t){let n=xb(e,t);r(Ps(n))},get state(){return{parameters:Rb(e)}}}}(e,t);return{...n,synchronize(t){let a=Ub(e),i=xb(e,a),s=xb(e,t);dv(i,s)||Ab(e,s)&&(n.synchronize(t),r(_c({legacy:mb(i,s),next:wb(i,s)})))},get state(){return{parameters:Ub(e)}}}}function Ub(e){let t=e.state;return{...Rb(e),...Qb(t),...$b(t),...Lb(t),...Nb(t),...Bb(t),...Hb(t),...zb(t)}}function Qb(e){if(void 0===e.query)return{};let t=e.query.enableQuerySyntax;return void 0!==t&&t!==Vi().enableQuerySyntax?{enableQuerySyntax:t}:{}}function $b(e){if(void 0===e.advancedSearchQueries)return{};let{aq:t,defaultFilters:r}=e.advancedSearchQueries;return t!==r.aq?{aq:t}:{}}function Lb(e){if(void 0===e.advancedSearchQueries)return{};let{cq:t,defaultFilters:r}=e.advancedSearchQueries;return t!==r.cq?{cq:t}:{}}function Nb(e){if(void 0===e.pagination)return{};let t=e.pagination.firstResult;return 0!==t?{firstResult:t}:{}}function Bb(e){if(void 0===e.pagination)return{};let{numberOfResults:t,defaultNumberOfResults:r}=e.pagination;return t!==r?{numberOfResults:t}:{}}function zb(e){if(void 0===e.staticFilterSet)return{};let t=Object.entries(e.staticFilterSet).map((([e,t])=>{let r=function(e){return e.filter((e=>"selected"===e.state)).map((e=>e.caption))}(t.values);return r.length?{[e]:r}:{}})).reduce(((e,t)=>({...e,...t})),{});return Object.keys(t).length?{sf:t}:{}}function Hb(e){if(void 0===e.debug)return{};let t=e.debug;return t!==_s()?{debug:t}:{}}var Yb="..",Wb="...",Gb=/^(f|fExcluded|cf|nf|df|sf|af|mnf)-(.+)$/,Kb={f:!0,fExcluded:!0,cf:!0,sf:!0,af:!0,nf:!0,df:!0,mnf:!0},Jb="&",Zb="=";function Xb(){return{serialize:rC(nC),deserialize:sC}}function eC(e){return e in Kb}function tC(e){return function(e){return e in{q:!0,aq:!0,cq:!0,enableQuerySyntax:!0,firstResult:!0,numberOfResults:!0,sortCriteria:!0,debug:!0,tab:!0}}(e)||eC(e)}var rC=e=>t=>Object.entries(t).map(e).filter((e=>e)).join(Jb);function nC(e){let[t,r]=e;return tC(t)?eC(t)&&!function(e){let t=e in{nf:!0,df:!0,mnf:!0};return eC(e)&&t}(t)?function(e){return!!aC(e)&&iC(e,(e=>"string"==typeof e))}(r)?function(e,t){return Object.entries(t).map((([t,r])=>`${e}-${t}${Zb}${r.map((e=>encodeURIComponent(e))).join(",")}`)).join(Jb)}(t,r):"":"nf"===t||"df"===t?function(e){return!!aC(e)&&iC(e,(e=>aC(e)&&"start"in e&&"end"in e))}(r)?function(e,t){return Object.entries(t).map((([t,r])=>{let n=r.map((({start:e,end:t,endInclusive:r})=>`${e}${r?Wb:Yb}${t}`)).join(",");return`${e}-${t}${Zb}${n}`})).join(Jb)}(t,r):"":function(e,t){return`${e}${Zb}${encodeURIComponent(t)}`}(t,r):""}function aC(e){return!(!e||"object"!=typeof e)}function iC(e,t){return 0===Object.entries(e).filter((e=>{let r=e[1];return!Array.isArray(r)||!r.every(t)})).length}function sC(e){return e.split(Jb).map((e=>function(e){let[t,...r]=e.split(Zb),n=r.join(Zb);return[t,n]}(e))).map((e=>function(e,t=Gb){let[r,n]=e,a=t.exec(r);if(!a)return e;let i=a[1],s=a[2],o=n.split(","),c=function(e,t){return"nf"===e||"mnf"===e?function(e){return e.map((e=>{let{startAsString:t,endAsString:r,isEndInclusive:n}=lC(e);return{start:parseFloat(t),end:parseFloat(r),endInclusive:n}})).filter((({start:e,end:t})=>Number.isFinite(e)&&Number.isFinite(t))).map((({start:e,end:t,endInclusive:r})=>im({start:e,end:t,state:"selected",endInclusive:r})))}(t):"df"===e?function(e){return e.map((e=>{let{isEndInclusive:t,startAsString:r,endAsString:n}=lC(e);return{start:r,end:n,endInclusive:t}})).filter((({start:e,end:t})=>oC(e)&&oC(t))).map((({start:e,end:t,endInclusive:r})=>rh({start:e,end:t,state:"selected",endInclusive:r})))}(t):t}(i,o),u={[s]:c};return[i,JSON.stringify(u)]}(e))).filter(cC).map((e=>function(e,t=!0){let[r,n]=e;return"enableQuerySyntax"===r||"debug"===r?[r,"true"===n]:"firstResult"===r||"numberOfResults"===r?[r,parseInt(n)]:eC(r)?[r,uC(n)]:[r,t?decodeURIComponent(n):n]}(e))).reduce(((e,t)=>{let[r,n]=t;if(eC(r)){let t={...e[r],...n};return{...e,[r]:t}}return{...e,[r]:n}}),{})}function oC(e){try{return function(e){return Ro(Ao(e))===e}(e)?(Oo(e,ko),!0):!!_o(e)&&(Mo(e),!0)}catch{return!1}}function cC(e){let t=tC(e[0]),r=2===e.length;return t&&r}function uC(e){let t=JSON.parse(e),r={};return Object.entries(t).forEach((e=>{let[t,n]=e;r[t]=n.map((e=>l(e)?decodeURIComponent(e):e))})),r}function lC(e){let t=-1!==e.indexOf(Wb),[r,n]=e.split(t?Wb:Yb);return{isEndInclusive:t,startAsString:r,endAsString:n}}var dC=new o({fragment:new e});function fC(e,t){let r;function n(){r=e.state.search.requestId}!function(e){e.addReducers({configuration:ad})}(e),Ye(e,dC,t.initialState,"buildUrlManager");let a=Td(e),i=t.initialState.fragment;n();let s=_b(e,{initialState:{parameters:pC(i)}});return{...a,subscribe(t){let a=()=>{let a=this.state.fragment;!function(e,t){if(e===t)return!0;let r=pC(e),n=pC(t);return dv(r,n)}(i,a)&&r!==e.state.search.requestId&&(i=a,t()),n()};return a(),e.subscribe(a)},get state(){return{fragment:Xb().serialize(s.state.parameters)}},synchronize(e){i=e;let t=pC(e);s.synchronize(t)}}}function pC(e){return Xb().deserialize(e)}function gC(e){return iS(e)}async function hC(e,t){let{search:r,accessToken:n,organizationId:a}=e.configuration,i=e.query?.q||"";return{url:r.apiBaseUrl??me(e.configuration.organizationId,e.configuration.environment),accessToken:n,organizationId:a,enableNavigation:!1,q:i,...t,requestedOutputSize:t.requestedOutputSize||0,...r.authenticationProviders.length&&{authentication:r.authenticationProviders.join(",")}}}var yC=Ur("resultPreview/fetchResultContent",(async(e,{extra:t,getState:r,rejectWithValue:n})=>{let a=r(),i=await hC(a,e),s=await t.apiClient.html(i);return Pe(s)?n(s.error):{content:s.success,uniqueId:e.uniqueId}})),mC=dr("resultPreview/next"),vC=dr("resultPreview/previous"),SC=dr("resultPreview/prepare",(e=>He(e,{results:new t({required:!0})}))),wC=Ur("resultPreview/updateContentURL",(async(e,{getState:t,extra:r})=>{let n=t(),a=((e,t)=>{let r=new se(`${e.url}${t}`);return r.addParam("access_token",e.accessToken),r.addParam("organizationId",e.organizationId),r.addParam("uniqueId",e.uniqueId),void 0!==e.q&&r.addParam("q",e.q),void 0!==e.enableNavigation&&r.addParam("enableNavigation",`${e.enableNavigation}`),void 0!==e.requestedOutputSize&&r.addParam("requestedOutputSize",`${e.requestedOutputSize}`),r.href})(await e.buildResultPreviewRequest(n,{uniqueId:e.uniqueId,requestedOutputSize:e.requestedOutputSize}),e.path);return a?.length>2048&&r.logger.error("The content URL was truncated as it exceeds the maximum allowed length of 2048 characters."),{contentURL:a}}));var bC=e=>{let{content:t,isLoading:r,uniqueId:n,contentURL:a}={uniqueId:"",content:"",isLoading:!1,position:-1,resultsWithPreview:[]};e.content=t,e.isLoading=r,e.uniqueId=n,e.contentURL=a},CC=e=>e.filter((e=>e.hasHtmlVersion)).map((e=>e.uniqueId)),IC=Ir({uniqueId:"",content:"",isLoading:!1,position:-1,resultsWithPreview:[]},(e=>{e.addCase(yC.pending,(e=>{e.isLoading=!0})).addCase(yC.fulfilled,((e,t)=>{let{content:r,uniqueId:n}=t.payload;e.position=e.resultsWithPreview.indexOf(n),e.content=r,e.uniqueId=n,e.isLoading=!1})).addCase(_c.fulfilled,((e,t)=>{bC(e),e.resultsWithPreview=CC(t.payload.response.results)})).addCase(Qc.fulfilled,((e,t)=>{bC(e),e.resultsWithPreview=e.resultsWithPreview.concat(CC(t.payload.response.results))})).addCase(Uc.fulfilled,bC).addCase(SC,((e,t)=>{e.resultsWithPreview=CC(t.payload.results)})).addCase(mC,(e=>{if(e.isLoading)return;let t=e.position+1;t>e.resultsWithPreview.length-1&&(t=0),e.position=t})).addCase(vC,(e=>{if(e.isLoading)return;let t=e.position-1;t<0&&(t=e.resultsWithPreview.length-1),e.position=t})).addCase(wC.fulfilled,((e,t)=>{e.contentURL=t.payload.contentURL}))}));function qC(e,t,r,n,a){!function(e){e.addReducers({configuration:ad,resultPreview:IC})}(e);let{dispatch:i}=e,s=()=>e.state,o=Td(e),{result:c,maximumPreviewSize:u}=t.options,l=()=>{let{resultsWithPreview:e,position:t}=s().resultPreview;return e[t]},d=e=>{i(wC({uniqueId:e,requestedOutputSize:u,buildResultPreviewRequest:r,path:n})),t.options.onlyContentURL||i(yC({uniqueId:e,requestedOutputSize:u})),a&&a()};return{...o,fetchResultContent(){d(c.uniqueId)},next(){i(mC()),d(l())},previous(){i(vC()),d(l())},get state(){let e=s(),t=c.hasHtmlVersion,r=e.resultPreview;return{content:c.uniqueId===r.uniqueId?r.content:"",resultHasPreview:t,isLoading:r.isLoading,contentURL:r.contentURL,currentResultUniqueId:l()}}}}function kC(e,t){!function(e){e.addReducers({search:tu})}(e);let{dispatch:r}=e,n=()=>e.state.search.results,a=qC(e,t,hC,"/html",(()=>{e.dispatch((e=>ns({prefix:"analytics/resultPreview/open",__legacy__getBuilder:(t,r)=>{ps(e);let n=as(e,r),a=os(e);return t.makeDocumentQuickview(n,a)},analyticsType:"itemClick",analyticsPayloadBuilder:t=>{let r=as(e,t),n=os(e);return{searchUid:e.searchUid??"",position:r.documentPosition,itemMetadata:{uniqueFieldName:n.contentIDKey,uniqueFieldValue:n.contentIDValue,title:r.documentTitle,author:r.documentAuthor,url:r.documentUrl}}}}))(t.options.result))}));return r(SC({results:n()})),{...a,get state(){return{...a.state,currentResult:n().findIndex((e=>e.uniqueId===a.state.currentResultUniqueId))+1,totalResults:n().length}}}}var xC={logShowMoreFoldedResults:e=>ns("analytics/folding/showMore",((t,r)=>(ps(e),t.makeShowMoreFoldedResults(as(e,r),os(e))))),logShowLessFoldedResults:()=>ns("analytics/folding/showLess",(e=>e.makeShowLessFoldedResults()))};function AC(e,t){return e.raw[t.parent]}function RC(e,t){let r=e.raw[t.child];return z(r)?r[0]:r}function OC(e,t,r,n=[]){let a=RC(e,r);return a?-1!==n.indexOf(a)?[]:t.filter((t=>{let n=RC(t,r)===RC(e,r);return AC(t,r)===a&&!n})).map((i=>{let s={...i,searchUid:e.searchUid};return{result:s,children:OC(s,t,r,[...n,a])}})):[]}function FC(e,t){return e.find((e=>{let r=void 0===AC(e,t),n=function(e,t){return void 0!==(e||t)&&e===t}(AC(e,t),RC(e,t));return r||n}))}function EC(e){return e.parentResult?EC(e.parentResult):e}function TC(e,t,r,n){let a={};return e.forEach((e=>{let i=function(e,t){return e.raw[t.collection]}(e,t);i&&(!RC(e,t)&&!e.parentResult||(a[i]=function(e,t,r,n){let a=Zi(e),i={...n??FC(a,t)??EC(e),searchUid:r};return{result:i,children:OC(i,a,t),moreResultsAvailable:e.totalNumberOfChildResults>1,isLoadingMoreResults:!1}}(e,t,r,n)))})),a}function DC(e,t){if(!e.collections[t])throw new Error(`Missing collection ${t} from ${Object.keys(e.collections)}: Folding most probably in an invalid state...`);return e.collections[t]}var MC=Ir({enabled:!1,fields:{collection:"foldingcollection",parent:"foldingparent",child:"foldingchild"},filterFieldRange:2,collections:{}},(e=>e.addCase(_c.fulfilled,((e,{payload:t})=>{e.collections=e.enabled?TC(t.response.results,e.fields,t.response.searchUid):{}})).addCase(Uc.fulfilled,((e,{payload:t})=>{e.collections=e.enabled?TC(t.response.results,e.fields,t.response.searchUid):{}})).addCase(Qc.fulfilled,((e,{payload:t})=>{e.collections=e.enabled?{...e.collections,...TC(t.response.results,e.fields,t.response.searchUid)}:{}})).addCase(Bd,((e,{payload:t})=>e.enabled?e:{enabled:!0,collections:{},fields:{collection:t.collectionField??e.fields.collection,parent:t.parentField??e.fields.parent,child:t.childField??e.fields.child},filterFieldRange:t.numberOfFoldedResults??e.filterFieldRange})).addCase(zd.pending,((e,{meta:t})=>{DC(e,t.arg).isLoadingMoreResults=!0})).addCase(zd.rejected,((e,{meta:t})=>{DC(e,t.arg).isLoadingMoreResults=!1})).addCase(zd.fulfilled,((e,{payload:{collectionId:t,results:r,rootResult:n,searchUid:a}})=>{let i=TC(r,e.fields,a,n);if(!i||!i[t])throw new Error(`Unable to create collection ${t} from received results: ${JSON.stringify(r)}. Folding most probably in an invalid state... `);e.collections[t]=i[t],e.collections[t].moreResultsAvailable=!1})))),PC=new o(Nd);function jC(e,t,r){!function(e){e.addReducers({search:tu,configuration:nd,folding:MC,query:GS})}(e);let n=uS(e,t),{dispatch:a}=e,i=t.options?.folding?We(e,PC,t.options.folding,"buildFoldedResultList"):{};return a(Bd({...i})),{...n,loadCollection:n=>{a(t.loadCollectionActionCreator(n.result.raw[e.state.folding.fields.collection])),a(r.logShowMoreFoldedResults(n.result))},logShowMoreFoldedResults:e=>{a(r.logShowMoreFoldedResults(e))},logShowLessFoldedResults:()=>{a(r.logShowLessFoldedResults())},findResultById(e){return VC(this.state.results,(t=>t.result.uniqueId===e.result.uniqueId))},findResultByCollection(e){return VC(this.state.results,(t=>t.result.raw.foldingcollection===e.result.raw.foldingcollection))},get state(){let t=e.state;return{...n.state,results:n.state.results.map((e=>{let r=e.raw[t.folding.fields.collection];return r&&t.folding.collections[r]?t.folding.collections[r]:{result:e,moreResultsAvailable:!1,isLoadingMoreResults:!1,children:[]}}))}}}}function VC(e,t){for(let r=0;r<e.length;r++){let n=e[r];if(t(n))return n;if(n.children.length){let e=VC(n.children,t);if(e)return e}}return null}function _C(e,t={}){let r=jC(e,{...t,loadCollectionActionCreator:zd,fetchMoreResultsActionCreator:Qc},xC);return{...r,get state(){return r.state}}}function UC(e){return e.query="",e.queryModification={originalQuery:"",newQuery:"",queryToIgnore:e.queryModification.queryToIgnore},e}var QC=Ir({redirectTo:"",query:"",executions:[],notifications:[],queryModification:{originalQuery:"",newQuery:"",queryToIgnore:""}},(e=>e.addCase(_c.pending,UC).addCase(_c.fulfilled,((e,t)=>function(e,t){let r=[],n=[],a=[],i=[];return t.forEach((e=>{switch(e.type){case"redirect":r.push(e.content);break;case"query":n.push(e.content);break;case"execute":a.push({functionName:e.content.name,params:e.content.params});break;case"notify":i.push(e.content)}})),e.redirectTo=r[0]??"",e.query=e.queryModification.newQuery,e.executions=a,e.notifications=i,e}(e,t.payload.response.triggers))).addCase(uc,((e,t)=>function(e,t){return e.queryModification={...t,queryToIgnore:""},e}(e,t.payload))).addCase(cc,((e,t)=>function(e,t){return e.queryModification.queryToIgnore=t,e}(e,t.payload)))));function $C(e){!function(e){e.addReducers({triggers:QC})}(e);let t=Td(e),{dispatch:r}=e,n=()=>e.state,a=n().triggers.redirectTo;return{...t,subscribe(t){let n=()=>{let e=a!==this.state.redirectTo;a=this.state.redirectTo,e&&this.state.redirectTo&&(t(),r(sc()))};return n(),e.subscribe(n)},get state(){return{redirectTo:n().triggers.redirectTo}}}}function LC(e){!function(e){e.addReducers({triggers:QC,query:GS})}(e);let t=Td(e),{dispatch:r}=e,n=()=>e.state,a=()=>n().triggers.queryModification.newQuery,i=()=>n().triggers.queryModification.originalQuery;return{...t,get state(){return{newQuery:a(),originalQuery:i(),wasQueryModified:""!==a()}},undo(){r(cc(a())),r(po({q:i()})),r(_c({legacy:ac({undoneQuery:a()}),next:{actionCause:"undoQuery"}}))}}}function NC(e){!function(e){e.addReducers({triggers:QC})}(e);let t=Td(e),{dispatch:r}=e,n=()=>e.state,a=n().triggers.executions;return{...t,subscribe(t){let n=()=>{let e=!uv(this.state.executions,a,((e,t)=>e.functionName===t.functionName&&uv(e.params,t.params)));a=this.state.executions,e&&this.state.executions.length&&(t(),r(oc()))};return n(),e.subscribe(n)},get state(){return{executions:n().triggers.executions}}}}function BC(e,t){let r=t.options.logNotifyTriggerActionCreator;!function(e){e.addReducers({triggers:QC})}(e);let n=Td(e),{dispatch:a}=e,i=()=>e.state,s=i().triggers.notifications;return{...n,subscribe(t){let n=()=>{let e=!uv(s,this.state.notifications);s=this.state.notifications,e&&(t(),a(r()))};return n(),e.subscribe(n)},get state(){return{notifications:i().triggers.notifications}}}}function zC(e){return BC(e,{options:{logNotifyTriggerActionCreator:ic}})}var HC=()=>new r({values:{questionAnswerId:_e},options:{required:!0}}),YC=()=>new r({values:{linkText:Qe,linkURL:Qe},options:{required:!0}});function WC(e){return He(e,HC())}function GC(e,t){let r=t??e.search?.questionAnswer?.documentId;return r&&e.search&&function(e,t,r){return e.search.results.find((e=>Wc(e,t)===r))}(e,r.contentIdKey,r.contentIdValue)}function KC(e,t){let r=e.questionAnswering?.relatedQuestions.findIndex((e=>e.questionAnswerId===t))??-1;return-1===r?null:e.search?.questionAnswer?.relatedQuestions?.[r]??null}var JC=()=>ns({prefix:"analytics/smartSnippet/expand",__legacy__getBuilder:e=>e.makeExpandSmartSnippet(),analyticsType:"SmartSnippets.AnswerAction",analyticsPayloadBuilder:e=>{let t=GC(e),r=os(t),n=e.search?.response.searchUid;if(n)return{action:"expand",snippetType:"SmartSnippet",responseId:n,itemMetadata:{uniqueFieldName:r.contentIDKey,uniqueFieldValue:r.contentIDValue,title:t.title,url:t.clickUri}}}}),ZC=()=>ns({prefix:"analytics/smartSnippet/collapse",__legacy__getBuilder:e=>e.makeCollapseSmartSnippet(),analyticsType:"SmartSnippets.AnswerAction",analyticsPayloadBuilder:e=>{let t=GC(e),r=os(t),n=e.search?.response.searchUid;if(n)return{action:"collapse",snippetType:"SmartSnippet",responseId:n,itemMetadata:{uniqueFieldName:r.contentIDKey,uniqueFieldValue:r.contentIDValue,title:t.title,url:t.clickUri}}}}),XC=()=>ns({prefix:"analytics/smartSnippet/like",__legacy__getBuilder:e=>e.makeLikeSmartSnippet(),analyticsType:"SmartSnippets.AnswerAction",analyticsPayloadBuilder:e=>{let t=GC(e),r=os(t),n=e.search?.response.searchUid;if(n)return{action:"like",snippetType:"SmartSnippet",responseId:n,itemMetadata:{uniqueFieldName:r.contentIDKey,uniqueFieldValue:r.contentIDValue,title:t.title,url:t.clickUri}}}}),eI=()=>ns({prefix:"analytics/smartSnippet/dislike",__legacy__getBuilder:e=>e.makeDislikeSmartSnippet(),analyticsType:"SmartSnippets.AnswerAction",analyticsPayloadBuilder:e=>{let t=GC(e),r=os(t),n=e.search?.response.searchUid;if(n)return{action:"dislike",snippetType:"SmartSnippet",responseId:n,itemMetadata:{uniqueFieldName:r.contentIDKey,uniqueFieldValue:r.contentIDValue,title:t.title,url:t.clickUri}}}}),tI=()=>ns({prefix:"analytics/smartSnippet/source/open",__legacy__getBuilder:(e,t)=>{let r=GC(t);return e.makeOpenSmartSnippetSource(as(r,t),os(r))},analyticsType:"SmartSnippets.SourceClick",analyticsPayloadBuilder:e=>{let t=GC(e),r=os(t),n=e.search?.response.searchUid;if(n)return{snippetType:"SmartSnippet",responseId:n,itemMetadata:{uniqueFieldName:r.contentIDKey,uniqueFieldValue:r.contentIDValue,title:t.title,url:t.clickUri}}}}),rI=e=>ns({prefix:"analytics/smartSnippet/source/open",__legacy__getBuilder:(t,r)=>{He(e,YC());let n=GC(r);return n?t.makeOpenSmartSnippetInlineLink(as(n,r),{...os(n),...e}):null},analyticsType:"SmartSnippets.SourceClick",analyticsPayloadBuilder:e=>{let t=GC(e),r=os(t),n=e.search?.response.searchUid;if(n)return{snippetType:"SmartSnippet",responseId:n,itemMetadata:{uniqueFieldName:r.contentIDKey,uniqueFieldValue:r.contentIDValue,title:t.title,url:t.clickUri}}}}),nI=()=>ns("analytics/smartSnippet/feedbackModal/open",(e=>e.makeOpenSmartSnippetFeedbackModal())),aI=()=>ns("analytics/smartSnippet/feedbackModal/close",(e=>e.makeCloseSmartSnippetFeedbackModal())),iI={does_not_answer:"doesNotAnswer",partially_answers:"partiallyAnswers",was_not_a_question:"wasNotAQuestion"},sI=e=>ns({prefix:"analytics/smartSnippet/sendFeedback",__legacy__getBuilder:t=>t.makeSmartSnippetFeedbackReason(e),analyticsType:"SmartSnippets.SubmitFeedback",analyticsPayloadBuilder:t=>{let r=GC(t),n=os(r),a=t.search?.response.searchUid;if(a)return{responseId:a,snippetType:"SmartSnippet",itemMetadata:{uniqueFieldName:n.contentIDKey,uniqueFieldValue:n.contentIDValue,title:r.title,url:r.clickUri},reason:iI[e]}}}),oI=e=>ns({prefix:"analytics/smartSnippet/sendFeedback",__legacy__getBuilder:t=>t.makeSmartSnippetFeedbackReason("other",e),analyticsType:"SmartSnippets.SubmitFeedback",analyticsPayloadBuilder:t=>{let r=GC(t),n=os(r),a=t.search?.response.searchUid;if(a)return{responseId:a,snippetType:"SmartSnippet",itemMetadata:{uniqueFieldName:n.contentIDKey,uniqueFieldValue:n.contentIDValue,title:r.title,url:r.clickUri},reason:"other",additionalNotes:e}}}),cI=e=>ns({prefix:"analytics/smartSnippetSuggestion/expand",__legacy__getBuilder:(t,r)=>{WC(e);let n=KC(r,e.questionAnswerId);return n?t.makeExpandSmartSnippetSuggestion({question:n.question,answerSnippet:n.answerSnippet,documentId:n.documentId}):null},analyticsType:"SmartSnippets.AnswerAction",analyticsPayloadBuilder:t=>{let r=KC(t,e.questionAnswerId),n=t.search?.response.searchUid;if(n&&r){let e=GC(t,r.documentId);return{action:"expand",responseId:n,snippetType:"SmartSnippetSuggestion",itemMetadata:{uniqueFieldName:r.documentId.contentIdKey,uniqueFieldValue:r.documentId.contentIdValue,title:e?.title,url:e?.clickUri}}}}}),uI=e=>ns({prefix:"analytics/smartSnippetSuggestion/collapse",__legacy__getBuilder:(t,r)=>{WC(e);let n=KC(r,e.questionAnswerId);return n?t.makeCollapseSmartSnippetSuggestion({question:n.question,answerSnippet:n.answerSnippet,documentId:n.documentId}):null},analyticsType:"SmartSnippets.AnswerAction",analyticsPayloadBuilder:t=>{let r=KC(t,e.questionAnswerId),n=t.search?.response.searchUid;if(n&&r){let e=GC(t,r.documentId);return{action:"collapse",responseId:n,snippetType:"SmartSnippetSuggestion",itemMetadata:{uniqueFieldName:r.documentId.contentIdKey,uniqueFieldValue:r.documentId.contentIdValue,title:e?.title,url:e?.clickUri}}}}}),lI=e=>ns({prefix:"analytics/smartSnippetSuggestion/source/open",__legacy__getBuilder:(t,r)=>{He(e,HC());let n=KC(r,e.questionAnswerId);if(!n)return null;let a=GC(r,n.documentId);return a?t.makeOpenSmartSnippetSuggestionSource(as(a,r),{question:n.question,answerSnippet:n.answerSnippet,documentId:n.documentId}):null},analyticsType:"SmartSnippets.SourceClick",analyticsPayloadBuilder:t=>{let r=KC(t,e.questionAnswerId),n=t.search?.response.searchUid;if(n&&r){let e=GC(t,r.documentId);return{responseId:n,snippetType:"SmartSnippetSuggestion",itemMetadata:{uniqueFieldName:r.documentId.contentIdKey,uniqueFieldValue:r.documentId.contentIdValue,title:e?.title,url:e?.clickUri}}}}}),dI=(e,t)=>ns({prefix:"analytics/smartSnippetSuggestion/source/open",__legacy__getBuilder:(r,n)=>{He(e,HC()),He(t,YC());let a=KC(n,e.questionAnswerId);if(!a)return null;let i=GC(n,a.documentId);return i?r.makeOpenSmartSnippetSuggestionInlineLink(as(i,n),{question:a.question,answerSnippet:a.answerSnippet,documentId:a.documentId,linkText:t.linkText,linkURL:t.linkURL}):null},analyticsType:"SmartSnippets.SourceClick",analyticsPayloadBuilder:t=>{let r=KC(t,e.questionAnswerId),n=t.search?.response.searchUid;if(n&&r){let e=GC(t,r.documentId);return{responseId:n,snippetType:"SmartSnippetSuggestion",itemMetadata:{uniqueFieldName:r.documentId.contentIdKey,uniqueFieldValue:r.documentId.contentIdValue,title:e?.title,url:e?.clickUri}}}}}),fI={logExpandSmartSnippet:JC,logCollapseSmartSnippet:ZC,logLikeSmartSnippet:XC,logDislikeSmartSnippet:eI,logOpenSmartSnippetSource:tI,logOpenSmartSnippetInlineLink:rI,logOpenSmartSnippetFeedbackModal:nI,logCloseSmartSnippetFeedbackModal:aI,logSmartSnippetFeedback:sI,logSmartSnippetDetailedFeedback:oI,logExpandSmartSnippetSuggestion:cI,logCollapseSmartSnippetSuggestion:uI,logOpenSmartSnippetSuggestionSource:lI},pI=dr("smartSnippet/expand"),gI=dr("smartSnippet/collapse"),hI=dr("smartSnippet/like"),yI=dr("smartSnippet/dislike"),mI=dr("smartSnippet/feedbackModal/open"),vI=dr("smartSnippet/feedbackModal/close"),SI=dr("smartSnippet/related/expand",(e=>WC(e))),wI=dr("smartSnippet/related/collapse",(e=>WC(e))),bI=(e,t)=>e.findIndex((e=>e.questionAnswerId===t.questionAnswerId));function CI({question:e,answerSnippet:t,documentId:{contentIdKey:r,contentIdValue:n}}){return W({question:e,answerSnippet:t,contentIdKey:r,contentIdValue:n})}var II=Ir({liked:!1,disliked:!1,expanded:!1,feedbackModalOpen:!1,relatedQuestions:[]},(e=>e.addCase(pI,(e=>{e.expanded=!0})).addCase(gI,(e=>{e.expanded=!1})).addCase(hI,(e=>{e.liked=!0,e.disliked=!1,e.feedbackModalOpen=!1})).addCase(yI,(e=>{e.liked=!1,e.disliked=!0})).addCase(mI,(e=>{e.feedbackModalOpen=!0})).addCase(vI,(e=>{e.feedbackModalOpen=!1})).addCase(_c.fulfilled,((e,t)=>{let r=t.payload.response.questionAnswer.relatedQuestions.map(((t,r)=>function(e,t){let r=CI(e);return t&&r===t.questionAnswerId?t:{contentIdKey:e.documentId.contentIdKey,contentIdValue:e.documentId.contentIdValue,expanded:!1,questionAnswerId:r}}(t,e.relatedQuestions[r]))),n=CI(t.payload.response.questionAnswer);return e.questionAnswerId===n?{...e,relatedQuestions:r}:{liked:!1,disliked:!1,expanded:!1,feedbackModalOpen:!1,relatedQuestions:[],relatedQuestions:r,questionAnswerId:n}})).addCase(SI,((e,t)=>{let r=bI(e.relatedQuestions,t.payload);-1!==r&&(e.relatedQuestions[r].expanded=!0)})).addCase(wI,((e,t)=>{let r=bI(e.relatedQuestions,t.payload);-1!==r&&(e.relatedQuestions[r].expanded=!1)}))));function qI(e,t,r){!function(e){e.addReducers({search:tu,questionAnswering:II})}(e);let n=Td(e),a=()=>e.state,i=()=>GC(a()),s=null,o=yS(e,{options:{selectionDelay:r?.options?.selectionDelay}},(()=>{let r=i();if(!r)return void(s=null);let{searchResponseId:n}=a().search;s!==n&&(s=n,e.dispatch(t.logOpenSmartSnippetSource()),e.dispatch(pS(r)))}));return{...n,get state(){let e=a();return{question:e.search.questionAnswer.question,answer:e.search.questionAnswer.answerSnippet,documentId:e.search.questionAnswer.documentId,expanded:e.questionAnswering.expanded,answerFound:""!==e.search.questionAnswer.answerSnippet,liked:e.questionAnswering.liked,disliked:e.questionAnswering.disliked,feedbackModalOpen:e.questionAnswering.feedbackModalOpen,source:i()}},expand(){e.dispatch(t.logExpandSmartSnippet()),e.dispatch(pI())},collapse(){e.dispatch(t.logCollapseSmartSnippet()),e.dispatch(gI())},like(){e.dispatch(t.logLikeSmartSnippet()),e.dispatch(hI())},dislike(){e.dispatch(t.logDislikeSmartSnippet()),e.dispatch(yI())},openFeedbackModal(){e.dispatch(t.logOpenSmartSnippetFeedbackModal()),e.dispatch(mI())},closeFeedbackModal(){e.dispatch(t.logCloseSmartSnippetFeedbackModal()),e.dispatch(vI())},sendFeedback(r){e.dispatch(t.logSmartSnippetFeedback(r)),e.dispatch(vI())},sendDetailedFeedback(r){e.dispatch(t.logSmartSnippetDetailedFeedback(r)),e.dispatch(vI())},selectSource(){o.select()},beginDelayedSelectSource(){o.beginDelayedSelect()},cancelPendingSelectSource(){o.cancelPendingSelect()}}}function kI(e,t){!function(e){e.addReducers({search:tu,questionAnswering:II})}(e);let r=new Set,n=null,a=(n,a,i)=>yS(e,{options:{selectionDelay:t?.options?.selectionDelay}},(()=>{(e=>!!r.has(e)||(r.add(e),!1))(a)||e.dispatch(i?dI({questionAnswerId:i},n):rI(n))})),i={},s=(t,s)=>{let{searchResponseId:o}=e.state.search;(e=>{n!==e&&(n=e,i={},r.clear())})(o);let c=W({...t,questionAnswerId:s});return c in i||(i[c]=a(t,c,s)),i[c]};return{selectInlineLink(e,t){s(e,t)?.select()},beginDelayedSelectInlineLink(e,t){s(e,t)?.beginDelayedSelect()},cancelPendingSelectInlineLink(e,t){s(e,t)?.cancelPendingSelect()}}}function xI(e,t){let r=qI(e,fI,t),n=kI(e,{options:{selectionDelay:t?.options?.selectionDelay}});return{...r,get state(){return r.state},selectInlineLink(e){n.selectInlineLink(e)},beginDelayedSelectInlineLink(e){n.beginDelayedSelectInlineLink(e)},cancelPendingSelectInlineLink(e){n.cancelPendingSelectInlineLink(e)}}}function AI(e,t){!function(e){e.addReducers({search:tu,questionAnswering:II})}(e);let r=Td(e),n=t=>{let{contentIdKey:r,contentIdValue:n}=t;return e.state.search.results.find((e=>Wc(e,r)===n))};return{...r,get state(){let t=e.state;return{questions:t.search.questionAnswer.relatedQuestions.map(((e,r)=>({question:e.question,answer:e.answerSnippet,documentId:e.documentId,questionAnswerId:t.questionAnswering.relatedQuestions[r].questionAnswerId,expanded:t.questionAnswering.relatedQuestions[r].expanded,source:n(e.documentId)})))}},expand(r){let n={questionAnswerId:r};e.dispatch(t.logExpandSmartSnippetSuggestion(n)),e.dispatch(SI(n))},collapse(r){let n={questionAnswerId:r};e.dispatch(t.logCollapseSmartSnippetSuggestion(n)),e.dispatch(wI(n))}}}function RI(e,t){!function(e){e.addReducers({search:tu,questionAnswering:II})}(e);let r=()=>e.state,n=new Set,a=null,i=(r,a)=>yS(e,{options:{selectionDelay:t?.options?.selectionDelay}},(()=>{(e=>!!n.has(e)||(n.add(e),!1))(a)||(e.dispatch(lI({questionAnswerId:a})),e.dispatch(pS(r)))})),s={},o=e=>{let{searchResponseId:t}=r().search;(e=>{a!==e&&(a=e,s={},n.clear())})(t);let o=(e=>{let t=r(),n=KC(t,e);return n?GC(t,n.documentId):null})(e);return o?(e in s||(s[e]=i(o,e)),s[e]):null};return{selectSource(e){o(e)?.select()},beginDelayedSelectSource(e){o(e)?.beginDelayedSelect()},cancelPendingSelectSource(e){o(e)?.cancelPendingSelect()}}}function OI(e,t){let r=AI(e,fI),n=kI(e,{options:{selectionDelay:t?.options?.selectionDelay}}),a=RI(e,{options:{selectionDelay:t?.options?.selectionDelay}});return{...r,get state(){return r.state},selectSource(e){a.selectSource(e)},beginDelayedSelectSource(e){a.beginDelayedSelectSource(e)},cancelPendingSelectSource(e){a.cancelPendingSelectSource(e)},selectInlineLink(e,t){n.selectInlineLink(t,e)},beginDelayedSelectInlineLink(e,t){n.beginDelayedSelectInlineLink(t,e)},cancelPendingSelectInlineLink(e,t){n.cancelPendingSelectInlineLink(t,e)}}}var FI={queries:new t({required:!0,each:new e({emptyAllowed:!1})}),maxLength:new s({required:!0,min:1,default:10})},EI=dr("recentQueries/registerRecentQueries",(e=>He(e,FI))),TI=dr("recentQueries/clearRecentQueries");var DI=Ir({queries:[],maxLength:10},(e=>{e.addCase(EI,MI).addCase(TI,PI).addCase(_c.fulfilled,((e,t)=>{let r=t.payload.queryExecuted.trim(),n=t.payload.response.results;!r.length||!n.length||function(e,t){t.queries=t.queries.filter((t=>t!==e));let r=t.queries.slice(0,t.maxLength-1);t.queries=[e,...r]}(r,e)}))}));function MI(e,t){e.queries=t.payload.queries.slice(0,t.payload.maxLength),e.maxLength=t.payload.maxLength}function PI(e){e.queries=[]}var jI={queries:[]},VI={maxLength:10,clearFilters:!0},_I=new o({queries:new t({required:!0})}),UI=new o({maxLength:new s({required:!0,min:1}),clearFilters:new a});function QI(e,t){!function(e){e.addReducers({search:tu,recentQueries:DI})}(e);let r=Td(e),{dispatch:n}=e,a={...VI,...t?.options},i={...jI,...t?.initialState};!function(e,t){We(e,UI,t?.options,"buildRecentQueriesList"),Ye(e,_I,t?.initialState,"buildRecentQueriesList")}(e,{options:a,initialState:i});let o={queries:i.queries,maxLength:a.maxLength};return n(EI(o)),{...r,get state(){let t=e.state;return{...t.recentQueries,analyticsEnabled:t.configuration.analytics.enabled}},clear(){n(ns("analytics/recentQueries/clear",(e=>e.makeClearRecentQueries()))),n(TI())},executeRecentQuery(t){let r=new s({required:!0,min:0,max:this.state.queries.length}).validate(t);if(r)throw new Error(r);let i={q:this.state.queries[t],clearFilters:a.clearFilters};d(e.state.query?.enableQuerySyntax)&&(i.enableQuerySyntax=e.state.query.enableQuerySyntax),n(Vc(i)),n(_c({legacy:ns("analytics/recentQueries/click",(e=>e.makeRecentQueryClick()))}))}}}var $I=Ir({results:[],maxLength:10},(e=>{e.addCase(fS,((e,t)=>{e.results=t.payload.results.slice(0,t.payload.maxLength),e.maxLength=t.payload.maxLength})).addCase(gS,(e=>{e.results=[]})).addCase(pS,((e,t)=>{let r=t.payload;e.results=e.results.filter((e=>e.uniqueId!==r.uniqueId));let n=e.results.slice(0,e.maxLength-1);e.results=[r,...n]}))})),LI={initialState:{results:[]},options:{maxLength:10}},NI=new o({results:new t({required:!0})}),BI=new o({maxLength:new s({required:!0,min:1})});function zI(e,t){!function(e){e.addReducers({recentResults:$I})}(e);let r=Td(e),{dispatch:n}=e,a={...LI,...t};!function(e,t){We(e,BI,t?.options,"buildRecentResultsList"),Ye(e,NI,t?.initialState,"buildRecentResultsList")}(e,a);let i={results:a.initialState.results,maxLength:a.options.maxLength};return n(fS(i)),{...r,get state(){return e.state.recentResults},clear(){n(ns("analytics/recentResults/clear",(e=>e.makeClearRecentResults()))),n(gS())}}}function HI(e,t){return yS(e,t,(()=>e.dispatch((e=>ns("analytics/recentResults/click",((t,r)=>(ps(e),t.makeRecentResultClick(as(e,r),os(e))))))(t.options.result))))}function YI(e,t){!function(e){e.addReducers({facetOptions:Rh})}(e);let r=t=>e.state.facetOptions.facets[t]?.enabled??!1,n=t=>e.state.facetSet?.[t]?.request?.currentValues??e.state.categoryFacetSet?.[t]?.request?.currentValues??e.state.numericFacetSet?.[t]?.request?.currentValues??e.state.dateFacetSet?.[t]?.request?.currentValues??null,a=t=>t in e.state.facetOptions.facets,i=()=>W({isFacetRegistered:a(t.facetId),parentFacets:t.conditions.map((({parentFacetId:e})=>a(e)?{enabled:r(e),values:n(e)}:null))}),s=()=>{if(!a(t.facetId))return;let i=r(t.facetId),s=t.conditions.some((e=>{if(!r(e.parentFacetId))return!1;let t=n(e.parentFacetId);return null!==t&&e.condition(t)}));i!==s&&(e.dispatch(s?xf(t.facetId):Af(t.facetId)),e.state.facetSet&&Object.entries(e.state.facetSet).forEach((([t,r])=>r.request.freezeCurrentValues&&e.dispatch(th({facetId:t,freezeCurrentValues:!1})))))};if(!t.conditions.length)return{stopWatching(){}};let o=i(),c=e.subscribe((()=>{(()=>{let e=i();return e!==o&&(o=e,!0)})()&&s()}));return s(),{stopWatching(){c()}}}function WI(e,t){!function(e){e.addReducers({facetSet:Kh,configuration:ad,facetSearchSet:Wh,search:tu})}(e);let{facetSearch:r,allowedValues:n,...a}=t.options.facet,i=Dh(e,a);e.dispatch(Wg({...Xh,...a,facetId:i,...n&&{allowedValues:{type:"simple",values:n}}}));let s=ly(e,{options:{...r,facetId:i},select:t=>{e.dispatch(kf()),e.dispatch(_c({legacy:bg({facetId:i,facetValue:t.rawValue}),next:Ag()}))},exclude:t=>{e.dispatch(kf()),e.dispatch(_c({legacy:Cg({facetId:i,facetValue:t.rawValue}),next:Rg()}))},isForFieldSuggestions:!0,executeFacetSearchActionCreator:sg,executeFieldSuggestActionCreator:og});return{...Td(e),...s,updateText:function(e){s.updateText(e),s.search()},get state(){return s.state}}}function GI(e,t){!function(e){e.addReducers({categoryFacetSet:Yf,configuration:ad,categoryFacetSearchSet:hg,search:tu})}(e);let{facetSearch:r,...n}=t.options.facet,a=Dh(e,n);e.dispatch($f({...Wf,...n,facetId:a}));let i=Vh(e,{options:{...r,facetId:a},executeFacetSearchActionCreator:sg,executeFieldSuggestActionCreator:og,select:t=>{e.dispatch(kf()),e.dispatch(_c({legacy:bg({facetId:a,facetValue:t.rawValue}),next:Ag()}))},isForFieldSuggestions:!0});return{...Td(e),...i,updateText:function(e){i.updateText(e),i.search()},get state(){return i.state}}}var KI=Ir({desiredCount:5,numberOfValues:8,set:{}},(e=>{e.addCase(_c.fulfilled,((e,t)=>{e.set={},t.payload.response.generateAutomaticFacets?.facets?.forEach((t=>{e.set[t.field]={response:t}}))})).addCase(Pv,((e,t)=>{t.payload.desiredCount&&(e.desiredCount=t.payload.desiredCount),t.payload.numberOfValues&&(e.numberOfValues=t.payload.numberOfValues)})).addCase(_v,((e,t)=>{let{field:r,selection:n}=t.payload,a=e.set[r]?.response;if(!a)return;let i=a.values.find((e=>e.value===n.value));if(!i)return;let s="selected"===i.state;i.state=s?"idle":"selected"})).addCase(jv,((e,t)=>{let r=t.payload,n=e.set[r]?.response;if(n)for(let e of n.values)e.state="idle"})).addCase(Ps,((e,t)=>{let r=t.payload.af??{},n=Object.keys(e.set);for(let t in r)if(!e.set[t]){let n=JI(t),a=r[t].map((e=>ZI(e)));n.values.push(...a),e.set[t]={response:n}}for(let t of n)if(!(t in r)){let r=e.set[t]?.response;for(let e of r.values)e.state="idle"}for(let t in r){let n=e.set[t]?.response;if(n){let e=n.values,a=new Set(r[t]);for(let t of e)a.has(t.value)?(t.state="selected",a.delete(t.value)):t.state="idle";for(let e of a)n.values.push(ZI(e))}}})).addCase(zs.fulfilled,((e,t)=>{if(t.payload&&0!==Object.keys(t.payload.automaticFacetSet.set).length)return t.payload.automaticFacetSet})).addCase(Ks,(e=>{Object.values(e.set).forEach((({response:e})=>{e.values.forEach((e=>e.state="idle"))}))}))}));function JI(e){return{field:e,values:[],moreValuesAvailable:!1,label:"",indexScore:0}}function ZI(e){return{value:e,state:"selected",numberOfResults:0}}function XI(e,t){!function(e){e.addReducers({automaticFacetSet:KI,configuration:ad,search:tu})}(e);let{dispatch:r}=e,n=function(e){return{desiredCount:e.desiredCount,numberOfValues:e.numberOfValues}}(t.options);return r(Pv(n)),{...Td(e),get state(){return{automaticFacets:e.state.search.response.generateAutomaticFacets?.facets.map((t=>function(e,t){let{dispatch:r}=e,n=Td(e),{field:a}=t;return{...n,toggleSelect(e){r(_v({field:a,selection:e})),r(_c({legacy:sy(a,e),next:oy(e)}))},deselectAll(){r(jv(a)),r(_c({legacy:wg(a),next:xg()}))},get state(){let t=e.state.automaticFacetSet?.set[a]?.response;return t?{field:t.field,label:t.label,values:t.values}:{field:"",values:[],label:""}}}}(e,{field:t.field})))??[]}}}}var eq=Ir({id:"",isVisible:!0,isEnabled:!0,isLoading:!1,isStreaming:!1,citations:[],liked:!1,disliked:!1,responseFormat:{contentFormat:["text/plain"]},feedbackModalOpen:!1,feedbackSubmitted:!1,fieldsToIncludeInCitations:[],isAnswerGenerated:!1,expanded:!1},(e=>e.addCase(hu,((e,{payload:t})=>{e.isVisible=t})).addCase(yu,((e,{payload:t})=>{e.isEnabled=t})).addCase(xu,((e,{payload:t})=>{e.id=t.id})).addCase(mu,((e,{payload:t})=>{e.isLoading=!1,e.isStreaming=!0,e.answer||(e.answer=""),e.answer+=t.textDelta,delete e.error})).addCase(vu,((e,{payload:t})=>{e.isLoading=!1,e.isStreaming=!0;let r=new Map;for(let n of[e.citations,t.citations])for(let e of n)r.set(e.uri,e);e.citations=Array.from(r.values()),delete e.error})).addCase(Su,((e,{payload:t})=>{e.isLoading=!1,e.isStreaming=!1,e.error={...t,isRetryable:1===t.code},e.citations=[],delete e.answer})).addCase(bu,(e=>{e.liked=!0,e.disliked=!1})).addCase(Cu,(e=>{e.liked=!1,e.disliked=!0})).addCase(Iu,(e=>{e.feedbackModalOpen=!0})).addCase(Au,(e=>{e.feedbackModalOpen=!1})).addCase(Ru,(e=>{e.feedbackSubmitted=!0})).addCase(wu,(e=>({id:"",isVisible:!0,isEnabled:!0,isLoading:!1,isStreaming:!1,citations:[],liked:!1,disliked:!1,responseFormat:{contentFormat:["text/plain"]},feedbackModalOpen:!1,feedbackSubmitted:!1,fieldsToIncludeInCitations:[],isAnswerGenerated:!1,expanded:!1,...e.answerConfigurationId?{answerConfigurationId:e.answerConfigurationId}:{},responseFormat:e.responseFormat,fieldsToIncludeInCitations:e.fieldsToIncludeInCitations,isVisible:e.isVisible,id:e.id}))).addCase(Ou,((e,{payload:t})=>{e.isLoading=t})).addCase(Fu,((e,{payload:t})=>{e.isStreaming=t})).addCase(Eu,((e,{payload:t})=>{e.answerContentFormat=t})).addCase(Tu,((e,{payload:t})=>{e.responseFormat=t})).addCase(Mu,((e,t)=>{e.fieldsToIncludeInCitations=[...new Set(e.fieldsToIncludeInCitations.concat(t.payload))]})).addCase(Pu,((e,{payload:t})=>{e.isAnswerGenerated=t})).addCase(qu,(e=>{e.expanded=!0})).addCase(ku,(e=>{e.expanded=!1})).addCase(Du,((e,{payload:t})=>{e.answerConfigurationId=t}))));function tq(e,t,r={}){!function(e){e.addReducers({generatedAnswer:eq})}(e);let{dispatch:n}=e,a=Td(e),i=r.initialState?.isVisible;void 0!==i&&n(hu(i));let s=r.initialState?.responseFormat;s&&n(Tu(s));let o=r.fieldsToIncludeInCitations;return o&&n(Mu(o)),r.initialState?.expanded&&n(qu()),{...a,get state(){return e.state.generatedAnswer},like(){this.state.liked||(n(bu()),n(t.logLikeGeneratedAnswer()))},dislike(){this.state.disliked||(n(Cu()),n(t.logDislikeGeneratedAnswer()))},openFeedbackModal(){n(Iu())},closeFeedbackModal(){n(Au())},sendFeedback(e){n(t.logGeneratedAnswerFeedback(e)),n(Ru())},logCitationClick(e){n(t.logOpenGeneratedAnswerSource(e))},logCitationHover(e,r){n(t.logHoverCitation(e,r))},show(){this.state.isVisible||(n(hu(!0)),n(t.logGeneratedAnswerShowAnswers()))},hide(){this.state.isVisible&&(n(hu(!1)),n(t.logGeneratedAnswerHideAnswers()))},expand(){this.state.expanded||(n(qu()),n(t.logGeneratedAnswerExpand()))},collapse(){this.state.expanded&&(n(ku()),n(t.logGeneratedAnswerCollapse()))},enable(){this.state.isEnabled||n(yu(!0))},disable(){this.state.isEnabled&&n(yu(!1))},logCopyToClipboard(){n(t.logCopyGeneratedAnswer())},retry(){}}}var rq={engines:{},setAbortControllerRef:(e,t)=>{rq.engines[t].abortController=e},getIsStreamInProgress:e=>!(!rq.engines[e].abortController||rq.engines[e].abortController?.signal.aborted)||(rq.engines[e].abortController=void 0,!1),subscribeToSearchRequests:e=>e.subscribe((()=>{let t=e.state,r=t.search.requestId,n=t.search.extendedResults.generativeQuestionAnsweringId,a=t.generatedAnswer.id;if(rq.engines[a].lastRequestId!==r){if(rq.engines[a].lastRequestId=r,rq.engines[a].abortController?.abort(),!1===t.generatedAnswer.isEnabled)return;e.dispatch(wu())}if(!rq.getIsStreamInProgress(a)&&n&&n!==rq.engines[a].lastStreamId){if(rq.engines[a].lastStreamId=n,!1===t.generatedAnswer.isEnabled)return;e.dispatch(ju({setAbortControllerRef:e=>rq.setAbortControllerRef(e,a)}))}}))};function nq(e,t,r={}){!function(e){e.addReducers({generatedAnswer:eq})}(e);let n=tq(e,t,r);if(e.state.generatedAnswer.id&&!rq.engines[e.state.generatedAnswer.id]&&(rq.engines[e.state.generatedAnswer.id]={abortController:void 0,lastRequestId:e.state.search.requestId,lastStreamId:e.state.search.extendedResults.generativeQuestionAnsweringId??""}),!e.state.generatedAnswer.id){let t=B("genQA-",12);e.dispatch(xu({id:t}))}rq.engines[e.state.generatedAnswer.id]||(rq.engines[e.state.generatedAnswer.id]={abortController:void 0,lastRequestId:"",lastStreamId:""}),rq.subscribeToSearchRequests(e);return{...n,get state(){return e.state.generatedAnswer},retry(){"executeFirstSearchAfterStandaloneSearchBoxRedirect"in e&&e.dispatch(_c({legacy:t.logRetryGeneratedAnswer()}))}}}var aq=Vl.injectEndpoints({endpoints:e=>({post:e.mutation({query:e=>({url:"/evaluations",method:"POST",body:e})})})}),iq=e=>"yes"===e||"no"!==e&&null,sq=({answerApiState:e,feedback:t,query:r})=>({additionalNotes:t.details??null,answer:{text:e.answer,responseId:e.answerId,format:e.contentFormat??"text/plain"},correctAnswerUrl:t.documentUrl??null,details:{correctTopic:iq(t.correctTopic),documented:iq(t.documented),hallucinationFree:iq(t.hallucinationFree),readable:iq(t.readable)},helpful:t.helpful,question:r}),oq=e=>{let t;e.subscribe((()=>{let r=e.state,n=Ql(r);(!t||0===n.q.length)&&(t=n),0!==n.q.length&&0!==n.requestId.length&&n.requestId!==t.requestId&&(t=n,e.dispatch(wu()),e.dispatch(Bl(r)))}))};function cq(e,t,r={}){!function(e){e.addReducers({[Ul.reducerPath]:Ul.reducer,query:GS})}(e);let{...n}=tq(e,t,r),a=()=>e.state;return e.dispatch(Du(r.answerConfigurationId)),oq(e),{...n,get state(){let t=zl(e.state).data;return{...a().generatedAnswer,answer:t?.answer,citations:t?.citations??[],error:{message:t?.error?.message,statusCode:t?.error?.code},isLoading:t?.isLoading??!1,isStreaming:t?.isStreaming??!1,answerContentFormat:t?.contentFormat??"text/plain",isAnswerGenerated:t?.generated??!1}},retry(){e.dispatch(Bl(a()))},reset(){e.dispatch(wu())},async sendFeedback(t){let r=sq({query:a().query.q,feedback:t,answerApiState:zl(e.state).data});e.dispatch(aq.endpoints.post.initiate(r)),e.dispatch(Ru())}}}function uq(e,t={}){let r=t.answerConfigurationId?cq(e,uu,t):nq(e,uu,t);return{...r,get state(){return r.state}}}function lq(e,t,r){let n=!1;return yS(e,r,(()=>{n||(n=!0,e.dispatch(t.logOpenGeneratedAnswerSource(r.options.citation.id)))}))}function dq(e,t){return lq(e,uu,t)}var fq=()=>new e({required:!1,emptyAllowed:!0}),pq=dr("advancedSearchQueries/update",(e=>He(e,{aq:fq(),cq:fq(),lq:fq(),dq:fq()}))),gq=dr("advancedSearchQueries/register",(e=>He(e,{aq:fq(),cq:fq(),lq:fq(),dq:fq()}))),hq=Ir(vo(),(e=>{e.addCase(pq,((e,t)=>{let{aq:r,cq:n,lq:a,dq:i}=t.payload;p(r)||(e.aq=r,e.aqWasSet=!0),p(n)||(e.cq=n,e.cqWasSet=!0),p(a)||(e.lq=a,e.lqWasSet=!0),p(i)||(e.dq=i,e.dqWasSet=!0)})).addCase(gq,((e,t)=>{let{aq:r,cq:n,lq:a,dq:i}=t.payload;p(r)||(e.defaultFilters.aq=r,e.aqWasSet||(e.aq=r)),p(n)||(e.defaultFilters.cq=n,e.cqWasSet||(e.cq=n)),p(a)||(e.defaultFilters.lq=a,e.lqWasSet||(e.lq=a)),p(i)||(e.defaultFilters.dq=i,e.dqWasSet||(e.dq=i))})).addCase(zs.fulfilled,((e,t)=>t.payload?.advancedSearchQueries??e)).addCase(Ps,((e,t)=>{let{aq:r,cq:n}=t.payload;p(r)||(e.aq=r,e.aqWasSet=!0),p(n)||(e.cq=n,e.cqWasSet=!0)}))}));function yq(e){return e.addReducers({advancedSearchQueries:hq}),{updateAdvancedSearchQueries:pq,registerAdvancedSearchQueries:gq}}function mq(e){return e.addReducers({categoryFacetSet:Yf}),{deselectAllCategoryFacetValues:Nf,registerCategoryFacet:$f,toggleSelectCategoryFacetValue:Lf,updateCategoryFacetNumberOfValues:Bf,updateCategoryFacetSortCriterion:zf,updateFacetAutoSelection:Zs,updateCategoryFacetBasePath:Hf}}function vq(e){return e.addReducers({facetSet:Kh}),{deselectAllFacetValues:Jg,registerFacet:Wg,toggleSelectFacetValue:Gg,toggleExcludeFacetValue:Kg,updateFacetIsFieldExpanded:eh,updateFacetNumberOfValues:Xg,updateFacetSortCriterion:Zg,updateFreezeCurrentValues:th,updateFacetAutoSelection:Zs}}function Sq(e){return e.addReducers({configuration:ad}),{disableAnalytics:Fs,enableAnalytics:Es,setOriginLevel2:Ts,setOriginLevel3:Ds,updateAnalyticsConfiguration:Os,updateBasicConfiguration:xs}}function wq(e){return e.addReducers({configuration:ad,pipeline:Ys,searchHub:Gs}),{updateSearchConfiguration:As}}function bq(e){return e.addReducers({context:af}),{addContext:rf,removeContext:nf,setContext:tf}}function Cq(e){return e.addReducers({dictionaryFieldContext:vf}),{addContext:yf,removeContext:mf,setContext:hf}}function Iq(e){return e.addReducers({debug:Us}),{disableDebug:Vs,enableDebug:js}}function qq(e){return e.addReducers({dateFacetSet:Qy}),{deselectAllDateFacetValues:mh,registerDateFacet:fh,toggleSelectDateFacetValue:ph,toggleExcludeDateFacetValue:gh,updateDateFacetSortCriterion:yh,updateDateFacetValues:hh}}function kq(e){return e.addReducers({facetOptions:Rh}),{updateFacetOptions:kf,enableFacet:xf,disableFacet:Af}}function xq(e){return e.addReducers({didYouMean:bf,query:GS}),{applyDidYouMeanCorrection:Jo,disableDidYouMean:Wo,enableDidYouMean:Yo,enableAutomaticQueryCorrection:Ko,disableAutomaticQueryCorrection:Go,setCorrectionMode:Zo}}function Aq(e){return e.addReducers({fields:Kd}),{registerFieldsToInclude:Ud,enableFetchAllFields:Qd,disableFetchAllFields:$d,fetchFieldsDescription:Ld}}function Rq(e){return e.addReducers({history:Ev,facetOrder:Cm}),{back:Ns,forward:Bs}}function Oq(e){return e.addReducers({numericFacetSet:Zy}),{deselectAllNumericFacetValues:xh,registerNumericFacet:bh,toggleSelectNumericFacetValue:Ch,toggleExcludeNumericFacetValue:Ih,updateNumericFacetSortCriterion:kh,updateNumericFacetValues:qh}}function Fq(e){return e.addReducers({folding:MC}),{registerFolding:Bd,loadCollection:zd}}function Eq(e){return e.addReducers({pagination:Uv}),{nextPage:lo,previousPage:fo,registerNumberOfResults:so,registerPage:co,updateNumberOfResults:oo,updatePage:uo}}function Tq(e){return e.addReducers({pipeline:Ys}),{setPipeline:Hs}}function Dq(e){return e.addReducers({query:GS}),{updateQuery:po}}function Mq(e){return e.addReducers({querySet:jS}),{registerQuerySetQuery:TS,updateQuerySetQuery:DS}}function Pq(e){return e.addReducers({instantResults:iw}),{registerInstantResults:ro,updateInstantResultsQuery:no,clearExpiredResults:ao}}function jq(e){return e.addReducers({querySuggest:BS,querySet:jS}),{clearQuerySuggest:xS,fetchQuerySuggestions:AS,registerQuerySuggest:IS,selectQuerySuggestion:kS}}function Vq(e){return e.addReducers({search:tu}),{executeSearch:Sc,fetchMoreResults:bc,fetchFacetValues:Cc,fetchPage:wc,fetchInstantResults:Ic}}function _q(e){return e.addReducers({searchHub:Gs}),{setSearchHub:Ws}}function Uq(e){return e.addReducers({sortCriteria:hw}),{registerSortCriterion:fw,updateSortCriterion:pw}}function Qq(e){return e.addReducers({standaloneSearchBoxSet:pb}),{registerStandaloneSearchBox:ib,fetchRedirectUrl:lb,updateStandaloneSearchBoxRedirectionUrl:sb,updateAnalyticsToSearchFromLink:cb,updateAnalyticsToOmniboxFromLink:ub,resetStandaloneSearchBox:ob}}function $q(e){return e.addReducers({staticFilterSet:Ew}),{registerStaticFilter:Cw,toggleSelectStaticFilterValue:Iw,toggleExcludeStaticFilterValue:qw,deselectAllStaticFilterValues:kw}}function Lq(e){return e.addReducers({tabSet:Vw}),{registerTab:Jl,updateActiveTab:Zl}}function Nq(e){return e.addReducers({questionAnswering:II}),{collapseSmartSnippet:gI,expandSmartSnippet:pI,dislikeSmartSnippet:yI,likeSmartSnippet:hI,openFeedbackModal:mI,closeFeedbackModal:vI,expandSmartSnippetRelatedQuestion:SI,collapseSmartSnippetRelatedQuestion:wI}}function Bq(e){return e.addReducers({}),{deselectAllBreadcrumbs:Ks,deselectAllNonBreadcrumbs:Js}}function zq(e){return e.addReducers({recentQueries:DI}),{registerRecentQueries:EI,clearRecentQueries:TI}}function Hq(e){return e.addReducers({recentResults:$I}),{registerRecentResults:fS,clearRecentResults:gS,pushRecentResult:pS}}var Yq=dr("excerptLength/set",(e=>He(e,new s({min:0,required:!0}))));var Wq=Ir({length:void 0},(e=>{e.addCase(Yq,((e,t)=>{e.length=t.payload}))}));function Gq(e){return e.addReducers({excerptLength:Wq}),{setExcerptLength:Yq}}function Kq(e){return e.addReducers({resultPreview:IC}),{fetchResultContent:yC,updateContentURL:wC,nextPreview:mC,previousPreview:vC,preparePreviewPagination:SC}}function Jq(e){return e.addReducers({generatedAnswer:eq}),{resetAnswer:wu}}var Zq=new o({content:new i({required:!0}),conditions:new i({required:!0}),priority:new s({required:!1,default:0,min:0}),fields:new t({required:!1,each:_e})});function Xq(e){!function(e){e.addReducers({fields:Kd})}(e);let{registerTemplates:t,selectTemplate:r,selectLinkTemplate:n}=function(){let e=[],t=e=>{let t=Zq.validate(e);if(!e.conditions.every((e=>e instanceof Function)))throw new f("Each template condition should be a function that takes a Result or Product as an argument and returns a boolean");return t};return{registerTemplates(...r){r.forEach((r=>{let n={...t(r),fields:r.fields||[]};e.push(n)})),e.sort(((e,t)=>t.priority-e.priority))},selectTemplate(t){let r=e.find((e=>e.conditions.every((e=>e(t)))));return r?r.content:null},selectLinkTemplate(t){let r=e.find((e=>e.conditions.every((e=>e(t)))));return r?r.linkContent:null}}}();return{registerTemplates:(...r)=>{t(...r);let n=[];r.forEach((e=>{e.fields&&n.push(...e.fields)})),e.dispatch(Ud(n))},selectTemplate:r,selectLinkTemplate:n}}function ek(e){return e.addReducers({}),{logClearBreadcrumbs:Gw,logInterfaceLoad:Ss,logSearchFromLink:bs,logOmniboxFromLink:Cs,logInterfaceChange:ws,logDidYouMeanClick:Xo,logCategoryFacetBreadcrumb:Ww,logFacetBreadcrumb:kg,logFacetClearAll:wg,logFacetUnexclude:qg,logFacetExclude:Cg,logFacetDeselect:Ig,logFacetSelect:bg,logFacetShowLess:vg,logFacetShowMore:mg,logFacetUpdateSort:Sg,logDateFacetBreadcrumb:Zw,logNumericFacetBreadcrumb:eb,logNavigateBackward:xm,logNavigateForward:km,logPageNext:Jv,logPageNumber:Kv,logPagePrevious:Zv,logPagerResize:Gv,logSearchboxSubmit:OS,logQuerySuggestionClick:$S,logResultsSort:uw,logDislikeSmartSnippet:eI,logLikeSmartSnippet:XC,logOpenSmartSnippetFeedbackModal:nI,logCloseSmartSnippetFeedbackModal:aI,logSmartSnippetFeedback:sI,logSmartSnippetDetailedFeedback:oI,logExpandSmartSnippet:JC,logCollapseSmartSnippet:ZC,logExpandSmartSnippetSuggestion:cI,logCollapseSmartSnippetSuggestion:uI,logNoResultsBack:Am,logStaticFilterSelect:xw,logStaticFilterDeselect:Aw,logStaticFilterClearAll:Rw,logTriggerQuery:nc,logUndoTriggerQuery:ac,logNotifyTrigger:ic,logTriggerRedirect:sc,logTriggerExecute:oc}}function tk(e){return e.addReducers({}),{logDocumentOpen:hS,logOpenSmartSnippetSource:tI,logOpenSmartSnippetSuggestionSource:lI,logOpenSmartSnippetInlineLink:rI,logOpenSmartSnippetSuggestionInlineLink:dI}}function rk(e){return e.addReducers({}),{logSearchEvent:ys,logClickEvent:ms,logCustomEvent:vs}}var nk=Ur("analytics/addPageViewEntry",(async(e,{getState:t})=>{t().configuration.analytics.enabled&&ii.addElement({name:"PageView",value:e,time:JSON.stringify(new Date)})}));function ak(e){return e.addReducers({}),{addPageViewEntryInActionsHistory:nk}}function ik(e){let t=e.split(","),r=new Error(`Wrong criterion expression format for "${e}"`);if(!t.length)throw r;return t.map((t=>{let n=t.trim().split(" "),a=n[0].toLowerCase(),i=n[1]&&n[1].toLowerCase();if(n.length>2||""===a)throw r;if(!function(e){return void 0===e||"ascending"===e||"descending"===e}(i))throw new Error(`Wrong criterion sort order "${i}" in expression "${e}". Order should either be "ascending" or "descending"`);return function(e){let{by:t,order:r}=e;switch(t){case"relevancy":return Li();case"qre":return zi();case"nosort":return Hi();case"date":if(!r)throw new Error('An order (i.e., ascending or descending) should be specified for a sort criterion sorted by "date"');return Ni(r);default:if(!r)throw new Error(`An order (i.e., ascending or descending) should be specified for a sort criterion sorted by a field, such as "${t}"`);return Bi(t,r)}}({by:a,order:i})}))}function sk(e){return e.negate?"NOT ":""}function ok(e){return{contains:"=",differentThan:"<>",fuzzyMatch:"~=",greaterThan:">",greaterThanOrEqual:">=",isExactly:"==",lowerThan:"<",lowerThanOrEqual:"<=",phoneticMatch:"%=",regexMatch:"/=",wildcardMatch:"*="}[e]}function ck(e){return{toQuerySyntax(){let{name:t,parameters:r}=e,n=function(e){return Object.entries(e).map((e=>{let[t,r]=e;return`${t}: ${"string"==typeof r?r:r.toQuerySyntax()}`})).join(", ")}(r);return`$${t}(${n})`}}}function uk(){let e=[],t="and";return{addExpression(t){return e.push(t),this},addKeyword(t){return e.push(function(e){return{toQuerySyntax(){let{expression:t,negate:r}=e;return r?`NOT (${t})`:t}}}(t)),this},addNear(t){return e.push(function(e){return{toQuerySyntax(){let t=sk(e),{startTerm:r,otherTerms:n}=e,a=function(e){return e.map((e=>{let{endTerm:t,maxKeywordsBetween:r}=e;return`near:${r} ${t}`})).join(" ")}(n),i=`${r} ${a}`;return e.negate?`${t}(${i})`:i}}}(t)),this},addExactMatch(t){return e.push(function(e){return{toQuerySyntax(){let t=sk(e),{expression:r}=e;return`${t}"${r}"`}}}(t)),this},addFieldExists(t){return e.push(function(e){return{toQuerySyntax(){let t=sk(e),{field:r}=e;return`${t}@${r}`}}}(t)),this},addStringField(t){return e.push(function(e){return{toQuerySyntax(){let{field:t}=e,r=sk(e),n=ok(e.operator),a=e.values.map((e=>`"${e}"`));return`${r}@${t}${n}${1===a.length?a[0]:`(${a.join(",")})`}`}}}(t)),this},addStringFacetField(t){return e.push(function(e){return{toQuerySyntax(){let t=sk(e),{field:r,operator:n,value:a}=e;return`${t}@${r}${ok(n)}${"fuzzyMatch"===n?` $quoteVar(value: ${a})`:`("${a}")`}`}}}(t)),this},addNumericField(t){return e.push(function(e){return{toQuerySyntax(){let{field:t,value:r}=e;return`${sk(e)}@${t}${ok(e.operator)}${r}`}}}(t)),this},addNumericRangeField(t){return e.push(function(e){return{toQuerySyntax(){let t=sk(e),{field:r,from:n,to:a}=e;return`${t}@${r}${ok("isExactly")}${n}..${a}`}}}(t)),this},addDateField(t){return e.push(function(e){return{toQuerySyntax(){let{field:t,value:r}=e,n=ok(e.operator);return`${sk(e)}@${t}${n}${r}`}}}(t)),this},addDateRangeField(t){return e.push(function(e){return{toQuerySyntax(){let t=sk(e),{field:r,from:n,to:a}=e;return`${t}@${r}${ok("isExactly")}${n}..${a}`}}}(t)),this},addQueryExtension(t){return e.push(ck(t)),this},joinUsing(e){return t=e,this},toQuerySyntax(){let r=function(e){return"and"===e?"AND":"OR"}(t),n=e.map((e=>e.toQuerySyntax())).join(`) ${r} (`);return e.length<=1?n:`(${n})`}}}export{ko as API_DATE_FORMAT,Wd as DefaultFieldsToInclude,Gd as EcommerceDefaultFieldsToInclude,N as HighlightUtils,Yd as MinimumFieldsToInclude,Kc as ResultTemplatesHelpers,Qi as SortBy,Ui as SortOrder,fn as VERSION,ci as baseFacetResponseSelector,XI as buildAutomaticFacetGenerator,nb as buildBreadcrumbManager,_h as buildCategoryFacet,GI as buildCategoryFieldSuggestions,gf as buildContext,Td as buildController,$i as buildCriterionExpression,Jy as buildDateFacet,mm as buildDateFilter,rh as buildDateRange,Ni as buildDateSortCriterion,Sf as buildDictionaryFieldContext,If as buildDidYouMean,NC as buildExecuteTrigger,Sy as buildFacet,YI as buildFacetConditionsManager,Hw as buildFacetManager,Bi as buildFieldSortCriterion,WI as buildFieldSuggestions,_C as buildFoldedResultList,uq as buildGeneratedAnswer,Tv as buildHistoryManager,cw as buildInstantResults,dq as buildInteractiveCitation,vS as buildInteractiveInstantResult,HI as buildInteractiveRecentResult,mS as buildInteractiveResult,Hi as buildNoSortCriterion,zC as buildNotifyTrigger,om as buildNumericFacet,fm as buildNumericFilter,im as buildNumericRange,rS as buildPager,aS as buildQueryError,uk as buildQueryExpression,zi as buildQueryRankingExpressionSortCriterion,oS as buildQuerySummary,LC as buildQueryTrigger,kC as buildQuickview,QI as buildRecentQueriesList,zI as buildRecentResultsList,$C as buildRedirectionTrigger,Zd as buildRelevanceInspector,Li as buildRelevanceSortCriterion,lS as buildResultList,Xq as buildResultTemplatesManager,bS as buildResultsPerPage,tw as buildSearchBox,Ed as buildSearchEngine,_b as buildSearchParameterManager,Xb as buildSearchParameterSerializer,gC as buildSearchStatus,xI as buildSmartSnippet,OI as buildSmartSnippetQuestionsList,vw as buildSort,yb as buildStandaloneSearchBox,Mw as buildStaticFilter,Tw as buildStaticFilterValue,Lw as buildTab,Bw as buildTabManager,fC as buildUrlManager,Hv as currentPageSelector,Wv as currentPagesSelector,Qo as deserializeRelativeDate,ui as facetRequestSelector,di as facetResponseSelectedValuesSelector,li as facetResponseSelector,ve as getAnalyticsNextApiBaseUrl,ye as getOrganizationEndpoint,Od as getSampleSearchEngineConfiguration,me as getSearchApiBaseUrl,yq as loadAdvancedSearchQueryActions,Bq as loadBreadcrumbActions,mq as loadCategoryFacetSetActions,tk as loadClickAnalyticsActions,Sq as loadConfigurationActions,bq as loadContextActions,qq as loadDateFacetSetActions,Iq as loadDebugActions,Cq as loadDictionaryFieldContextActions,xq as loadDidYouMeanActions,Gq as loadExcerptLengthActions,kq as loadFacetOptionsActions,vq as loadFacetSetActions,Aq as loadFieldActions,Fq as loadFoldingActions,Jq as loadGeneratedAnswerActions,rk as loadGenericAnalyticsActions,Rq as loadHistoryActions,ak as loadIPXActionsHistoryActions,Pq as loadInstantResultsActions,Oq as loadNumericFacetSetActions,Eq as loadPaginationActions,Tq as loadPipelineActions,Dq as loadQueryActions,Mq as loadQuerySetActions,jq as loadQuerySuggestActions,Nq as loadQuestionAnsweringActions,zq as loadRecentQueriesActions,Hq as loadRecentResultsActions,Kq as loadResultPreviewActions,Vq as loadSearchActions,ek as loadSearchAnalyticsActions,wq as loadSearchConfigurationActions,_q as loadSearchHubActions,Uq as loadSortCriteriaActions,Qq as loadStandaloneSearchBoxSetActions,$q as loadStaticFilterSetActions,Lq as loadTabSetActions,Yv as maxPageSelector,ik as parseCriterionExpression,Mo as validateRelativeDate};export default null;
//# sourceMappingURL=/sm/34d8467c83441880eda05cb021a01fbb33cd17fe2e7253a84fb43b98159a504d.map